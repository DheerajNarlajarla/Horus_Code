/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var ue=["require","exports","vs/base/common/platform","vs/base/common/strings","vs/base/common/errors","vs/base/common/path","vs/base/common/buffer","vs/base/common/lifecycle","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeBase","vs/editor/common/core/range","vs/base/common/extpath","vs/base/common/network","vs/base/common/uri","vs/base/common/stream","vs/base/common/lazy","vs/base/common/symbols","vs/editor/common/core/eolCounter","vs/editor/common/model/pieceTreeTextBuffer/rbTreeBase","vs/editor/common/model","vs/editor/common/model/textModelSearch","vs/base/common/mime","vs/base/common/resources","vs/base/common/async","vs/base/common/event","vs/base/common/glob","vs/editor/common/core/stringBuilder","vs/editor/common/core/textChange","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBuffer","vs/editor/common/model/pieceTreeTextBuffer/pieceTreeTextBufferBuilder","vs/nls!vs/platform/contextkey/common/contextkey","vs/nls","vs/nls!vs/workbench/contrib/notebook/common/services/notebookSimpleWorker","vs/nls!vs/platform/contextkey/common/scanner","vs/platform/contextkey/common/scanner","vs/platform/instantiation/common/instantiation","vs/platform/contextkey/common/contextkey","vs/workbench/contrib/notebook/common/notebookCommon","vs/editor/common/core/position","vs/base/common/types","vs/base/common/cancellation","vs/base/common/arrays","vs/base/common/map","vs/base/common/iterator","vs/workbench/contrib/notebook/common/services/notebookSimpleWorker","vs/base/common/diff/diff","vs/base/common/hash"],ce=function(le){for(var e=[],$=0,U=le.length;$<U;$++)e[$]=ue[le[$]];return e};define(ue[13],ce([0,1,4,7]),function(le,e,$,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prefixedStream=e.prefixedReadable=e.transform=e.toReadable=e.emptyStream=e.toStream=e.peekStream=e.listenStream=e.consumeStream=e.peekReadable=e.consumeReadable=e.newWriteableStream=e.isReadableBufferedStream=e.isReadableStream=e.isReadable=void 0;function j(n){const s=n;return s?typeof s.read=="function":!1}e.isReadable=j;function N(n){const s=n;return s?[s.on,s.pause,s.resume,s.destroy].every(o=>typeof o=="function"):!1}e.isReadableStream=N;function F(n){const s=n;return s?N(s.stream)&&Array.isArray(s.buffer)&&typeof s.ended=="boolean":!1}e.isReadableBufferedStream=F;function K(n,s){return new S(n,s)}e.newWriteableStream=K;class S{constructor(s,o){this.reducer=s,this.options=o,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(s){if(!this.state.destroyed){if(this.state.flowing)this.emitData(s);else if(this.buffer.data.push(s),typeof this.options?.highWaterMark=="number"&&this.buffer.data.length>this.options.highWaterMark)return new Promise(o=>this.pendingWritePromises.push(o))}}error(s){this.state.destroyed||(this.state.flowing?this.emitError(s):this.buffer.error.push(s))}end(s){this.state.destroyed||(typeof s<"u"&&this.write(s),this.state.flowing?(this.emitEnd(),this.destroy()):this.state.ended=!0)}emitData(s){this.listeners.data.slice(0).forEach(o=>o(s))}emitError(s){this.listeners.error.length===0?(0,$.onUnexpectedError)(s):this.listeners.error.slice(0).forEach(o=>o(s))}emitEnd(){this.listeners.end.slice(0).forEach(s=>s())}on(s,o){if(!this.state.destroyed)switch(s){case"data":this.listeners.data.push(o),this.resume();break;case"end":this.listeners.end.push(o),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(o),this.state.flowing&&this.flowErrors();break}}removeListener(s,o){if(this.state.destroyed)return;let p;switch(s){case"data":p=this.listeners.data;break;case"end":p=this.listeners.end;break;case"error":p=this.listeners.error;break}if(p){const v=p.indexOf(o);v>=0&&p.splice(v,1)}}flowData(){if(this.buffer.data.length>0){const s=this.reducer(this.buffer.data);this.emitData(s),this.buffer.data.length=0;const o=[...this.pendingWritePromises];this.pendingWritePromises.length=0,o.forEach(p=>p())}}flowErrors(){if(this.listeners.error.length>0){for(const s of this.buffer.error)this.emitError(s);this.buffer.error.length=0}}flowEnd(){return this.state.ended?(this.emitEnd(),this.listeners.end.length>0):!1}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}}function m(n,s){const o=[];let p;for(;(p=n.read())!==null;)o.push(p);return s(o)}e.consumeReadable=m;function E(n,s,o){const p=[];let v;for(;(v=n.read())!==null&&p.length<o;)p.push(v);return v===null&&p.length>0?s(p):{read:()=>{if(p.length>0)return p.shift();if(typeof v<"u"){const P=v;return v=void 0,P}return n.read()}}}e.peekReadable=E;function W(n,s){return new Promise((o,p)=>{const v=[];f(n,{onData:P=>{s&&v.push(P)},onError:P=>{s?p(P):o(void 0)},onEnd:()=>{o(s?s(v):void 0)}})})}e.consumeStream=W;function f(n,s,o){n.on("error",p=>{o?.isCancellationRequested||s.onError(p)}),n.on("end",()=>{o?.isCancellationRequested||s.onEnd()}),n.on("data",p=>{o?.isCancellationRequested||s.onData(p)})}e.listenStream=f;function L(n,s){return new Promise((o,p)=>{const v=new U.DisposableStore,P=[],O=A=>{if(P.push(A),P.length>s)return v.dispose(),n.pause(),o({stream:n,buffer:P,ended:!1})},h=A=>(v.dispose(),p(A)),C=()=>(v.dispose(),o({stream:n,buffer:P,ended:!0}));v.add((0,U.toDisposable)(()=>n.removeListener("error",h))),n.on("error",h),v.add((0,U.toDisposable)(()=>n.removeListener("end",C))),n.on("end",C),v.add((0,U.toDisposable)(()=>n.removeListener("data",O))),n.on("data",O)})}e.peekStream=L;function g(n,s){const o=K(s);return o.end(n),o}e.toStream=g;function c(){const n=K(()=>{throw new Error("not supported")});return n.end(),n}e.emptyStream=c;function a(n){let s=!1;return{read:()=>s?null:(s=!0,n)}}e.toReadable=a;function l(n,s,o){const p=K(o);return f(n,{onData:v=>p.write(s.data(v)),onError:v=>p.error(s.error?s.error(v):v),onEnd:()=>p.end()}),p}e.transform=l;function t(n,s,o){let p=!1;return{read:()=>{const v=s.read();return p?v:(p=!0,v!==null?o([n,v]):n)}}}e.prefixedReadable=t;function r(n,s,o){let p=!1;const v=K(o);return f(s,{onData:P=>p?v.write(P):(p=!0,v.write(o([n,P]))),onError:P=>v.error(P),onEnd:()=>{p||(p=!0,v.write(n)),v.end()}}),v}e.prefixedStream=r}),define(ue[6],ce([0,1,14,13]),function(le,e,$,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.encodeBase64=e.decodeBase64=e.prefixedBufferStream=e.prefixedBufferReadable=e.newWriteableBufferStream=e.streamToBufferReadableStream=e.bufferToStream=e.bufferedStreamToBuffer=e.streamToBuffer=e.bufferToReadable=e.readableToBuffer=e.writeUInt8=e.readUInt8=e.writeUInt32LE=e.readUInt32LE=e.writeUInt32BE=e.readUInt32BE=e.writeUInt16LE=e.readUInt16LE=e.binaryIndexOf=e.VSBuffer=void 0;const j=typeof Buffer<"u",N=new $.Lazy(()=>new Uint8Array(256));let F,K;class S{static alloc(_){return j?new S(Buffer.allocUnsafe(_)):new S(new Uint8Array(_))}static wrap(_){return j&&!Buffer.isBuffer(_)&&(_=Buffer.from(_.buffer,_.byteOffset,_.byteLength)),new S(_)}static fromString(_,z){return!(z?.dontUseNodeBuffer||!1)&&j?new S(Buffer.from(_)):(F||(F=new TextEncoder),new S(F.encode(_)))}static fromByteArray(_){const z=S.alloc(_.length);for(let Z=0,ee=_.length;Z<ee;Z++)z.buffer[Z]=_[Z];return z}static concat(_,z){if(typeof z>"u"){z=0;for(let re=0,te=_.length;re<te;re++)z+=_[re].byteLength}const Z=S.alloc(z);let ee=0;for(let re=0,te=_.length;re<te;re++){const ne=_[re];Z.set(ne,ee),ee+=ne.byteLength}return Z}constructor(_){this.buffer=_,this.byteLength=this.buffer.byteLength}clone(){const _=S.alloc(this.byteLength);return _.set(this),_}toString(){return j?this.buffer.toString():(K||(K=new TextDecoder),K.decode(this.buffer))}slice(_,z){return new S(this.buffer.subarray(_,z))}set(_,z){if(_ instanceof S)this.buffer.set(_.buffer,z);else if(_ instanceof Uint8Array)this.buffer.set(_,z);else if(_ instanceof ArrayBuffer)this.buffer.set(new Uint8Array(_),z);else if(ArrayBuffer.isView(_))this.buffer.set(new Uint8Array(_.buffer,_.byteOffset,_.byteLength),z);else throw new Error("Unknown argument 'array'")}readUInt32BE(_){return f(this.buffer,_)}writeUInt32BE(_,z){L(this.buffer,_,z)}readUInt32LE(_){return g(this.buffer,_)}writeUInt32LE(_,z){c(this.buffer,_,z)}readUInt8(_){return a(this.buffer,_)}writeUInt8(_,z){l(this.buffer,_,z)}indexOf(_,z=0){return m(this.buffer,_ instanceof S?_.buffer:_,z)}}e.VSBuffer=S;function m(k,_,z=0){const Z=_.byteLength,ee=k.byteLength;if(Z===0)return 0;if(Z===1)return k.indexOf(_[0]);if(Z>ee-z)return-1;const re=N.value;re.fill(_.length);for(let Q=0;Q<_.length;Q++)re[_[Q]]=_.length-Q-1;let te=z+_.length-1,ne=te,b=-1;for(;te<ee;)if(k[te]===_[ne]){if(ne===0){b=te;break}te--,ne--}else te+=Math.max(_.length-ne,re[k[te]]),ne=_.length-1;return b}e.binaryIndexOf=m;function E(k,_){return k[_+0]<<0>>>0|k[_+1]<<8>>>0}e.readUInt16LE=E;function W(k,_,z){k[z+0]=_&255,_=_>>>8,k[z+1]=_&255}e.writeUInt16LE=W;function f(k,_){return k[_]*2**24+k[_+1]*2**16+k[_+2]*2**8+k[_+3]}e.readUInt32BE=f;function L(k,_,z){k[z+3]=_,_=_>>>8,k[z+2]=_,_=_>>>8,k[z+1]=_,_=_>>>8,k[z]=_}e.writeUInt32BE=L;function g(k,_){return k[_+0]<<0>>>0|k[_+1]<<8>>>0|k[_+2]<<16>>>0|k[_+3]<<24>>>0}e.readUInt32LE=g;function c(k,_,z){k[z+0]=_&255,_=_>>>8,k[z+1]=_&255,_=_>>>8,k[z+2]=_&255,_=_>>>8,k[z+3]=_&255}e.writeUInt32LE=c;function a(k,_){return k[_]}e.readUInt8=a;function l(k,_,z){k[z]=_}e.writeUInt8=l;function t(k){return U.consumeReadable(k,_=>S.concat(_))}e.readableToBuffer=t;function r(k){return U.toReadable(k)}e.bufferToReadable=r;function n(k){return U.consumeStream(k,_=>S.concat(_))}e.streamToBuffer=n;async function s(k){return k.ended?S.concat(k.buffer):S.concat([...k.buffer,await n(k.stream)])}e.bufferedStreamToBuffer=s;function o(k){return U.toStream(k,_=>S.concat(_))}e.bufferToStream=o;function p(k){return U.transform(k,{data:_=>typeof _=="string"?S.fromString(_):S.wrap(_)},_=>S.concat(_))}e.streamToBufferReadableStream=p;function v(k){return U.newWriteableStream(_=>S.concat(_),k)}e.newWriteableBufferStream=v;function P(k,_){return U.prefixedReadable(k,_,z=>S.concat(z))}e.prefixedBufferReadable=P;function O(k,_){return U.prefixedStream(k,_,z=>S.concat(z))}e.prefixedBufferStream=O;function h(k){let _=0,z=0,Z=0;const ee=new Uint8Array(Math.floor(k.length/4*3)),re=ne=>{switch(z){case 3:ee[Z++]=_|ne,z=0;break;case 2:ee[Z++]=_|ne>>>2,_=ne<<6,z=3;break;case 1:ee[Z++]=_|ne>>>4,_=ne<<4,z=2;break;default:_=ne<<2,z=1}};for(let ne=0;ne<k.length;ne++){const b=k.charCodeAt(ne);if(b>=65&&b<=90)re(b-65);else if(b>=97&&b<=122)re(b-97+26);else if(b>=48&&b<=57)re(b-48+52);else if(b===43||b===45)re(62);else if(b===47||b===95)re(63);else{if(b===61)break;throw new SyntaxError(`Unexpected base64 character ${k[ne]}`)}}const te=Z;for(;z>0;)re(0);return S.wrap(ee).slice(0,te)}e.decodeBase64=h;const C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function V({buffer:k},_=!0,z=!1){const Z=z?A:C;let ee="";const re=k.byteLength%3;let te=0;for(;te<k.byteLength-re;te+=3){const ne=k[te+0],b=k[te+1],Q=k[te+2];ee+=Z[ne>>>2],ee+=Z[(ne<<4|b>>>4)&63],ee+=Z[(b<<2|Q>>>6)&63],ee+=Z[Q&63]}if(re===1){const ne=k[te+0];ee+=Z[ne>>>2],ee+=Z[ne<<4&63],_&&(ee+="==")}else if(re===2){const ne=k[te+0],b=k[te+1];ee+=Z[ne>>>2],ee+=Z[(ne<<4|b>>>4)&63],ee+=Z[b<<2&63],_&&(ee+="=")}return ee}e.encodeBase64=V}),define(ue[15],ce([0,1]),function(le,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MicrotaskDelay=void 0,e.MicrotaskDelay=Symbol("MicrotaskDelay")}),define(ue[16],ce([0,1]),function(le,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.countEOL=e.StringEOL=void 0;var $;(function(j){j[j.Unknown=0]="Unknown",j[j.Invalid=3]="Invalid",j[j.LF=1]="LF",j[j.CRLF=2]="CRLF"})($||(e.StringEOL=$={}));function U(j){let N=0,F=0,K=0,S=0;for(let m=0,E=j.length;m<E;m++){const W=j.charCodeAt(m);W===13?(N===0&&(F=m),N++,m+1<E&&j.charCodeAt(m+1)===10?(S|=2,m++):S|=3,K=m+1):W===10&&(S|=1,N===0&&(F=m),N++,K=m+1)}return N===0&&(F=j.length),[N,F,j.length-K,S]}e.countEOL=U}),define(ue[17],ce([0,1]),function(le,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.recomputeTreeMetadata=e.updateTreeMetadata=e.fixInsert=e.rbDelete=e.rightRotate=e.leftRotate=e.righttest=e.leftest=e.SENTINEL=e.NodeColor=e.TreeNode=void 0;class ${constructor(a,l){this.piece=a,this.color=l,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==e.SENTINEL)return j(this.right);let a=this;for(;a.parent!==e.SENTINEL&&a.parent.left!==a;)a=a.parent;return a.parent===e.SENTINEL?e.SENTINEL:a.parent}prev(){if(this.left!==e.SENTINEL)return N(this.left);let a=this;for(;a.parent!==e.SENTINEL&&a.parent.right!==a;)a=a.parent;return a.parent===e.SENTINEL?e.SENTINEL:a.parent}detach(){this.parent=null,this.left=null,this.right=null}}e.TreeNode=$;var U;(function(c){c[c.Black=0]="Black",c[c.Red=1]="Red"})(U||(e.NodeColor=U={})),e.SENTINEL=new $(null,0),e.SENTINEL.parent=e.SENTINEL,e.SENTINEL.left=e.SENTINEL,e.SENTINEL.right=e.SENTINEL,e.SENTINEL.color=0;function j(c){for(;c.left!==e.SENTINEL;)c=c.left;return c}e.leftest=j;function N(c){for(;c.right!==e.SENTINEL;)c=c.right;return c}e.righttest=N;function F(c){return c===e.SENTINEL?0:c.size_left+c.piece.length+F(c.right)}function K(c){return c===e.SENTINEL?0:c.lf_left+c.piece.lineFeedCnt+K(c.right)}function S(){e.SENTINEL.parent=e.SENTINEL}function m(c,a){const l=a.right;l.size_left+=a.size_left+(a.piece?a.piece.length:0),l.lf_left+=a.lf_left+(a.piece?a.piece.lineFeedCnt:0),a.right=l.left,l.left!==e.SENTINEL&&(l.left.parent=a),l.parent=a.parent,a.parent===e.SENTINEL?c.root=l:a.parent.left===a?a.parent.left=l:a.parent.right=l,l.left=a,a.parent=l}e.leftRotate=m;function E(c,a){const l=a.left;a.left=l.right,l.right!==e.SENTINEL&&(l.right.parent=a),l.parent=a.parent,a.size_left-=l.size_left+(l.piece?l.piece.length:0),a.lf_left-=l.lf_left+(l.piece?l.piece.lineFeedCnt:0),a.parent===e.SENTINEL?c.root=l:a===a.parent.right?a.parent.right=l:a.parent.left=l,l.right=a,a.parent=l}e.rightRotate=E;function W(c,a){let l,t;if(a.left===e.SENTINEL?(t=a,l=t.right):a.right===e.SENTINEL?(t=a,l=t.left):(t=j(a.right),l=t.right),t===c.root){c.root=l,l.color=0,a.detach(),S(),c.root.parent=e.SENTINEL;return}const r=t.color===1;if(t===t.parent.left?t.parent.left=l:t.parent.right=l,t===a?(l.parent=t.parent,g(c,l)):(t.parent===a?l.parent=t:l.parent=t.parent,g(c,l),t.left=a.left,t.right=a.right,t.parent=a.parent,t.color=a.color,a===c.root?c.root=t:a===a.parent.left?a.parent.left=t:a.parent.right=t,t.left!==e.SENTINEL&&(t.left.parent=t),t.right!==e.SENTINEL&&(t.right.parent=t),t.size_left=a.size_left,t.lf_left=a.lf_left,g(c,t)),a.detach(),l.parent.left===l){const s=F(l),o=K(l);if(s!==l.parent.size_left||o!==l.parent.lf_left){const p=s-l.parent.size_left,v=o-l.parent.lf_left;l.parent.size_left=s,l.parent.lf_left=o,L(c,l.parent,p,v)}}if(g(c,l.parent),r){S();return}let n;for(;l!==c.root&&l.color===0;)l===l.parent.left?(n=l.parent.right,n.color===1&&(n.color=0,l.parent.color=1,m(c,l.parent),n=l.parent.right),n.left.color===0&&n.right.color===0?(n.color=1,l=l.parent):(n.right.color===0&&(n.left.color=0,n.color=1,E(c,n),n=l.parent.right),n.color=l.parent.color,l.parent.color=0,n.right.color=0,m(c,l.parent),l=c.root)):(n=l.parent.left,n.color===1&&(n.color=0,l.parent.color=1,E(c,l.parent),n=l.parent.left),n.left.color===0&&n.right.color===0?(n.color=1,l=l.parent):(n.left.color===0&&(n.right.color=0,n.color=1,m(c,n),n=l.parent.left),n.color=l.parent.color,l.parent.color=0,n.left.color=0,E(c,l.parent),l=c.root));l.color=0,S()}e.rbDelete=W;function f(c,a){for(g(c,a);a!==c.root&&a.parent.color===1;)if(a.parent===a.parent.parent.left){const l=a.parent.parent.right;l.color===1?(a.parent.color=0,l.color=0,a.parent.parent.color=1,a=a.parent.parent):(a===a.parent.right&&(a=a.parent,m(c,a)),a.parent.color=0,a.parent.parent.color=1,E(c,a.parent.parent))}else{const l=a.parent.parent.left;l.color===1?(a.parent.color=0,l.color=0,a.parent.parent.color=1,a=a.parent.parent):(a===a.parent.left&&(a=a.parent,E(c,a)),a.parent.color=0,a.parent.parent.color=1,m(c,a.parent.parent))}c.root.color=0}e.fixInsert=f;function L(c,a,l,t){for(;a!==c.root&&a!==e.SENTINEL;)a.parent.left===a&&(a.parent.size_left+=l,a.parent.lf_left+=t),a=a.parent}e.updateTreeMetadata=L;function g(c,a){let l=0,t=0;if(a!==c.root){for(;a!==c.root&&a===a.parent.right;)a=a.parent;if(a!==c.root)for(a=a.parent,l=F(a.left)-a.size_left,t=K(a.left)-a.lf_left,a.size_left+=l,a.lf_left+=t;a!==c.root&&(l!==0||t!==0);)a.parent.left===a&&(a.parent.size_left+=l,a.parent.lf_left+=t),a=a.parent}}e.recomputeTreeMetadata=g}),define(ue[8],ce([0,1,37,9,18,17,19]),function(le,e,$,U,j,N,F){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeBase=e.StringBuffer=e.Piece=e.createLineStarts=e.createLineStartsFast=void 0;const K=65535;function S(l){let t;return l[l.length-1]<65536?t=new Uint16Array(l.length):t=new Uint32Array(l.length),t.set(l,0),t}class m{constructor(t,r,n,s,o){this.lineStarts=t,this.cr=r,this.lf=n,this.crlf=s,this.isBasicASCII=o}}function E(l,t=!0){const r=[0];let n=1;for(let s=0,o=l.length;s<o;s++){const p=l.charCodeAt(s);p===13?s+1<o&&l.charCodeAt(s+1)===10?(r[n++]=s+2,s++):r[n++]=s+1:p===10&&(r[n++]=s+1)}return t?S(r):r}e.createLineStartsFast=E;function W(l,t){l.length=0,l[0]=0;let r=1,n=0,s=0,o=0,p=!0;for(let P=0,O=t.length;P<O;P++){const h=t.charCodeAt(P);h===13?P+1<O&&t.charCodeAt(P+1)===10?(o++,l[r++]=P+2,P++):(n++,l[r++]=P+1):h===10?(s++,l[r++]=P+1):p&&h!==9&&(h<32||h>126)&&(p=!1)}const v=new m(S(l),n,s,o,p);return l.length=0,v}e.createLineStarts=W;class f{constructor(t,r,n,s,o){this.bufferIndex=t,this.start=r,this.end=n,this.lineFeedCnt=s,this.length=o}}e.Piece=f;class L{constructor(t,r){this.buffer=t,this.lineStarts=r}}e.StringBuffer=L;class g{constructor(t,r){this._pieces=[],this._tree=t,this._BOM=r,this._index=0,t.root!==N.SENTINEL&&t.iterate(t.root,n=>(n!==N.SENTINEL&&this._pieces.push(n.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class c{constructor(t){this._limit=t,this._cache=[]}get(t){for(let r=this._cache.length-1;r>=0;r--){const n=this._cache[r];if(n.nodeStartOffset<=t&&n.nodeStartOffset+n.node.piece.length>=t)return n}return null}get2(t){for(let r=this._cache.length-1;r>=0;r--){const n=this._cache[r];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<t&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=t)return n}return null}set(t){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(t)}validate(t){let r=!1;const n=this._cache;for(let s=0;s<n.length;s++){const o=n[s];if(o.node.parent===null||o.nodeStartOffset>=t){n[s]=null,r=!0;continue}}if(r){const s=[];for(const o of n)o!==null&&s.push(o);this._cache=s}}}class a{constructor(t,r,n){this.create(t,r,n)}create(t,r,n){this._buffers=[new L("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=N.SENTINEL,this._lineCnt=1,this._length=0,this._EOL=r,this._EOLLength=r.length,this._EOLNormalized=n;let s=null;for(let o=0,p=t.length;o<p;o++)if(t[o].buffer.length>0){t[o].lineStarts||(t[o].lineStarts=E(t[o].buffer));const v=new f(o+1,{line:0,column:0},{line:t[o].lineStarts.length-1,column:t[o].buffer.length-t[o].lineStarts[t[o].lineStarts.length-1]},t[o].lineStarts.length-1,t[o].buffer.length);this._buffers.push(t[o]),s=this.rbInsertRight(s,v)}this._searchCache=new c(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(t){const r=K,n=r-Math.floor(r/3),s=n*2;let o="",p=0;const v=[];if(this.iterate(this.root,P=>{const O=this.getNodeContent(P),h=O.length;if(p<=n||p+h<s)return o+=O,p+=h,!0;const C=o.replace(/\r\n|\r|\n/g,t);return v.push(new L(C,E(C))),o=O,p=h,!0}),p>0){const P=o.replace(/\r\n|\r|\n/g,t);v.push(new L(P,E(P)))}this.create(v,t,!0)}getEOL(){return this._EOL}setEOL(t){this._EOL=t,this._EOLLength=this._EOL.length,this.normalizeEOL(t)}createSnapshot(t){return new g(this,t)}equal(t){if(this.getLength()!==t.getLength()||this.getLineCount()!==t.getLineCount())return!1;let r=0;return this.iterate(this.root,s=>{if(s===N.SENTINEL)return!0;const o=this.getNodeContent(s),p=o.length,v=t.nodeAt(r),P=t.nodeAt(r+p),O=t.getValueInRange2(v,P);return r+=p,o===O})}getOffsetAt(t,r){let n=0,s=this.root;for(;s!==N.SENTINEL;)if(s.left!==N.SENTINEL&&s.lf_left+1>=t)s=s.left;else if(s.lf_left+s.piece.lineFeedCnt+1>=t){n+=s.size_left;const o=this.getAccumulatedValue(s,t-s.lf_left-2);return n+=o+r-1}else t-=s.lf_left+s.piece.lineFeedCnt,n+=s.size_left+s.piece.length,s=s.right;return n}getPositionAt(t){t=Math.floor(t),t=Math.max(0,t);let r=this.root,n=0;const s=t;for(;r!==N.SENTINEL;)if(r.size_left!==0&&r.size_left>=t)r=r.left;else if(r.size_left+r.piece.length>=t){const o=this.getIndexOf(r,t-r.size_left);if(n+=r.lf_left+o.index,o.index===0){const p=this.getOffsetAt(n+1,1),v=s-p;return new $.Position(n+1,v+1)}return new $.Position(n+1,o.remainder+1)}else if(t-=r.size_left+r.piece.length,n+=r.lf_left+r.piece.lineFeedCnt,r.right===N.SENTINEL){const o=this.getOffsetAt(n+1,1),p=s-t-o;return new $.Position(n+1,p+1)}else r=r.right;return new $.Position(1,1)}getValueInRange(t,r){if(t.startLineNumber===t.endLineNumber&&t.startColumn===t.endColumn)return"";const n=this.nodeAt2(t.startLineNumber,t.startColumn),s=this.nodeAt2(t.endLineNumber,t.endColumn),o=this.getValueInRange2(n,s);return r?r!==this._EOL||!this._EOLNormalized?o.replace(/\r\n|\r|\n/g,r):r===this.getEOL()&&this._EOLNormalized?o:o.replace(/\r\n|\r|\n/g,r):o}getValueInRange2(t,r){if(t.node===r.node){const v=t.node,P=this._buffers[v.piece.bufferIndex].buffer,O=this.offsetInBuffer(v.piece.bufferIndex,v.piece.start);return P.substring(O+t.remainder,O+r.remainder)}let n=t.node;const s=this._buffers[n.piece.bufferIndex].buffer,o=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);let p=s.substring(o+t.remainder,o+n.piece.length);for(n=n.next();n!==N.SENTINEL;){const v=this._buffers[n.piece.bufferIndex].buffer,P=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===r.node){p+=v.substring(P,P+r.remainder);break}else p+=v.substr(P,n.piece.length);n=n.next()}return p}getLinesContent(){const t=[];let r=0,n="",s=!1;return this.iterate(this.root,o=>{if(o===N.SENTINEL)return!0;const p=o.piece;let v=p.length;if(v===0)return!0;const P=this._buffers[p.bufferIndex].buffer,O=this._buffers[p.bufferIndex].lineStarts,h=p.start.line,C=p.end.line;let A=O[h]+p.start.column;if(s&&(P.charCodeAt(A)===10&&(A++,v--),t[r++]=n,n="",s=!1,v===0))return!0;if(h===C)return!this._EOLNormalized&&P.charCodeAt(A+v-1)===13?(s=!0,n+=P.substr(A,v-1)):n+=P.substr(A,v),!0;n+=this._EOLNormalized?P.substring(A,Math.max(A,O[h+1]-this._EOLLength)):P.substring(A,O[h+1]).replace(/(\r\n|\r|\n)$/,""),t[r++]=n;for(let V=h+1;V<C;V++)n=this._EOLNormalized?P.substring(O[V],O[V+1]-this._EOLLength):P.substring(O[V],O[V+1]).replace(/(\r\n|\r|\n)$/,""),t[r++]=n;return!this._EOLNormalized&&P.charCodeAt(O[C]+p.end.column-1)===13?(s=!0,p.end.column===0?r--:n=P.substr(O[C],p.end.column-1)):n=P.substr(O[C],p.end.column),!0}),s&&(t[r++]=n,n=""),t[r++]=n,t}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(t){return this._lastVisitedLine.lineNumber===t?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=t,t===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(t):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(t,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(t).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(t){if(t.remainder===t.node.piece.length){const r=t.node.next();if(!r)return 0;const n=this._buffers[r.piece.bufferIndex],s=this.offsetInBuffer(r.piece.bufferIndex,r.piece.start);return n.buffer.charCodeAt(s)}else{const r=this._buffers[t.node.piece.bufferIndex],s=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start)+t.remainder;return r.buffer.charCodeAt(s)}}getLineCharCode(t,r){const n=this.nodeAt2(t,r+1);return this._getCharCode(n)}getLineLength(t){if(t===this.getLineCount()){const r=this.getOffsetAt(t,1);return this.getLength()-r}return this.getOffsetAt(t+1,1)-this.getOffsetAt(t,1)-this._EOLLength}getCharCode(t){const r=this.nodeAt(t);return this._getCharCode(r)}findMatchesInNode(t,r,n,s,o,p,v,P,O,h,C){const A=this._buffers[t.piece.bufferIndex],V=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start),k=this.offsetInBuffer(t.piece.bufferIndex,o),_=this.offsetInBuffer(t.piece.bufferIndex,p);let z;const Z={line:0,column:0};let ee,re;r._wordSeparators?(ee=A.buffer.substring(k,_),re=te=>te+k,r.reset(0)):(ee=A.buffer,re=te=>te,r.reset(k));do if(z=r.next(ee),z){if(re(z.index)>=_)return h;this.positionInBuffer(t,re(z.index)-V,Z);const te=this.getLineFeedCnt(t.piece.bufferIndex,o,Z),ne=Z.line===o.line?Z.column-o.column+s:Z.column+1,b=ne+z[0].length;if(C[h++]=(0,F.createFindMatch)(new U.Range(n+te,ne,n+te,b),z,P),re(z.index)+z[0].length>=_||h>=O)return h}while(z);return h}findMatchesLineByLine(t,r,n,s){const o=[];let p=0;const v=new F.Searcher(r.wordSeparators,r.regex);let P=this.nodeAt2(t.startLineNumber,t.startColumn);if(P===null)return[];const O=this.nodeAt2(t.endLineNumber,t.endColumn);if(O===null)return[];let h=this.positionInBuffer(P.node,P.remainder);const C=this.positionInBuffer(O.node,O.remainder);if(P.node===O.node)return this.findMatchesInNode(P.node,v,t.startLineNumber,t.startColumn,h,C,r,n,s,p,o),o;let A=t.startLineNumber,V=P.node;for(;V!==O.node;){const _=this.getLineFeedCnt(V.piece.bufferIndex,h,V.piece.end);if(_>=1){const Z=this._buffers[V.piece.bufferIndex].lineStarts,ee=this.offsetInBuffer(V.piece.bufferIndex,V.piece.start),re=Z[h.line+_],te=A===t.startLineNumber?t.startColumn:1;if(p=this.findMatchesInNode(V,v,A,te,h,this.positionInBuffer(V,re-ee),r,n,s,p,o),p>=s)return o;A+=_}const z=A===t.startLineNumber?t.startColumn-1:0;if(A===t.endLineNumber){const Z=this.getLineContent(A).substring(z,t.endColumn-1);return p=this._findMatchesInLine(r,v,Z,t.endLineNumber,z,p,o,n,s),o}if(p=this._findMatchesInLine(r,v,this.getLineContent(A).substr(z),A,z,p,o,n,s),p>=s)return o;A++,P=this.nodeAt2(A,1),V=P.node,h=this.positionInBuffer(P.node,P.remainder)}if(A===t.endLineNumber){const _=A===t.startLineNumber?t.startColumn-1:0,z=this.getLineContent(A).substring(_,t.endColumn-1);return p=this._findMatchesInLine(r,v,z,t.endLineNumber,_,p,o,n,s),o}const k=A===t.startLineNumber?t.startColumn:1;return p=this.findMatchesInNode(O.node,v,A,k,h,C,r,n,s,p,o),o}_findMatchesInLine(t,r,n,s,o,p,v,P,O){const h=t.wordSeparators;if(!P&&t.simpleSearch){const A=t.simpleSearch,V=A.length,k=n.length;let _=-V;for(;(_=n.indexOf(A,_+V))!==-1;)if((!h||(0,F.isValidMatch)(h,n,k,_,V))&&(v[p++]=new j.FindMatch(new U.Range(s,_+1+o,s,_+1+V+o),null),p>=O))return p;return p}let C;r.reset(0);do if(C=r.next(n),C&&(v[p++]=(0,F.createFindMatch)(new U.Range(s,C.index+1+o,s,C.index+1+C[0].length+o),C,P),p>=O))return p;while(C);return p}insert(t,r,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==N.SENTINEL){const{node:s,remainder:o,nodeStartOffset:p}=this.nodeAt(t),v=s.piece,P=v.bufferIndex,O=this.positionInBuffer(s,o);if(s.piece.bufferIndex===0&&v.end.line===this._lastChangeBufferPos.line&&v.end.column===this._lastChangeBufferPos.column&&p+v.length===t&&r.length<K){this.appendToNode(s,r),this.computeBufferMetadata();return}if(p===t)this.insertContentToNodeLeft(r,s),this._searchCache.validate(t);else if(p+s.piece.length>t){const h=[];let C=new f(v.bufferIndex,O,v.end,this.getLineFeedCnt(v.bufferIndex,O,v.end),this.offsetInBuffer(P,v.end)-this.offsetInBuffer(P,O));if(this.shouldCheckCRLF()&&this.endWithCR(r)&&this.nodeCharCodeAt(s,o)===10){const _={line:C.start.line+1,column:0};C=new f(C.bufferIndex,_,C.end,this.getLineFeedCnt(C.bufferIndex,_,C.end),C.length-1),r+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(r))if(this.nodeCharCodeAt(s,o-1)===13){const _=this.positionInBuffer(s,o-1);this.deleteNodeTail(s,_),r="\r"+r,s.piece.length===0&&h.push(s)}else this.deleteNodeTail(s,O);else this.deleteNodeTail(s,O);const A=this.createNewPieces(r);C.length>0&&this.rbInsertRight(s,C);let V=s;for(let k=0;k<A.length;k++)V=this.rbInsertRight(V,A[k]);this.deleteNodes(h)}else this.insertContentToNodeRight(r,s)}else{const s=this.createNewPieces(r);let o=this.rbInsertLeft(null,s[0]);for(let p=1;p<s.length;p++)o=this.rbInsertRight(o,s[p])}this.computeBufferMetadata()}delete(t,r){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",r<=0||this.root===N.SENTINEL)return;const n=this.nodeAt(t),s=this.nodeAt(t+r),o=n.node,p=s.node;if(o===p){const A=this.positionInBuffer(o,n.remainder),V=this.positionInBuffer(o,s.remainder);if(n.nodeStartOffset===t){if(r===o.piece.length){const k=o.next();(0,N.rbDelete)(this,o),this.validateCRLFWithPrevNode(k),this.computeBufferMetadata();return}this.deleteNodeHead(o,V),this._searchCache.validate(t),this.validateCRLFWithPrevNode(o),this.computeBufferMetadata();return}if(n.nodeStartOffset+o.piece.length===t+r){this.deleteNodeTail(o,A),this.validateCRLFWithNextNode(o),this.computeBufferMetadata();return}this.shrinkNode(o,A,V),this.computeBufferMetadata();return}const v=[],P=this.positionInBuffer(o,n.remainder);this.deleteNodeTail(o,P),this._searchCache.validate(t),o.piece.length===0&&v.push(o);const O=this.positionInBuffer(p,s.remainder);this.deleteNodeHead(p,O),p.piece.length===0&&v.push(p);const h=o.next();for(let A=h;A!==N.SENTINEL&&A!==p;A=A.next())v.push(A);const C=o.piece.length===0?o.prev():o;this.deleteNodes(v),this.validateCRLFWithNextNode(C),this.computeBufferMetadata()}insertContentToNodeLeft(t,r){const n=[];if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.startWithLF(r)){const p=r.piece,v={line:p.start.line+1,column:0},P=new f(p.bufferIndex,v,p.end,this.getLineFeedCnt(p.bufferIndex,v,p.end),p.length-1);r.piece=P,t+=`
`,(0,N.updateTreeMetadata)(this,r,-1,-1),r.piece.length===0&&n.push(r)}const s=this.createNewPieces(t);let o=this.rbInsertLeft(r,s[s.length-1]);for(let p=s.length-2;p>=0;p--)o=this.rbInsertLeft(o,s[p]);this.validateCRLFWithPrevNode(o),this.deleteNodes(n)}insertContentToNodeRight(t,r){this.adjustCarriageReturnFromNext(t,r)&&(t+=`
`);const n=this.createNewPieces(t),s=this.rbInsertRight(r,n[0]);let o=s;for(let p=1;p<n.length;p++)o=this.rbInsertRight(o,n[p]);this.validateCRLFWithPrevNode(s)}positionInBuffer(t,r,n){const s=t.piece,o=t.piece.bufferIndex,p=this._buffers[o].lineStarts,P=p[s.start.line]+s.start.column+r;let O=s.start.line,h=s.end.line,C=0,A=0,V=0;for(;O<=h&&(C=O+(h-O)/2|0,V=p[C],C!==h);)if(A=p[C+1],P<V)h=C-1;else if(P>=A)O=C+1;else break;return n?(n.line=C,n.column=P-V,null):{line:C,column:P-V}}getLineFeedCnt(t,r,n){if(n.column===0)return n.line-r.line;const s=this._buffers[t].lineStarts;if(n.line===s.length-1)return n.line-r.line;const o=s[n.line+1],p=s[n.line]+n.column;if(o>p+1)return n.line-r.line;const v=p-1;return this._buffers[t].buffer.charCodeAt(v)===13?n.line-r.line+1:n.line-r.line}offsetInBuffer(t,r){return this._buffers[t].lineStarts[r.line]+r.column}deleteNodes(t){for(let r=0;r<t.length;r++)(0,N.rbDelete)(this,t[r])}createNewPieces(t){if(t.length>K){const h=[];for(;t.length>K;){const A=t.charCodeAt(K-1);let V;A===13||A>=55296&&A<=56319?(V=t.substring(0,K-1),t=t.substring(K-1)):(V=t.substring(0,K),t=t.substring(K));const k=E(V);h.push(new f(this._buffers.length,{line:0,column:0},{line:k.length-1,column:V.length-k[k.length-1]},k.length-1,V.length)),this._buffers.push(new L(V,k))}const C=E(t);return h.push(new f(this._buffers.length,{line:0,column:0},{line:C.length-1,column:t.length-C[C.length-1]},C.length-1,t.length)),this._buffers.push(new L(t,C)),h}let r=this._buffers[0].buffer.length;const n=E(t,!1);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===r&&r!==0&&this.startWithLF(t)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},s=this._lastChangeBufferPos;for(let h=0;h<n.length;h++)n[h]+=r+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+t,r+=1}else{if(r!==0)for(let h=0;h<n.length;h++)n[h]+=r;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=t}const o=this._buffers[0].buffer.length,p=this._buffers[0].lineStarts.length-1,v=o-this._buffers[0].lineStarts[p],P={line:p,column:v},O=new f(0,s,P,this.getLineFeedCnt(0,s,P),o-r);return this._lastChangeBufferPos=P,[O]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(t,r=0){let n=this.root,s="";const o=this._searchCache.get2(t);if(o){n=o.node;const p=this.getAccumulatedValue(n,t-o.nodeStartLineNumber-1),v=this._buffers[n.piece.bufferIndex].buffer,P=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(o.nodeStartLineNumber+n.piece.lineFeedCnt===t)s=v.substring(P+p,P+n.piece.length);else{const O=this.getAccumulatedValue(n,t-o.nodeStartLineNumber);return v.substring(P+p,P+O-r)}}else{let p=0;const v=t;for(;n!==N.SENTINEL;)if(n.left!==N.SENTINEL&&n.lf_left>=t-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>t-1){const P=this.getAccumulatedValue(n,t-n.lf_left-2),O=this.getAccumulatedValue(n,t-n.lf_left-1),h=this._buffers[n.piece.bufferIndex].buffer,C=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return p+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:p,nodeStartLineNumber:v-(t-1-n.lf_left)}),h.substring(C+P,C+O-r)}else if(n.lf_left+n.piece.lineFeedCnt===t-1){const P=this.getAccumulatedValue(n,t-n.lf_left-2),O=this._buffers[n.piece.bufferIndex].buffer,h=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s=O.substring(h+P,h+n.piece.length);break}else t-=n.lf_left+n.piece.lineFeedCnt,p+=n.size_left+n.piece.length,n=n.right}for(n=n.next();n!==N.SENTINEL;){const p=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){const v=this.getAccumulatedValue(n,0),P=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=p.substring(P,P+v-r),s}else{const v=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s+=p.substr(v,n.piece.length)}n=n.next()}return s}computeBufferMetadata(){let t=this.root,r=1,n=0;for(;t!==N.SENTINEL;)r+=t.lf_left+t.piece.lineFeedCnt,n+=t.size_left+t.piece.length,t=t.right;this._lineCnt=r,this._length=n,this._searchCache.validate(this._length)}getIndexOf(t,r){const n=t.piece,s=this.positionInBuffer(t,r),o=s.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===r){const p=this.getLineFeedCnt(t.piece.bufferIndex,n.start,s);if(p!==o)return{index:p,remainder:0}}return{index:o,remainder:s.column}}getAccumulatedValue(t,r){if(r<0)return 0;const n=t.piece,s=this._buffers[n.bufferIndex].lineStarts,o=n.start.line+r+1;return o>n.end.line?s[n.end.line]+n.end.column-s[n.start.line]-n.start.column:s[o]-s[n.start.line]-n.start.column}deleteNodeTail(t,r){const n=t.piece,s=n.lineFeedCnt,o=this.offsetInBuffer(n.bufferIndex,n.end),p=r,v=this.offsetInBuffer(n.bufferIndex,p),P=this.getLineFeedCnt(n.bufferIndex,n.start,p),O=P-s,h=v-o,C=n.length+h;t.piece=new f(n.bufferIndex,n.start,p,P,C),(0,N.updateTreeMetadata)(this,t,h,O)}deleteNodeHead(t,r){const n=t.piece,s=n.lineFeedCnt,o=this.offsetInBuffer(n.bufferIndex,n.start),p=r,v=this.getLineFeedCnt(n.bufferIndex,p,n.end),P=this.offsetInBuffer(n.bufferIndex,p),O=v-s,h=o-P,C=n.length+h;t.piece=new f(n.bufferIndex,p,n.end,v,C),(0,N.updateTreeMetadata)(this,t,h,O)}shrinkNode(t,r,n){const s=t.piece,o=s.start,p=s.end,v=s.length,P=s.lineFeedCnt,O=r,h=this.getLineFeedCnt(s.bufferIndex,s.start,O),C=this.offsetInBuffer(s.bufferIndex,r)-this.offsetInBuffer(s.bufferIndex,o);t.piece=new f(s.bufferIndex,s.start,O,h,C),(0,N.updateTreeMetadata)(this,t,C-v,h-P);const A=new f(s.bufferIndex,n,p,this.getLineFeedCnt(s.bufferIndex,n,p),this.offsetInBuffer(s.bufferIndex,p)-this.offsetInBuffer(s.bufferIndex,n)),V=this.rbInsertRight(t,A);this.validateCRLFWithPrevNode(V)}appendToNode(t,r){this.adjustCarriageReturnFromNext(r,t)&&(r+=`
`);const n=this.shouldCheckCRLF()&&this.startWithLF(r)&&this.endWithCR(t),s=this._buffers[0].buffer.length;this._buffers[0].buffer+=r;const o=E(r,!1);for(let V=0;V<o.length;V++)o[V]+=s;if(n){const V=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-V}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(o.slice(1));const p=this._buffers[0].lineStarts.length-1,v=this._buffers[0].buffer.length-this._buffers[0].lineStarts[p],P={line:p,column:v},O=t.piece.length+r.length,h=t.piece.lineFeedCnt,C=this.getLineFeedCnt(0,t.piece.start,P),A=C-h;t.piece=new f(t.piece.bufferIndex,t.piece.start,P,C,O),this._lastChangeBufferPos=P,(0,N.updateTreeMetadata)(this,t,r.length,A)}nodeAt(t){let r=this.root;const n=this._searchCache.get(t);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:t-n.nodeStartOffset};let s=0;for(;r!==N.SENTINEL;)if(r.size_left>t)r=r.left;else if(r.size_left+r.piece.length>=t){s+=r.size_left;const o={node:r,remainder:t-r.size_left,nodeStartOffset:s};return this._searchCache.set(o),o}else t-=r.size_left+r.piece.length,s+=r.size_left+r.piece.length,r=r.right;return null}nodeAt2(t,r){let n=this.root,s=0;for(;n!==N.SENTINEL;)if(n.left!==N.SENTINEL&&n.lf_left>=t-1)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt>t-1){const o=this.getAccumulatedValue(n,t-n.lf_left-2),p=this.getAccumulatedValue(n,t-n.lf_left-1);return s+=n.size_left,{node:n,remainder:Math.min(o+r-1,p),nodeStartOffset:s}}else if(n.lf_left+n.piece.lineFeedCnt===t-1){const o=this.getAccumulatedValue(n,t-n.lf_left-2);if(o+r-1<=n.piece.length)return{node:n,remainder:o+r-1,nodeStartOffset:s};r-=n.piece.length-o;break}else t-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right;for(n=n.next();n!==N.SENTINEL;){if(n.piece.lineFeedCnt>0){const o=this.getAccumulatedValue(n,0),p=this.offsetOfNode(n);return{node:n,remainder:Math.min(r-1,o),nodeStartOffset:p}}else if(n.piece.length>=r-1){const o=this.offsetOfNode(n);return{node:n,remainder:r-1,nodeStartOffset:o}}else r-=n.piece.length;n=n.next()}return null}nodeCharCodeAt(t,r){if(t.piece.lineFeedCnt<1)return-1;const n=this._buffers[t.piece.bufferIndex],s=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start)+r;return n.buffer.charCodeAt(s)}offsetOfNode(t){if(!t)return 0;let r=t.size_left;for(;t!==this.root;)t.parent.right===t&&(r+=t.parent.size_left+t.parent.piece.length),t=t.parent;return r}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(t){if(typeof t=="string")return t.charCodeAt(0)===10;if(t===N.SENTINEL||t.piece.lineFeedCnt===0)return!1;const r=t.piece,n=this._buffers[r.bufferIndex].lineStarts,s=r.start.line,o=n[s]+r.start.column;return s===n.length-1||n[s+1]>o+1?!1:this._buffers[r.bufferIndex].buffer.charCodeAt(o)===10}endWithCR(t){return typeof t=="string"?t.charCodeAt(t.length-1)===13:t===N.SENTINEL||t.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(t,t.piece.length-1)===13}validateCRLFWithPrevNode(t){if(this.shouldCheckCRLF()&&this.startWithLF(t)){const r=t.prev();this.endWithCR(r)&&this.fixCRLF(r,t)}}validateCRLFWithNextNode(t){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const r=t.next();this.startWithLF(r)&&this.fixCRLF(t,r)}}fixCRLF(t,r){const n=[],s=this._buffers[t.piece.bufferIndex].lineStarts;let o;t.piece.end.column===0?o={line:t.piece.end.line-1,column:s[t.piece.end.line]-s[t.piece.end.line-1]-1}:o={line:t.piece.end.line,column:t.piece.end.column-1};const p=t.piece.length-1,v=t.piece.lineFeedCnt-1;t.piece=new f(t.piece.bufferIndex,t.piece.start,o,v,p),(0,N.updateTreeMetadata)(this,t,-1,-1),t.piece.length===0&&n.push(t);const P={line:r.piece.start.line+1,column:0},O=r.piece.length-1,h=this.getLineFeedCnt(r.piece.bufferIndex,P,r.piece.end);r.piece=new f(r.piece.bufferIndex,P,r.piece.end,h,O),(0,N.updateTreeMetadata)(this,r,-1,-1),r.piece.length===0&&n.push(r);const C=this.createNewPieces(`\r
`);this.rbInsertRight(t,C[0]);for(let A=0;A<n.length;A++)(0,N.rbDelete)(this,n[A])}adjustCarriageReturnFromNext(t,r){if(this.shouldCheckCRLF()&&this.endWithCR(t)){const n=r.next();if(this.startWithLF(n)){if(t+=`
`,n.piece.length===1)(0,N.rbDelete)(this,n);else{const s=n.piece,o={line:s.start.line+1,column:0},p=s.length-1,v=this.getLineFeedCnt(s.bufferIndex,o,s.end);n.piece=new f(s.bufferIndex,o,s.end,v,p),(0,N.updateTreeMetadata)(this,n,-1,-1)}return!0}}return!1}iterate(t,r){if(t===N.SENTINEL)return r(N.SENTINEL);const n=this.iterate(t.left,r);return n&&r(t)&&this.iterate(t.right,r)}getNodeContent(t){if(t===N.SENTINEL)return"";const r=this._buffers[t.piece.bufferIndex],n=t.piece,s=this.offsetInBuffer(n.bufferIndex,n.start),o=this.offsetInBuffer(n.bufferIndex,n.end);return r.buffer.substring(s,o)}getPieceContent(t){const r=this._buffers[t.bufferIndex],n=this.offsetInBuffer(t.bufferIndex,t.start),s=this.offsetInBuffer(t.bufferIndex,t.end);return r.buffer.substring(n,s)}rbInsertRight(t,r){const n=new N.TreeNode(r,1);if(n.left=N.SENTINEL,n.right=N.SENTINEL,n.parent=N.SENTINEL,n.size_left=0,n.lf_left=0,this.root===N.SENTINEL)this.root=n,n.color=0;else if(t.right===N.SENTINEL)t.right=n,n.parent=t;else{const o=(0,N.leftest)(t.right);o.left=n,n.parent=o}return(0,N.fixInsert)(this,n),n}rbInsertLeft(t,r){const n=new N.TreeNode(r,1);if(n.left=N.SENTINEL,n.right=N.SENTINEL,n.parent=N.SENTINEL,n.size_left=0,n.lf_left=0,this.root===N.SENTINEL)this.root=n,n.color=0;else if(t.left===N.SENTINEL)t.left=n,n.parent=t;else{const s=(0,N.righttest)(t.left);s.right=n,n.parent=s}return(0,N.fixInsert)(this,n),n}getContentOfSubTree(t){let r="";return this.iterate(t,n=>(r+=this.getNodeContent(n),!0)),r}}e.PieceTreeBase=a}),define(ue[10],ce([0,1,5,2,3,38]),function(le,e,$,U,j,N){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomPath=e.parseLineAndColumnAware=e.indexOfPath=e.getDriveLetter=e.hasDriveLetter=e.isRootOrDriveLetter=e.sanitizeFilePath=e.isWindowsDriveLetter=e.isEqualOrParent=e.isEqual=e.isValidBasename=e.isUNC=e.getRoot=e.toPosixPath=e.toSlashes=e.isPathSeparator=void 0;function F(h){return h===47||h===92}e.isPathSeparator=F;function K(h){return h.replace(/[\\/]/g,$.posix.sep)}e.toSlashes=K;function S(h){return h.indexOf("/")===-1&&(h=K(h)),/^[a-zA-Z]:(\/|$)/.test(h)&&(h="/"+h),h}e.toPosixPath=S;function m(h,C=$.posix.sep){if(!h)return"";const A=h.length,V=h.charCodeAt(0);if(F(V)){if(F(h.charCodeAt(1))&&!F(h.charCodeAt(2))){let _=3;const z=_;for(;_<A&&!F(h.charCodeAt(_));_++);if(z!==_&&!F(h.charCodeAt(_+1))){for(_+=1;_<A;_++)if(F(h.charCodeAt(_)))return h.slice(0,_+1).replace(/[\\/]/g,C)}}return C}else if(l(V)&&h.charCodeAt(1)===58)return F(h.charCodeAt(2))?h.slice(0,2)+C:h.slice(0,2);let k=h.indexOf("://");if(k!==-1){for(k+=3;k<A;k++)if(F(h.charCodeAt(k)))return h.slice(0,k+1)}return""}e.getRoot=m;function E(h){if(!U.isWindows||!h||h.length<5)return!1;let C=h.charCodeAt(0);if(C!==92||(C=h.charCodeAt(1),C!==92))return!1;let A=2;const V=A;for(;A<h.length&&(C=h.charCodeAt(A),C!==92);A++);return!(V===A||(C=h.charCodeAt(A+1),isNaN(C)||C===92))}e.isUNC=E;const W=/[\\/:\*\?"<>\|]/g,f=/[\\/]/g,L=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function g(h,C=U.isWindows){const A=C?W:f;return!(!h||h.length===0||/^\s+$/.test(h)||(A.lastIndex=0,A.test(h))||C&&L.test(h)||h==="."||h===".."||C&&h[h.length-1]==="."||C&&h.length!==h.trim().length||h.length>255)}e.isValidBasename=g;function c(h,C,A){const V=h===C;return!A||V?V:!h||!C?!1:(0,j.equalsIgnoreCase)(h,C)}e.isEqual=c;function a(h,C,A,V=$.sep){if(h===C)return!0;if(!h||!C||C.length>h.length)return!1;if(A){if(!(0,j.startsWithIgnoreCase)(h,C))return!1;if(C.length===h.length)return!0;let _=C.length;return C.charAt(C.length-1)===V&&_--,h.charAt(_)===V}return C.charAt(C.length-1)!==V&&(C+=V),h.indexOf(C)===0}e.isEqualOrParent=a;function l(h){return h>=65&&h<=90||h>=97&&h<=122}e.isWindowsDriveLetter=l;function t(h,C){return U.isWindows&&h.endsWith(":")&&(h+=$.sep),(0,$.isAbsolute)(h)||(h=(0,$.join)(C,h)),h=(0,$.normalize)(h),U.isWindows?(h=(0,j.rtrim)(h,$.sep),h.endsWith(":")&&(h+=$.sep)):(h=(0,j.rtrim)(h,$.sep),h||(h=$.sep)),h}e.sanitizeFilePath=t;function r(h){const C=(0,$.normalize)(h);return U.isWindows?h.length>3?!1:n(C)&&(h.length===2||C.charCodeAt(2)===92):C===$.posix.sep}e.isRootOrDriveLetter=r;function n(h,C=U.isWindows){return C?l(h.charCodeAt(0))&&h.charCodeAt(1)===58:!1}e.hasDriveLetter=n;function s(h,C=U.isWindows){return n(h,C)?h[0]:void 0}e.getDriveLetter=s;function o(h,C,A){return C.length>h.length?-1:h===C?0:(A&&(h=h.toLowerCase(),C=C.toLowerCase()),h.indexOf(C))}e.indexOfPath=o;function p(h){const C=h.split(":");let A,V,k;for(const _ of C){const z=Number(_);(0,N.isNumber)(z)?V===void 0?V=z:k===void 0&&(k=z):A=A?[A,_].join(":"):_}if(!A)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:A,line:V!==void 0?V:void 0,column:k!==void 0?k:V!==void 0?1:void 0}}e.parseLineAndColumnAware=p;const v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",P="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function O(h,C,A=8){let V="";for(let _=0;_<A;_++){let z;_===0&&U.isWindows&&!C&&(A===3||A===4)?z=P:z=v,V+=z.charAt(Math.floor(Math.random()*z.length))}let k;return C?k=`${C}-${V}`:k=V,h?(0,$.join)(h,k):k}e.randomPath=O}),define(ue[20],ce([0,1,5]),function(le,e,$){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeMimeType=e.getExtensionForMimeType=e.getMediaMime=e.getMediaOrTextMime=e.Mimes=void 0,e.Mimes=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});const U={".css":"text/css",".csv":"text/csv",".htm":"text/html",".html":"text/html",".ics":"text/calendar",".js":"text/javascript",".mjs":"text/javascript",".txt":"text/plain",".xml":"text/xml"},j={".aac":"audio/x-aac",".avi":"video/x-msvideo",".bmp":"image/bmp",".flv":"video/x-flv",".gif":"image/gif",".ico":"image/x-icon",".jpe":"image/jpg",".jpeg":"image/jpg",".jpg":"image/jpg",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3a":"audio/mpeg",".mid":"audio/midi",".midi":"audio/midi",".mk3d":"video/x-matroska",".mks":"video/x-matroska",".mkv":"video/x-matroska",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp2a":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4a":"audio/mp4",".mp4v":"video/mp4",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpg4":"video/mp4",".mpga":"audio/mpeg",".oga":"audio/ogg",".ogg":"audio/ogg",".opus":"audio/opus",".ogv":"video/ogg",".png":"image/png",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".spx":"audio/ogg",".svg":"image/svg+xml",".tga":"image/x-tga",".tif":"image/tiff",".tiff":"image/tiff",".wav":"audio/x-wav",".webm":"video/webm",".webp":"image/webp",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".woff":"application/font-woff"};function N(E){const W=(0,$.extname)(E),f=U[W.toLowerCase()];return f!==void 0?f:F(E)}e.getMediaOrTextMime=N;function F(E){const W=(0,$.extname)(E);return j[W.toLowerCase()]}e.getMediaMime=F;function K(E){for(const W in j)if(j[W]===E)return W}e.getExtensionForMimeType=K;const S=/^(.+)\/(.+?)(;.+)?$/;function m(E,W){const f=S.exec(E);return f?`${f[1].toLowerCase()}/${f[2].toLowerCase()}${f[3]??""}`:W?void 0:E}e.normalizeMimeType=m}),define(ue[11],ce([0,1,4,2,3,12]),function(le,e,$,U,j,N){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COI=e.FileAccess=e.VSCODE_AUTHORITY=e.nodeModulesAsarUnpackedPath=e.nodeModulesAsarPath=e.nodeModulesPath=e.builtinExtensionsPath=e.RemoteAuthorities=e.connectionTokenQueryName=e.connectionTokenCookieName=e.matchesSomeScheme=e.matchesScheme=e.Schemas=void 0;var F;(function(f){f.inMemory="inmemory",f.vscode="vscode",f.internal="private",f.walkThrough="walkThrough",f.walkThroughSnippet="walkThroughSnippet",f.http="http",f.https="https",f.file="file",f.mailto="mailto",f.untitled="untitled",f.data="data",f.command="command",f.vscodeRemote="vscode-remote",f.vscodeRemoteResource="vscode-remote-resource",f.vscodeManagedRemoteResource="vscode-managed-remote-resource",f.vscodeUserData="vscode-userdata",f.vscodeCustomEditor="vscode-custom-editor",f.vscodeNotebookCell="vscode-notebook-cell",f.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",f.vscodeNotebookCellOutput="vscode-notebook-cell-output",f.vscodeInteractiveInput="vscode-interactive-input",f.vscodeSettings="vscode-settings",f.vscodeWorkspaceTrust="vscode-workspace-trust",f.vscodeTerminal="vscode-terminal",f.vscodeChatSesssion="vscode-chat-editor",f.webviewPanel="webview-panel",f.vscodeWebview="vscode-webview",f.extension="extension",f.vscodeFileResource="vscode-file",f.tmp="tmp",f.vsls="vsls",f.vscodeSourceControl="vscode-scm"})(F||(e.Schemas=F={}));function K(f,L){return N.URI.isUri(f)?(0,j.equalsIgnoreCase)(f.scheme,L):(0,j.startsWithIgnoreCase)(f,L+":")}e.matchesScheme=K;function S(f,...L){return L.some(g=>K(f,g))}e.matchesSomeScheme=S,e.connectionTokenCookieName="vscode-tkn",e.connectionTokenQueryName="tkn";class m{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${F.vscodeRemoteResource}`}setPreferredWebSchema(L){this._preferredWebSchema=L}setDelegate(L){this._delegate=L}setServerRootPath(L){this._remoteResourcesPath=`${L}/${F.vscodeRemoteResource}`}set(L,g,c){this._hosts[L]=g,this._ports[L]=c}setConnectionToken(L,g){this._connectionTokens[L]=g}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(L){if(this._delegate)try{return this._delegate(L)}catch(r){return $.onUnexpectedError(r),L}const g=L.authority;let c=this._hosts[g];c&&c.indexOf(":")!==-1&&c.indexOf("[")===-1&&(c=`[${c}]`);const a=this._ports[g],l=this._connectionTokens[g];let t=`path=${encodeURIComponent(L.path)}`;return typeof l=="string"&&(t+=`&${e.connectionTokenQueryName}=${encodeURIComponent(l)}`),N.URI.from({scheme:U.isWeb?this._preferredWebSchema:F.vscodeRemoteResource,authority:`${c}:${a}`,path:this._remoteResourcesPath,query:t})}}e.RemoteAuthorities=new m,e.builtinExtensionsPath="vs/../../extensions",e.nodeModulesPath="vs/../../node_modules",e.nodeModulesAsarPath="vs/../../node_modules.asar",e.nodeModulesAsarUnpackedPath="vs/../../node_modules.asar.unpacked",e.VSCODE_AUTHORITY="vscode-app";class E{static{this.FALLBACK_AUTHORITY=e.VSCODE_AUTHORITY}asBrowserUri(L){const g=this.toUri(L,le);return this.uriToBrowserUri(g)}uriToBrowserUri(L){return L.scheme===F.vscodeRemote?e.RemoteAuthorities.rewrite(L):L.scheme===F.file&&(U.isNative||U.webWorkerOrigin===`${F.vscodeFileResource}://${E.FALLBACK_AUTHORITY}`)?L.with({scheme:F.vscodeFileResource,authority:L.authority||E.FALLBACK_AUTHORITY,query:null,fragment:null}):L}asFileUri(L){const g=this.toUri(L,le);return this.uriToFileUri(g)}uriToFileUri(L){return L.scheme===F.vscodeFileResource?L.with({scheme:F.file,authority:L.authority!==E.FALLBACK_AUTHORITY?L.authority:null,query:null,fragment:null}):L}toUri(L,g){return N.URI.isUri(L)?L:N.URI.parse(g.toUrl(L))}}e.FileAccess=new E;var W;(function(f){const L=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);f.CoopAndCoep=Object.freeze(L.get("3"));const g="vscode-coi";function c(l){let t;typeof l=="string"?t=new URL(l).searchParams:l instanceof URL?t=l.searchParams:N.URI.isUri(l)&&(t=new URL(l.toString(!0)).searchParams);const r=t?.get(g);if(r)return L.get(r)}f.getHeadersFromQuery=c;function a(l,t,r){if(!globalThis.crossOriginIsolated)return;const n=t&&r?"3":r?"2":"1";l instanceof URLSearchParams?l.set(g,n):l[g]=n}f.addSearchParam=a})(W||(e.COI=W={}))}),define(ue[21],ce([0,1,10,11,5,2,3,12]),function(le,e,$,U,j,N,F,K){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toLocalResource=e.DataUri=e.distinctParents=e.addTrailingPathSeparator=e.removeTrailingPathSeparator=e.hasTrailingPathSeparator=e.isEqualAuthority=e.isAbsolutePath=e.resolvePath=e.relativePath=e.normalizePath=e.joinPath=e.dirname=e.extname=e.basename=e.basenameOrAuthority=e.getComparisonKey=e.isEqualOrParent=e.isEqual=e.extUriIgnorePathCase=e.extUriBiasedIgnorePathCase=e.extUri=e.ExtUri=e.originalFSPath=void 0;function S(L){return(0,K.uriToFsPath)(L,!0)}e.originalFSPath=S;class m{constructor(g){this._ignorePathCasing=g}compare(g,c,a=!1){return g===c?0:(0,F.compare)(this.getComparisonKey(g,a),this.getComparisonKey(c,a))}isEqual(g,c,a=!1){return g===c?!0:!g||!c?!1:this.getComparisonKey(g,a)===this.getComparisonKey(c,a)}getComparisonKey(g,c=!1){return g.with({path:this._ignorePathCasing(g)?g.path.toLowerCase():void 0,fragment:c?null:void 0}).toString()}ignorePathCasing(g){return this._ignorePathCasing(g)}isEqualOrParent(g,c,a=!1){if(g.scheme===c.scheme){if(g.scheme===U.Schemas.file)return $.isEqualOrParent(S(g),S(c),this._ignorePathCasing(g))&&g.query===c.query&&(a||g.fragment===c.fragment);if((0,e.isEqualAuthority)(g.authority,c.authority))return $.isEqualOrParent(g.path,c.path,this._ignorePathCasing(g),"/")&&g.query===c.query&&(a||g.fragment===c.fragment)}return!1}joinPath(g,...c){return K.URI.joinPath(g,...c)}basenameOrAuthority(g){return(0,e.basename)(g)||g.authority}basename(g){return j.posix.basename(g.path)}extname(g){return j.posix.extname(g.path)}dirname(g){if(g.path.length===0)return g;let c;return g.scheme===U.Schemas.file?c=K.URI.file(j.dirname(S(g))).path:(c=j.posix.dirname(g.path),g.authority&&c.length&&c.charCodeAt(0)!==47&&(console.error(`dirname("${g.toString})) resulted in a relative path`),c="/")),g.with({path:c})}normalizePath(g){if(!g.path.length)return g;let c;return g.scheme===U.Schemas.file?c=K.URI.file(j.normalize(S(g))).path:c=j.posix.normalize(g.path),g.with({path:c})}relativePath(g,c){if(g.scheme!==c.scheme||!(0,e.isEqualAuthority)(g.authority,c.authority))return;if(g.scheme===U.Schemas.file){const t=j.relative(S(g),S(c));return N.isWindows?$.toSlashes(t):t}let a=g.path||"/";const l=c.path||"/";if(this._ignorePathCasing(g)){let t=0;for(const r=Math.min(a.length,l.length);t<r&&!(a.charCodeAt(t)!==l.charCodeAt(t)&&a.charAt(t).toLowerCase()!==l.charAt(t).toLowerCase());t++);a=l.substr(0,t)+a.substr(t)}return j.posix.relative(a,l)}resolvePath(g,c){if(g.scheme===U.Schemas.file){const a=K.URI.file(j.resolve(S(g),c));return g.with({authority:a.authority,path:a.path})}return c=$.toPosixPath(c),g.with({path:j.posix.resolve(g.path,c)})}isAbsolutePath(g){return!!g.path&&g.path[0]==="/"}isEqualAuthority(g,c){return g===c||g!==void 0&&c!==void 0&&(0,F.equalsIgnoreCase)(g,c)}hasTrailingPathSeparator(g,c=j.sep){if(g.scheme===U.Schemas.file){const a=S(g);return a.length>$.getRoot(a).length&&a[a.length-1]===c}else{const a=g.path;return a.length>1&&a.charCodeAt(a.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(g.fsPath)}}removeTrailingPathSeparator(g,c=j.sep){return(0,e.hasTrailingPathSeparator)(g,c)?g.with({path:g.path.substr(0,g.path.length-1)}):g}addTrailingPathSeparator(g,c=j.sep){let a=!1;if(g.scheme===U.Schemas.file){const l=S(g);a=l!==void 0&&l.length===$.getRoot(l).length&&l[l.length-1]===c}else{c="/";const l=g.path;a=l.length===1&&l.charCodeAt(l.length-1)===47}return!a&&!(0,e.hasTrailingPathSeparator)(g,c)?g.with({path:g.path+"/"}):g}}e.ExtUri=m,e.extUri=new m(()=>!1),e.extUriBiasedIgnorePathCase=new m(L=>L.scheme===U.Schemas.file?!N.isLinux:!0),e.extUriIgnorePathCase=new m(L=>!0),e.isEqual=e.extUri.isEqual.bind(e.extUri),e.isEqualOrParent=e.extUri.isEqualOrParent.bind(e.extUri),e.getComparisonKey=e.extUri.getComparisonKey.bind(e.extUri),e.basenameOrAuthority=e.extUri.basenameOrAuthority.bind(e.extUri),e.basename=e.extUri.basename.bind(e.extUri),e.extname=e.extUri.extname.bind(e.extUri),e.dirname=e.extUri.dirname.bind(e.extUri),e.joinPath=e.extUri.joinPath.bind(e.extUri),e.normalizePath=e.extUri.normalizePath.bind(e.extUri),e.relativePath=e.extUri.relativePath.bind(e.extUri),e.resolvePath=e.extUri.resolvePath.bind(e.extUri),e.isAbsolutePath=e.extUri.isAbsolutePath.bind(e.extUri),e.isEqualAuthority=e.extUri.isEqualAuthority.bind(e.extUri),e.hasTrailingPathSeparator=e.extUri.hasTrailingPathSeparator.bind(e.extUri),e.removeTrailingPathSeparator=e.extUri.removeTrailingPathSeparator.bind(e.extUri),e.addTrailingPathSeparator=e.extUri.addTrailingPathSeparator.bind(e.extUri);function E(L,g){const c=[];for(let a=0;a<L.length;a++){const l=g(L[a]);L.some((t,r)=>r===a?!1:(0,e.isEqualOrParent)(l,g(t)))||c.push(L[a])}return c}e.distinctParents=E;var W;(function(L){L.META_DATA_LABEL="label",L.META_DATA_DESCRIPTION="description",L.META_DATA_SIZE="size",L.META_DATA_MIME="mime";function g(c){const a=new Map;c.path.substring(c.path.indexOf(";")+1,c.path.lastIndexOf(";")).split(";").forEach(r=>{const[n,s]=r.split(":");n&&s&&a.set(n,s)});const t=c.path.substring(0,c.path.indexOf(";"));return t&&a.set(L.META_DATA_MIME,t),a}L.parseMetaData=g})(W||(e.DataUri=W={}));function f(L,g,c){if(g){let a=L.path;return a&&a[0]!==j.posix.sep&&(a=j.posix.sep+a),L.with({scheme:c,authority:g,path:a})}return L.with({scheme:c})}e.toLocalResource=f}),define(ue[22],ce([0,1,39,4,23,7,21,2,15,14]),function(le,e,$,U,j,N,F,K,S,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncIterableSource=e.createCancelableAsyncIterable=e.CancelableAsyncIterableObject=e.AsyncIterableObject=e.LazyStatefulPromise=e.StatefulPromise=e.Promises=e.DeferredPromise=e.IntervalCounter=e.TaskSequentializer=e.retry=e.GlobalIdleValue=e.AbstractIdleValue=e._runWhenIdle=e.runWhenGlobalIdle=e.ThrottledWorker=e.RunOnceWorker=e.ProcessTimeRunOnceScheduler=e.RunOnceScheduler=e.IntervalTimer=e.TimeoutTimer=e.ResourceQueue=e.LimitedQueue=e.Queue=e.Limiter=e.firstParallel=e.first=e.sequence=e.disposableTimeout=e.timeout=e.AutoOpenBarrier=e.Barrier=e.ThrottledDelayer=e.Delayer=e.SequencerByKey=e.Sequencer=e.Throttler=e.asPromise=e.raceTimeout=e.raceCancellablePromises=e.raceCancellationError=e.raceCancellation=e.createCancelablePromise=e.isThenable=void 0;function E(I){return!!I&&typeof I.then=="function"}e.isThenable=E;function W(I){const d=new $.CancellationTokenSource,w=I(d.token),B=new Promise((G,J)=>{const oe=d.token.onCancellationRequested(()=>{oe.dispose(),d.dispose(),J(new U.CancellationError)});Promise.resolve(w).then(he=>{oe.dispose(),d.dispose(),G(he)},he=>{oe.dispose(),d.dispose(),J(he)})});return new class{cancel(){d.cancel()}then(G,J){return B.then(G,J)}catch(G){return this.then(void 0,G)}finally(G){return B.finally(G)}}}e.createCancelablePromise=W;function f(I,d,w){return new Promise((B,G)=>{const J=d.onCancellationRequested(()=>{J.dispose(),B(w)});I.then(B,G).finally(()=>J.dispose())})}e.raceCancellation=f;function L(I,d){return new Promise((w,B)=>{const G=d.onCancellationRequested(()=>{G.dispose(),B(new U.CancellationError)});I.then(w,B).finally(()=>G.dispose())})}e.raceCancellationError=L;async function g(I){let d=-1;const w=I.map((B,G)=>B.then(J=>(d=G,J)));try{return await Promise.race(w)}finally{I.forEach((B,G)=>{G!==d&&B.cancel()})}}e.raceCancellablePromises=g;function c(I,d,w){let B;const G=setTimeout(()=>{B?.(void 0),w?.()},d);return Promise.race([I.finally(()=>clearTimeout(G)),new Promise(J=>B=J)])}e.raceTimeout=c;function a(I){return new Promise((d,w)=>{const B=I();E(B)?B.then(d,w):d(B)})}e.asPromise=a;class l{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(d){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=d,!this.queuedPromise){const w=()=>{if(this.queuedPromise=null,this.isDisposed)return;const B=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,B};this.queuedPromise=new Promise(B=>{this.activePromise.then(w,w).then(B)})}return new Promise((w,B)=>{this.queuedPromise.then(w,B)})}return this.activePromise=d(),new Promise((w,B)=>{this.activePromise.then(G=>{this.activePromise=null,w(G)},G=>{this.activePromise=null,B(G)})})}dispose(){this.isDisposed=!0}}e.Throttler=l;class t{constructor(){this.current=Promise.resolve(null)}queue(d){return this.current=this.current.then(()=>d(),()=>d())}}e.Sequencer=t;class r{constructor(){this.promiseMap=new Map}queue(d,w){const G=(this.promiseMap.get(d)??Promise.resolve()).catch(()=>{}).then(w).finally(()=>{this.promiseMap.get(d)===G&&this.promiseMap.delete(d)});return this.promiseMap.set(d,G),G}}e.SequencerByKey=r;const n=(I,d)=>{let w=!0;const B=setTimeout(()=>{w=!1,d()},I);return{isTriggered:()=>w,dispose:()=>{clearTimeout(B),w=!1}}},s=I=>{let d=!0;return queueMicrotask(()=>{d&&(d=!1,I())}),{isTriggered:()=>d,dispose:()=>{d=!1}}};class o{constructor(d){this.defaultDelay=d,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(d,w=this.defaultDelay){this.task=d,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((G,J)=>{this.doResolve=G,this.doReject=J}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const G=this.task;return this.task=null,G()}}));const B=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=w===S.MicrotaskDelay?s(B):n(w,B),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new U.CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}e.Delayer=o;class p{constructor(d){this.delayer=new o(d),this.throttler=new l}trigger(d,w){return this.delayer.trigger(()=>this.throttler.queue(d),w)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}e.ThrottledDelayer=p;class v{constructor(){this._isOpen=!1,this._promise=new Promise((d,w)=>{this._completePromise=d})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}e.Barrier=v;class P extends v{constructor(d){super(),this._timeout=setTimeout(()=>this.open(),d)}open(){clearTimeout(this._timeout),super.open()}}e.AutoOpenBarrier=P;function O(I,d){return d?new Promise((w,B)=>{const G=setTimeout(()=>{J.dispose(),w()},I),J=d.onCancellationRequested(()=>{clearTimeout(G),J.dispose(),B(new U.CancellationError)})}):W(w=>O(I,w))}e.timeout=O;function h(I,d=0,w){const B=setTimeout(()=>{I(),w&&G.dispose()},d),G=(0,N.toDisposable)(()=>{clearTimeout(B),w?.deleteAndLeak(G)});return w?.add(G),G}e.disposableTimeout=h;function C(I){const d=[];let w=0;const B=I.length;function G(){return w<B?I[w++]():null}function J(oe){oe!=null&&d.push(oe);const he=G();return he?he.then(J):Promise.resolve(d)}return Promise.resolve(null).then(J)}e.sequence=C;function A(I,d=B=>!!B,w=null){let B=0;const G=I.length,J=()=>{if(B>=G)return Promise.resolve(w);const oe=I[B++];return Promise.resolve(oe()).then(fe=>d(fe)?Promise.resolve(fe):J())};return J()}e.first=A;function V(I,d=B=>!!B,w=null){if(I.length===0)return Promise.resolve(w);let B=I.length;const G=()=>{B=-1;for(const J of I)J.cancel?.()};return new Promise((J,oe)=>{for(const he of I)he.then(fe=>{--B>=0&&d(fe)?(G(),J(fe)):B===0&&J(w)}).catch(fe=>{--B>=0&&(G(),oe(fe))})})}e.firstParallel=V;class k{constructor(d){this._size=0,this.maxDegreeOfParalellism=d,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new j.Emitter}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(d){return this._size++,new Promise((w,B)=>{this.outstandingPromises.push({factory:d,c:w,e:B}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const d=this.outstandingPromises.shift();this.runningPromises++;const w=d.factory();w.then(d.c,d.e),w.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._size--,this.runningPromises--,this.outstandingPromises.length>0?this.consume():this._onDrained.fire()}dispose(){this._onDrained.dispose()}}e.Limiter=k;class _ extends k{constructor(){super(1)}}e.Queue=_;class z{constructor(){this.sequentializer=new M,this.tasks=0}queue(d){return this.sequentializer.isRunning()?this.sequentializer.queue(()=>this.sequentializer.run(this.tasks++,d())):this.sequentializer.run(this.tasks++,d())}}e.LimitedQueue=z;class Z{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const d=new X;return this.drainers.add(d),d.p}isDrained(){for(const[,d]of this.queues)if(d.size>0)return!1;return!0}queueFor(d,w=F.extUri){const B=w.getComparisonKey(d);let G=this.queues.get(B);if(!G){G=new _;const J=this.drainListenerCount++,oe=j.Event.once(G.onDrained)(()=>{G?.dispose(),this.queues.delete(B),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(J),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new N.DisposableMap),this.drainListeners.set(J,oe),this.queues.set(B,G)}return G}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const d of this.drainers)d.complete();this.drainers.clear()}dispose(){for(const[,d]of this.queues)d.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}}e.ResourceQueue=Z;class ee{constructor(d,w){this._token=-1,typeof d=="function"&&typeof w=="number"&&this.setIfNotSet(d,w)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(d,w){this.cancel(),this._token=setTimeout(()=>{this._token=-1,d()},w)}setIfNotSet(d,w){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,d()},w))}}e.TimeoutTimer=ee;class re{constructor(){this.disposable=void 0}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(d,w,B=globalThis){this.cancel();const G=B.setInterval(()=>{d()},w);this.disposable=(0,N.toDisposable)(()=>{B.clearInterval(G),this.disposable=void 0})}dispose(){this.cancel()}}e.IntervalTimer=re;class te{constructor(d,w){this.timeoutToken=-1,this.runner=d,this.timeout=w,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(d=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,d)}get delay(){return this.timeout}set delay(d){this.timeout=d}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}e.RunOnceScheduler=te;class ne{constructor(d,w){w%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${w}ms is not a multiple of 1000ms.`),this.runner=d,this.timeout=w,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(d=this.timeout){d%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${d}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(d/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return this.intervalToken!==-1}onInterval(){this.counter--,!(this.counter>0)&&(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner?.())}}e.ProcessTimeRunOnceScheduler=ne;class b extends te{constructor(d,w){super(d,w),this.units=[]}work(d){this.units.push(d),this.isScheduled()||this.schedule()}doRun(){const d=this.units;this.units=[],this.runner?.(d)}dispose(){this.units=[],super.dispose()}}e.RunOnceWorker=b;class Q extends N.Disposable{constructor(d,w){super(),this.options=d,this.handler=w,this.pendingWork=[],this.throttler=this._register(new N.MutableDisposable),this.disposed=!1}get pending(){return this.pendingWork.length}work(d){if(this.disposed)return!1;if(typeof this.options.maxBufferedWork=="number"){if(this.throttler.value){if(this.pending+d.length>this.options.maxBufferedWork)return!1}else if(this.pending+d.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1}for(const w of d)this.pendingWork.push(w);return this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new te(()=>{this.throttler.clear(),this.doWork()},this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}}e.ThrottledWorker=Q,function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?e._runWhenIdle=(I,d)=>{(0,K.setTimeout0)(()=>{if(w)return;const B=Date.now()+15;d(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,B-Date.now())}}))});let w=!1;return{dispose(){w||(w=!0)}}}:e._runWhenIdle=(I,d,w)=>{const B=I.requestIdleCallback(d,typeof w=="number"?{timeout:w}:void 0);let G=!1;return{dispose(){G||(G=!0,I.cancelIdleCallback(B))}}},e.runWhenGlobalIdle=I=>(0,e._runWhenIdle)(globalThis,I)}();class ae{constructor(d,w){this._didRun=!1,this._executor=()=>{try{this._value=w()}catch(B){this._error=B}finally{this._didRun=!0}},this._handle=(0,e._runWhenIdle)(d,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}e.AbstractIdleValue=ae;class D extends ae{constructor(d){super(globalThis,d)}}e.GlobalIdleValue=D;async function q(I,d,w){let B;for(let G=0;G<w;G++)try{return await I()}catch(J){B=J,await O(d)}throw B}e.retry=q;class M{isRunning(d){return typeof d=="number"?this._running?.taskId===d:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(d,w,B){return this._running={taskId:d,cancel:()=>B?.(),promise:w},w.then(()=>this.doneRunning(d),()=>this.doneRunning(d)),w}doneRunning(d){this._running&&d===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){const d=this._queued;this._queued=void 0,d.run().then(d.promiseResolve,d.promiseReject)}}queue(d){if(this._queued)this._queued.run=d;else{let w,B;const G=new Promise((J,oe)=>{w=J,B=oe});this._queued={run:d,promise:G,promiseResolve:w,promiseReject:B}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}}e.TaskSequentializer=M;class H{constructor(d,w=()=>Date.now()){this.interval=d,this.nowFn=w,this.lastIncrementTime=0,this.value=0}increment(){const d=this.nowFn();return d-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=d,this.value=0),this.value++,this.value}}e.IntervalCounter=H;var Y;(function(I){I[I.Resolved=0]="Resolved",I[I.Rejected=1]="Rejected"})(Y||(Y={}));class X{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((d,w)=>{this.completeCallback=d,this.errorCallback=w})}complete(d){return new Promise(w=>{this.completeCallback(d),this.outcome={outcome:0,value:d},w()})}error(d){return new Promise(w=>{this.errorCallback(d),this.outcome={outcome:1,value:d},w()})}cancel(){return this.error(new U.CancellationError)}}e.DeferredPromise=X;var se;(function(I){async function d(B){let G;const J=await Promise.all(B.map(oe=>oe.then(he=>he,he=>{G||(G=he)})));if(typeof G<"u")throw G;return J}I.settled=d;function w(B){return new Promise(async(G,J)=>{try{await B(G,J)}catch(oe){J(oe)}})}I.withAsyncBody=w})(se||(e.Promises=se={}));class x{get value(){return this._value}get error(){return this._error}get isResolved(){return this._isResolved}constructor(d){this._value=void 0,this._error=void 0,this._isResolved=!1,this.promise=d.then(w=>(this._value=w,this._isResolved=!0,w),w=>{throw this._error=w,this._isResolved=!0,w})}requireValue(){if(!this._isResolved)throw new U.BugIndicatingError("Promise is not resolved yet");if(this._error)throw this._error;return this._value}}e.StatefulPromise=x;class y{constructor(d){this._compute=d,this._promise=new m.Lazy(()=>new x(this._compute()))}requireValue(){return this._promise.value.requireValue()}getPromise(){return this._promise.value.promise}}e.LazyStatefulPromise=y;var i;(function(I){I[I.Initial=0]="Initial",I[I.DoneOK=1]="DoneOK",I[I.DoneError=2]="DoneError"})(i||(i={}));class u{static fromArray(d){return new u(w=>{w.emitMany(d)})}static fromPromise(d){return new u(async w=>{w.emitMany(await d)})}static fromPromises(d){return new u(async w=>{await Promise.all(d.map(async B=>w.emitOne(await B)))})}static merge(d){return new u(async w=>{await Promise.all(d.map(async B=>{for await(const G of B)w.emitOne(G)}))})}static{this.EMPTY=u.fromArray([])}constructor(d){this._state=0,this._results=[],this._error=null,this._onStateChanged=new j.Emitter,queueMicrotask(async()=>{const w={emitOne:B=>this.emitOne(B),emitMany:B=>this.emitMany(B),reject:B=>this.reject(B)};try{await Promise.resolve(d(w)),this.resolve()}catch(B){this.reject(B)}finally{w.emitOne=void 0,w.emitMany=void 0,w.reject=void 0}})}[Symbol.asyncIterator](){let d=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(d<this._results.length)return{done:!1,value:this._results[d++]};if(this._state===1)return{done:!0,value:void 0};await j.Event.toPromise(this._onStateChanged.event)}while(!0)}}}static map(d,w){return new u(async B=>{for await(const G of d)B.emitOne(w(G))})}map(d){return u.map(this,d)}static filter(d,w){return new u(async B=>{for await(const G of d)w(G)&&B.emitOne(G)})}filter(d){return u.filter(this,d)}static coalesce(d){return u.filter(d,w=>!!w)}coalesce(){return u.coalesce(this)}static async toPromise(d){const w=[];for await(const B of d)w.push(B);return w}toPromise(){return u.toPromise(this)}emitOne(d){this._state===0&&(this._results.push(d),this._onStateChanged.fire())}emitMany(d){this._state===0&&(this._results=this._results.concat(d),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(d){this._state===0&&(this._state=2,this._error=d,this._onStateChanged.fire())}}e.AsyncIterableObject=u;class R extends u{constructor(d,w){super(w),this._source=d}cancel(){this._source.cancel()}}e.CancelableAsyncIterableObject=R;function T(I){const d=new $.CancellationTokenSource,w=I(d.token);return new R(d,async B=>{const G=d.token.onCancellationRequested(()=>{G.dispose(),d.dispose(),B.reject(new U.CancellationError)});try{for await(const J of w){if(d.token.isCancellationRequested)return;B.emitOne(J)}G.dispose(),d.dispose()}catch(J){G.dispose(),d.dispose(),B.reject(J)}})}e.createCancelableAsyncIterable=T;class ie{constructor(){this._deferred=new X,this._asyncIterable=new u(B=>{if(d){B.reject(d);return}return w&&B.emitMany(w),this._errorFn=G=>B.reject(G),this._emitFn=G=>B.emitOne(G),this._deferred.p});let d,w;this._emitFn=B=>{w||(w=[]),w.push(B)},this._errorFn=B=>{d||(d=B)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(d){this._errorFn(d),this._deferred.complete()}emitOne(d){this._emitFn(d)}}e.AsyncIterableSource=ie}),define(ue[24],ce([0,1,40,22,10,41,5,2,3]),function(le,e,$,U,j,N,F,K,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.patternsEquals=e.getPathTerms=e.getBasenameTerms=e.isRelativePattern=e.parse=e.match=e.splitGlobAware=e.GLOB_SPLIT=e.GLOBSTAR=e.getEmptyExpression=void 0;function m(){return Object.create(null)}e.getEmptyExpression=m,e.GLOBSTAR="**",e.GLOB_SPLIT="/";const E="[/\\\\]",W="[^/\\\\]",f=/\//g;function L(D,q){switch(D){case 0:return"";case 1:return`${W}*?`;default:return`(?:${E}|${W}+${E}${q?`|${E}${W}+`:""})*?`}}function g(D,q){if(!D)return[];const M=[];let H=!1,Y=!1,X="";for(const se of D){switch(se){case q:if(!H&&!Y){M.push(X),X="";continue}break;case"{":H=!0;break;case"}":H=!1;break;case"[":Y=!0;break;case"]":Y=!1;break}X+=se}return X&&M.push(X),M}e.splitGlobAware=g;function c(D){if(!D)return"";let q="";const M=g(D,e.GLOB_SPLIT);if(M.every(H=>H===e.GLOBSTAR))q=".*";else{let H=!1;M.forEach((Y,X)=>{if(Y===e.GLOBSTAR){if(H)return;q+=L(2,X===M.length-1)}else{let se=!1,x="",y=!1,i="";for(const u of Y){if(u!=="}"&&se){x+=u;continue}if(y&&(u!=="]"||!i)){let R;u==="-"?R=u:(u==="^"||u==="!")&&!i?R="^":u===e.GLOB_SPLIT?R="":R=(0,S.escapeRegExpCharacters)(u),i+=R;continue}switch(u){case"{":se=!0;continue;case"[":y=!0;continue;case"}":{const T=`(?:${g(x,",").map(ie=>c(ie)).join("|")})`;q+=T,se=!1,x="";break}case"]":{q+="["+i+"]",y=!1,i="";break}case"?":q+=W;continue;case"*":q+=L(1);continue;default:q+=(0,S.escapeRegExpCharacters)(u)}}X<M.length-1&&(M[X+1]!==e.GLOBSTAR||X+2<M.length)&&(q+=E)}H=Y===e.GLOBSTAR})}return q}const a=/^\*\*\/\*\.[\w\.-]+$/,l=/^\*\*\/([\w\.-]+)\/?$/,t=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,r=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,n=/^\*\*((\/[\w\.-]+)+)\/?$/,s=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,o=new N.LRUCache(1e4),p=function(){return!1},v=function(){return null};function P(D,q){if(!D)return v;let M;typeof D!="string"?M=D.pattern:M=D,M=M.trim();const H=`${M}_${!!q.trimForExclusions}`;let Y=o.get(H);if(Y)return O(Y,D);let X;return a.test(M)?Y=C(M.substr(4),M):(X=l.exec(h(M,q)))?Y=A(X[1],M):(q.trimForExclusions?r:t).test(M)?Y=V(M,q):(X=n.exec(h(M,q)))?Y=k(X[1].substr(1),M,!0):(X=s.exec(h(M,q)))?Y=k(X[1],M,!1):Y=_(M),o.set(H,Y),O(Y,D)}function O(D,q){if(typeof q=="string")return D;const M=function(H,Y){return(0,j.isEqualOrParent)(H,q.base,!K.isLinux)?D((0,S.ltrim)(H.substr(q.base.length),F.sep),Y):null};return M.allBasenames=D.allBasenames,M.allPaths=D.allPaths,M.basenames=D.basenames,M.patterns=D.patterns,M}function h(D,q){return q.trimForExclusions&&D.endsWith("/**")?D.substr(0,D.length-2):D}function C(D,q){return function(M,H){return typeof M=="string"&&M.endsWith(D)?q:null}}function A(D,q){const M=`/${D}`,H=`\\${D}`,Y=function(se,x){return typeof se!="string"?null:x?x===D?q:null:se===D||se.endsWith(M)||se.endsWith(H)?q:null},X=[D];return Y.basenames=X,Y.patterns=[q],Y.allBasenames=X,Y}function V(D,q){const M=Q(D.slice(1,-1).split(",").map(x=>P(x,q)).filter(x=>x!==v),D),H=M.length;if(!H)return v;if(H===1)return M[0];const Y=function(x,y){for(let i=0,u=M.length;i<u;i++)if(M[i](x,y))return D;return null},X=M.find(x=>!!x.allBasenames);X&&(Y.allBasenames=X.allBasenames);const se=M.reduce((x,y)=>y.allPaths?x.concat(y.allPaths):x,[]);return se.length&&(Y.allPaths=se),Y}function k(D,q,M){const H=F.sep===F.posix.sep,Y=H?D:D.replace(f,F.sep),X=F.sep+Y,se=F.posix.sep+D;let x;return M?x=function(y,i){return typeof y=="string"&&(y===Y||y.endsWith(X)||!H&&(y===D||y.endsWith(se)))?q:null}:x=function(y,i){return typeof y=="string"&&(y===Y||!H&&y===D)?q:null},x.allPaths=[(M?"*/":"./")+D],x}function _(D){try{const q=new RegExp(`^${c(D)}$`);return function(M){return q.lastIndex=0,typeof M=="string"&&q.test(M)?D:null}}catch{return v}}function z(D,q,M){return!D||typeof q!="string"?!1:Z(D)(q,void 0,M)}e.match=z;function Z(D,q={}){if(!D)return p;if(typeof D=="string"||ee(D)){const M=P(D,q);if(M===v)return p;const H=function(Y,X){return!!M(Y,X)};return M.allBasenames&&(H.allBasenames=M.allBasenames),M.allPaths&&(H.allPaths=M.allPaths),H}return ne(D,q)}e.parse=Z;function ee(D){const q=D;return q?typeof q.base=="string"&&typeof q.pattern=="string":!1}e.isRelativePattern=ee;function re(D){return D.allBasenames||[]}e.getBasenameTerms=re;function te(D){return D.allPaths||[]}e.getPathTerms=te;function ne(D,q){const M=Q(Object.getOwnPropertyNames(D).map(x=>b(x,D[x],q)).filter(x=>x!==v)),H=M.length;if(!H)return v;if(!M.some(x=>!!x.requiresSiblings)){if(H===1)return M[0];const x=function(u,R){let T;for(let ie=0,I=M.length;ie<I;ie++){const d=M[ie](u,R);if(typeof d=="string")return d;(0,U.isThenable)(d)&&(T||(T=[]),T.push(d))}return T?(async()=>{for(const ie of T){const I=await ie;if(typeof I=="string")return I}return null})():null},y=M.find(u=>!!u.allBasenames);y&&(x.allBasenames=y.allBasenames);const i=M.reduce((u,R)=>R.allPaths?u.concat(R.allPaths):u,[]);return i.length&&(x.allPaths=i),x}const Y=function(x,y,i){let u,R;for(let T=0,ie=M.length;T<ie;T++){const I=M[T];I.requiresSiblings&&i&&(y||(y=(0,F.basename)(x)),u||(u=y.substr(0,y.length-(0,F.extname)(x).length)));const d=I(x,y,u,i);if(typeof d=="string")return d;(0,U.isThenable)(d)&&(R||(R=[]),R.push(d))}return R?(async()=>{for(const T of R){const ie=await T;if(typeof ie=="string")return ie}return null})():null},X=M.find(x=>!!x.allBasenames);X&&(Y.allBasenames=X.allBasenames);const se=M.reduce((x,y)=>y.allPaths?x.concat(y.allPaths):x,[]);return se.length&&(Y.allPaths=se),Y}function b(D,q,M){if(q===!1)return v;const H=P(D,M);if(H===v)return v;if(typeof q=="boolean")return H;if(q){const Y=q.when;if(typeof Y=="string"){const X=(se,x,y,i)=>{if(!i||!H(se,x))return null;const u=Y.replace("$(basename)",()=>y),R=i(u);return(0,U.isThenable)(R)?R.then(T=>T?D:null):R?D:null};return X.requiresSiblings=!0,X}}return H}function Q(D,q){const M=D.filter(x=>!!x.basenames);if(M.length<2)return D;const H=M.reduce((x,y)=>{const i=y.basenames;return i?x.concat(i):x},[]);let Y;if(q){Y=[];for(let x=0,y=H.length;x<y;x++)Y.push(q)}else Y=M.reduce((x,y)=>{const i=y.patterns;return i?x.concat(i):x},[]);const X=function(x,y){if(typeof x!="string")return null;if(!y){let u;for(u=x.length;u>0;u--){const R=x.charCodeAt(u-1);if(R===47||R===92)break}y=x.substr(u)}const i=H.indexOf(y);return i!==-1?Y[i]:null};X.basenames=H,X.patterns=Y,X.allBasenames=H;const se=D.filter(x=>!x.basenames);return se.push(X),se}function ae(D,q){return(0,$.equals)(D,q,(M,H)=>typeof M=="string"&&typeof H=="string"?M===H:typeof M!="string"&&typeof H!="string"?M.base===H.base&&M.pattern===H.pattern:!1)}e.patternsEquals=ae}),define(ue[25],ce([0,1,3,2,6]),function(le,e,$,U,j){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StringBuilder=e.decodeUTF16LE=e.getPlatformTextDecoder=void 0;let N;function F(){return N||(N=new TextDecoder("UTF-16LE")),N}let K;function S(){return K||(K=new TextDecoder("UTF-16BE")),K}let m;function E(){return m||(m=U.isLittleEndian()?F():S()),m}e.getPlatformTextDecoder=E;function W(g,c,a){const l=new Uint16Array(g.buffer,c,a);return a>0&&(l[0]===65279||l[0]===65534)?f(g,c,a):F().decode(l)}e.decodeUTF16LE=W;function f(g,c,a){const l=[];let t=0;for(let r=0;r<a;r++){const n=j.readUInt16LE(g,c);c+=2,l[t++]=String.fromCharCode(n)}return l.join("")}class L{constructor(c){this._capacity=c|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const c=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return E().decode(c)}_flushBuffer(){const c=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[c]:this._completedStrings[this._completedStrings.length]=c}appendCharCode(c){const a=this._capacity-this._bufferLength;a<=1&&(a===0||$.isHighSurrogate(c))&&this._flushBuffer(),this._buffer[this._bufferLength++]=c}appendASCIICharCode(c){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=c}appendString(c){const a=c.length;if(this._bufferLength+a>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=c;return}for(let l=0;l<a;l++)this._buffer[this._bufferLength++]=c.charCodeAt(l)}}e.StringBuilder=L}),define(ue[26],ce([0,1,6,25]),function(le,e,$,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compressConsecutiveTextChanges=e.TextChange=void 0;function j(S){return S.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class N{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(m,E,W,f){this.oldPosition=m,this.oldText=E,this.newPosition=W,this.newText=f}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${j(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${j(this.oldText)}")`:`(replace@${this.oldPosition} "${j(this.oldText)}" with "${j(this.newText)}")`}static _writeStringSize(m){return 4+2*m.length}static _writeString(m,E,W){const f=E.length;$.writeUInt32BE(m,f,W),W+=4;for(let L=0;L<f;L++)$.writeUInt16LE(m,E.charCodeAt(L),W),W+=2;return W}static _readString(m,E){const W=$.readUInt32BE(m,E);return E+=4,(0,U.decodeUTF16LE)(m,E,W)}writeSize(){return 4+4+N._writeStringSize(this.oldText)+N._writeStringSize(this.newText)}write(m,E){return $.writeUInt32BE(m,this.oldPosition,E),E+=4,$.writeUInt32BE(m,this.newPosition,E),E+=4,E=N._writeString(m,this.oldText,E),E=N._writeString(m,this.newText,E),E}static read(m,E,W){const f=$.readUInt32BE(m,E);E+=4;const L=$.readUInt32BE(m,E);E+=4;const g=N._readString(m,E);E+=N._writeStringSize(g);const c=N._readString(m,E);return E+=N._writeStringSize(c),W.push(new N(f,g,L,c)),E}}e.TextChange=N;function F(S,m){return S===null||S.length===0?m:new K(S,m).compress()}e.compressConsecutiveTextChanges=F;class K{constructor(m,E){this._prevEdits=m,this._currEdits=E,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let m=0,E=0,W=this._getPrev(m),f=this._getCurr(E);for(;m<this._prevLen||E<this._currLen;){if(W===null){this._acceptCurr(f),f=this._getCurr(++E);continue}if(f===null){this._acceptPrev(W),W=this._getPrev(++m);continue}if(f.oldEnd<=W.newPosition){this._acceptCurr(f),f=this._getCurr(++E);continue}if(W.newEnd<=f.oldPosition){this._acceptPrev(W),W=this._getPrev(++m);continue}if(f.oldPosition<W.newPosition){const[l,t]=K._splitCurr(f,W.newPosition-f.oldPosition);this._acceptCurr(l),f=t;continue}if(W.newPosition<f.oldPosition){const[l,t]=K._splitPrev(W,f.oldPosition-W.newPosition);this._acceptPrev(l),W=t;continue}let c,a;if(f.oldEnd===W.newEnd)c=W,a=f,W=this._getPrev(++m),f=this._getCurr(++E);else if(f.oldEnd<W.newEnd){const[l,t]=K._splitPrev(W,f.oldLength);c=l,a=f,W=t,f=this._getCurr(++E)}else{const[l,t]=K._splitCurr(f,W.newLength);c=W,a=l,W=this._getPrev(++m),f=t}this._result[this._resultLen++]=new N(c.oldPosition,c.oldText,a.newPosition,a.newText),this._prevDeltaOffset+=c.newLength-c.oldLength,this._currDeltaOffset+=a.newLength-a.oldLength}const L=K._merge(this._result);return K._removeNoOps(L)}_acceptCurr(m){this._result[this._resultLen++]=K._rebaseCurr(this._prevDeltaOffset,m),this._currDeltaOffset+=m.newLength-m.oldLength}_getCurr(m){return m<this._currLen?this._currEdits[m]:null}_acceptPrev(m){this._result[this._resultLen++]=K._rebasePrev(this._currDeltaOffset,m),this._prevDeltaOffset+=m.newLength-m.oldLength}_getPrev(m){return m<this._prevLen?this._prevEdits[m]:null}static _rebaseCurr(m,E){return new N(E.oldPosition-m,E.oldText,E.newPosition,E.newText)}static _rebasePrev(m,E){return new N(E.oldPosition,E.oldText,E.newPosition+m,E.newText)}static _splitPrev(m,E){const W=m.newText.substr(0,E),f=m.newText.substr(E);return[new N(m.oldPosition,m.oldText,m.newPosition,W),new N(m.oldEnd,"",m.newPosition+E,f)]}static _splitCurr(m,E){const W=m.oldText.substr(0,E),f=m.oldText.substr(E);return[new N(m.oldPosition,W,m.newPosition,m.newText),new N(m.oldPosition+E,f,m.newEnd,"")]}static _merge(m){if(m.length===0)return m;const E=[];let W=0,f=m[0];for(let L=1;L<m.length;L++){const g=m[L];f.oldEnd===g.oldPosition?f=new N(f.oldPosition,f.oldText+g.oldText,f.newPosition,f.newText+g.newText):(E[W++]=f,f=g)}return E[W++]=f,E}static _removeNoOps(m){if(m.length===0)return m;const E=[];let W=0;for(let f=0;f<m.length;f++){const L=m[f];L.oldText!==L.newText&&(E[W++]=L)}return E}}}),define(ue[27],ce([0,1,23,3,9,18,8,16,26,7]),function(le,e,$,U,j,N,F,K,S,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeTextBuffer=void 0;class E extends m.Disposable{constructor(f,L,g,c,a,l,t){super(),this._onDidChangeContent=this._register(new $.Emitter),this.onDidChangeContent=this._onDidChangeContent.event,this._BOM=L,this._mightContainNonBasicASCII=!l,this._mightContainRTL=c,this._mightContainUnusualLineTerminators=a,this._pieceTree=new F.PieceTreeBase(f,g,t)}equals(f){return!(f instanceof E)||this._BOM!==f._BOM||this.getEOL()!==f.getEOL()?!1:this._pieceTree.equal(f._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(f){return this._pieceTree.createSnapshot(f?this._BOM:"")}getOffsetAt(f,L){return this._pieceTree.getOffsetAt(f,L)}getPositionAt(f){return this._pieceTree.getPositionAt(f)}getRangeAt(f,L){const g=f+L,c=this.getPositionAt(f),a=this.getPositionAt(g);return new j.Range(c.lineNumber,c.column,a.lineNumber,a.column)}getValueInRange(f,L=0){if(f.isEmpty())return"";const g=this._getEndOfLine(L);return this._pieceTree.getValueInRange(f,g)}getValueLengthInRange(f,L=0){if(f.isEmpty())return 0;if(f.startLineNumber===f.endLineNumber)return f.endColumn-f.startColumn;const g=this.getOffsetAt(f.startLineNumber,f.startColumn),c=this.getOffsetAt(f.endLineNumber,f.endColumn);let a=0;const l=this._getEndOfLine(L),t=this.getEOL();if(l.length!==t.length){const r=l.length-t.length,n=f.endLineNumber-f.startLineNumber;a=r*n}return c-g+a}getCharacterCountInRange(f,L=0){if(this._mightContainNonBasicASCII){let g=0;const c=f.startLineNumber,a=f.endLineNumber;for(let l=c;l<=a;l++){const t=this.getLineContent(l),r=l===c?f.startColumn-1:0,n=l===a?f.endColumn-1:t.length;for(let s=r;s<n;s++)U.isHighSurrogate(t.charCodeAt(s))?(g=g+1,s=s+1):g=g+1}return g+=this._getEndOfLine(L).length*(a-c),g}return this.getValueLengthInRange(f,L)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(f){return this._pieceTree.getLineContent(f)}getLineCharCode(f,L){return this._pieceTree.getLineCharCode(f,L)}getCharCode(f){return this._pieceTree.getCharCode(f)}getLineLength(f){return this._pieceTree.getLineLength(f)}getLineMinColumn(f){return 1}getLineMaxColumn(f){return this.getLineLength(f)+1}getLineFirstNonWhitespaceColumn(f){const L=U.firstNonWhitespaceIndex(this.getLineContent(f));return L===-1?0:L+1}getLineLastNonWhitespaceColumn(f){const L=U.lastNonWhitespaceIndex(this.getLineContent(f));return L===-1?0:L+2}_getEndOfLine(f){switch(f){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(f){this._pieceTree.setEOL(f)}applyEdits(f,L,g){let c=this._mightContainRTL,a=this._mightContainUnusualLineTerminators,l=this._mightContainNonBasicASCII,t=!0,r=[];for(let O=0;O<f.length;O++){const h=f[O];t&&h._isTracked&&(t=!1);const C=h.range;if(h.text){let z=!0;l||(z=!U.isBasicASCII(h.text),l=z),!c&&z&&(c=U.containsRTL(h.text)),!a&&z&&(a=U.containsUnusualLineTerminators(h.text))}let A="",V=0,k=0,_=0;if(h.text){let z;[V,k,_,z]=(0,K.countEOL)(h.text);const Z=this.getEOL();z===0||z===(Z===`\r
`?2:1)?A=h.text:A=h.text.replace(/\r\n|\r|\n/g,Z)}r[O]={sortIndex:O,identifier:h.identifier||null,range:C,rangeOffset:this.getOffsetAt(C.startLineNumber,C.startColumn),rangeLength:this.getValueLengthInRange(C),text:A,eolCount:V,firstLineLength:k,lastLineLength:_,forceMoveMarkers:!!h.forceMoveMarkers,isAutoWhitespaceEdit:h.isAutoWhitespaceEdit||!1}}r.sort(E._sortOpsAscending);let n=!1;for(let O=0,h=r.length-1;O<h;O++){const C=r[O].range.getEndPosition(),A=r[O+1].range.getStartPosition();if(A.isBeforeOrEqual(C)){if(A.isBefore(C))throw new Error("Overlapping ranges are not allowed!");n=!0}}t&&(r=this._reduceOperations(r));const s=g||L?E._getInverseEditRanges(r):[],o=[];if(L)for(let O=0;O<r.length;O++){const h=r[O],C=s[O];if(h.isAutoWhitespaceEdit&&h.range.isEmpty())for(let A=C.startLineNumber;A<=C.endLineNumber;A++){let V="";A===C.startLineNumber&&(V=this.getLineContent(h.range.startLineNumber),U.firstNonWhitespaceIndex(V)!==-1)||o.push({lineNumber:A,oldContent:V})}}let p=null;if(g){let O=0;p=[];for(let h=0;h<r.length;h++){const C=r[h],A=s[h],V=this.getValueInRange(C.range),k=C.rangeOffset+O;O+=C.text.length-V.length,p[h]={sortIndex:C.sortIndex,identifier:C.identifier,range:A,text:V,textChange:new S.TextChange(C.rangeOffset,V,k,C.text)}}n||p.sort((h,C)=>h.sortIndex-C.sortIndex)}this._mightContainRTL=c,this._mightContainUnusualLineTerminators=a,this._mightContainNonBasicASCII=l;const v=this._doApplyEdits(r);let P=null;if(L&&o.length>0){o.sort((O,h)=>h.lineNumber-O.lineNumber),P=[];for(let O=0,h=o.length;O<h;O++){const C=o[O].lineNumber;if(O>0&&o[O-1].lineNumber===C)continue;const A=o[O].oldContent,V=this.getLineContent(C);V.length===0||V===A||U.firstNonWhitespaceIndex(V)!==-1||P.push(C)}}return this._onDidChangeContent.fire(),new N.ApplyEditsResult(p,v,P)}_reduceOperations(f){return f.length<1e3?f:[this._toSingleEditOperation(f)]}_toSingleEditOperation(f){let L=!1;const g=f[0].range,c=f[f.length-1].range,a=new j.Range(g.startLineNumber,g.startColumn,c.endLineNumber,c.endColumn);let l=g.startLineNumber,t=g.startColumn;const r=[];for(let v=0,P=f.length;v<P;v++){const O=f[v],h=O.range;L=L||O.forceMoveMarkers,r.push(this.getValueInRange(new j.Range(l,t,h.startLineNumber,h.startColumn))),O.text.length>0&&r.push(O.text),l=h.endLineNumber,t=h.endColumn}const n=r.join(""),[s,o,p]=(0,K.countEOL)(n);return{sortIndex:0,identifier:f[0].identifier,range:a,rangeOffset:this.getOffsetAt(a.startLineNumber,a.startColumn),rangeLength:this.getValueLengthInRange(a,0),text:n,eolCount:s,firstLineLength:o,lastLineLength:p,forceMoveMarkers:L,isAutoWhitespaceEdit:!1}}_doApplyEdits(f){f.sort(E._sortOpsDescending);const L=[];for(let g=0;g<f.length;g++){const c=f[g],a=c.range.startLineNumber,l=c.range.startColumn,t=c.range.endLineNumber,r=c.range.endColumn;if(a===t&&l===r&&c.text.length===0)continue;c.text?(this._pieceTree.delete(c.rangeOffset,c.rangeLength),this._pieceTree.insert(c.rangeOffset,c.text,!0)):this._pieceTree.delete(c.rangeOffset,c.rangeLength);const n=new j.Range(a,l,t,r);L.push({range:n,rangeLength:c.rangeLength,text:c.text,rangeOffset:c.rangeOffset,forceMoveMarkers:c.forceMoveMarkers})}return L}findMatchesLineByLine(f,L,g,c){return this._pieceTree.findMatchesLineByLine(f,L,g,c)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(f,L){const g=f.startLineNumber,c=f.startColumn,[a,l,t]=(0,K.countEOL)(L);let r;if(L.length>0){const n=a+1;n===1?r=new j.Range(g,c,g,c+l):r=new j.Range(g,c,g+n-1,t+1)}else r=new j.Range(g,c,g,c);return r}static _getInverseEditRanges(f){const L=[];let g=0,c=0,a=null;for(let l=0,t=f.length;l<t;l++){const r=f[l];let n,s;a?a.range.endLineNumber===r.range.startLineNumber?(n=g,s=c+(r.range.startColumn-a.range.endColumn)):(n=g+(r.range.startLineNumber-a.range.endLineNumber),s=r.range.startColumn):(n=r.range.startLineNumber,s=r.range.startColumn);let o;if(r.text.length>0){const p=r.eolCount+1;p===1?o=new j.Range(n,s,n,s+r.firstLineLength):o=new j.Range(n,s,n+p-1,r.lastLineLength+1)}else o=new j.Range(n,s,n,s);g=o.endLineNumber,c=o.endColumn,L.push(o),a=r}return L}static _sortOpsAscending(f,L){const g=j.Range.compareRangesUsingEnds(f.range,L.range);return g===0?f.sortIndex-L.sortIndex:g}static _sortOpsDescending(f,L){const g=j.Range.compareRangesUsingEnds(f.range,L.range);return g===0?L.sortIndex-f.sortIndex:-g}}e.PieceTreeTextBuffer=E}),define(ue[28],ce([0,1,3,8,27]),function(le,e,$,U,j){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PieceTreeTextBufferBuilder=void 0;class N{constructor(S,m,E,W,f,L,g,c,a){this._chunks=S,this._bom=m,this._cr=E,this._lf=W,this._crlf=f,this._containsRTL=L,this._containsUnusualLineTerminators=g,this._isBasicASCII=c,this._normalizeEOL=a}_getEOL(S){const m=this._cr+this._lf+this._crlf,E=this._cr+this._crlf;return m===0?S===1?`
`:`\r
`:E>m/2?`\r
`:`
`}create(S){const m=this._getEOL(S),E=this._chunks;if(this._normalizeEOL&&(m===`\r
`&&(this._cr>0||this._lf>0)||m===`
`&&(this._cr>0||this._crlf>0)))for(let f=0,L=E.length;f<L;f++){const g=E[f].buffer.replace(/\r\n|\r|\n/g,m),c=(0,U.createLineStartsFast)(g);E[f]=new U.StringBuffer(g,c)}const W=new j.PieceTreeTextBuffer(E,this._bom,m,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:W,disposable:W}}getFirstLineText(S){return this._chunks[0].buffer.substr(0,S).split(/\r\n|\r|\n/)[0]}}class F{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(S){if(S.length===0)return;this.chunks.length===0&&$.startsWithUTF8BOM(S)&&(this.BOM=$.UTF8_BOM_CHARACTER,S=S.substr(1));const m=S.charCodeAt(S.length-1);m===13||m>=55296&&m<=56319?(this._acceptChunk1(S.substr(0,S.length-1),!1),this._hasPreviousChar=!0,this._previousChar=m):(this._acceptChunk1(S,!1),this._hasPreviousChar=!1,this._previousChar=m)}_acceptChunk1(S,m){!m&&S.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+S):this._acceptChunk2(S))}_acceptChunk2(S){const m=(0,U.createLineStarts)(this._tmpLineStarts,S);this.chunks.push(new U.StringBuffer(S,m.lineStarts)),this.cr+=m.cr,this.lf+=m.lf,this.crlf+=m.crlf,m.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=$.containsRTL(S)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=$.containsUnusualLineTerminators(S)))}finish(S=!0){return this._finish(),new N(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,S)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const S=this.chunks[this.chunks.length-1];S.buffer+=String.fromCharCode(this._previousChar);const m=(0,U.createLineStartsFast)(S.buffer);S.lineStarts=m,this._previousChar===13&&this.cr++}}}e.PieceTreeTextBufferBuilder=F}),define(ue[29],ce([30,31]),function(le,e){return le.create("vs/platform/contextkey/common/contextkey",e)}),define(ue[32],ce([30,31]),function(le,e){return le.create("vs/platform/contextkey/common/scanner",e)}),define(ue[33],ce([0,1,4,32]),function(le,e,$,U){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Scanner=e.TokenType=void 0;var j;(function(m){m[m.LParen=0]="LParen",m[m.RParen=1]="RParen",m[m.Neg=2]="Neg",m[m.Eq=3]="Eq",m[m.NotEq=4]="NotEq",m[m.Lt=5]="Lt",m[m.LtEq=6]="LtEq",m[m.Gt=7]="Gt",m[m.GtEq=8]="GtEq",m[m.RegexOp=9]="RegexOp",m[m.RegexStr=10]="RegexStr",m[m.True=11]="True",m[m.False=12]="False",m[m.In=13]="In",m[m.Not=14]="Not",m[m.And=15]="And",m[m.Or=16]="Or",m[m.Str=17]="Str",m[m.QuotedStr=18]="QuotedStr",m[m.Error=19]="Error",m[m.EOF=20]="EOF"})(j||(e.TokenType=j={}));function N(...m){switch(m.length){case 1:return(0,U.localize)(0,null,m[0]);case 2:return(0,U.localize)(1,null,m[0],m[1]);case 3:return(0,U.localize)(2,null,m[0],m[1],m[2]);default:return}}const F=(0,U.localize)(3,null),K=(0,U.localize)(4,null);class S{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(E){switch(E.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return E.isTripleEq?"===":"==";case 4:return E.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return E.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return E.lexeme;case 18:return E.lexeme;case 19:return E.lexeme;case 20:return"EOF";default:throw(0,$.illegalState)(`unhandled token type: ${JSON.stringify(E)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(E=>E.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this._errors}reset(E){return this._input=E,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const W=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:W})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const W=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:W})}else this._match(126)?this._addToken(9):this._error(N("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(N("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(N("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(E){return this._isAtEnd()||this._input.charCodeAt(this._current)!==E?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(E){this._tokens.push({type:E,offset:this._start})}_error(E){const W=this._start,f=this._input.substring(this._start,this._current),L={type:19,offset:this._start,lexeme:f};this._errors.push({offset:W,lexeme:f,additionalInfo:E}),this._tokens.push(L)}_string(){this.stringRe.lastIndex=this._start;const E=this.stringRe.exec(this._input);if(E){this._current=this._start+E[0].length;const W=this._input.substring(this._start,this._current),f=S._keywords.get(W);f?this._addToken(f):this._tokens.push({type:17,lexeme:W,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(F);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let E=this._current,W=!1,f=!1;for(;;){if(E>=this._input.length){this._current=E,this._error(K);return}const g=this._input.charCodeAt(E);if(W)W=!1;else if(g===47&&!f){E++;break}else g===91?f=!0:g===92?W=!0:g===93&&(f=!1);E++}for(;E<this._input.length&&S._regexFlags.has(this._input.charCodeAt(E));)E++;this._current=E;const L=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:L,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}e.Scanner=S}),define(ue[34],ce([0,1]),function(le,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.refineServiceDecorator=e.createDecorator=e.IInstantiationService=e._util=void 0;var $;(function(F){F.serviceIds=new Map,F.DI_TARGET="$di$target",F.DI_DEPENDENCIES="$di$dependencies";function K(S){return S[F.DI_DEPENDENCIES]||[]}F.getServiceDependencies=K})($||(e._util=$={})),e.IInstantiationService=j("instantiationService");function U(F,K,S){K[$.DI_TARGET]===K?K[$.DI_DEPENDENCIES].push({id:F,index:S}):(K[$.DI_DEPENDENCIES]=[{id:F,index:S}],K[$.DI_TARGET]=K)}function j(F){if($.serviceIds.has(F))return $.serviceIds.get(F);const K=function(S,m,E){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");U(K,S,E)};return K.toString=()=>F,$.serviceIds.set(F,K),K}e.createDecorator=j;function N(F){return F}e.refineServiceDecorator=N}),define(ue[35],ce([0,1,2,3,33,34,29,4]),function(le,e,$,U,j,N,F,K){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.implies=e.IContextKeyService=e.RawContextKey=e.ContextKeyOrExpr=e.ContextKeyAndExpr=e.ContextKeyNotRegexExpr=e.ContextKeyRegexExpr=e.ContextKeySmallerEqualsExpr=e.ContextKeySmallerExpr=e.ContextKeyGreaterEqualsExpr=e.ContextKeyGreaterExpr=e.ContextKeyNotExpr=e.ContextKeyNotEqualsExpr=e.ContextKeyNotInExpr=e.ContextKeyInExpr=e.ContextKeyEqualsExpr=e.ContextKeyDefinedExpr=e.ContextKeyTrueExpr=e.ContextKeyFalseExpr=e.expressionsAreEqualWithConstantSubstitution=e.validateWhenClauses=e.ContextKeyExpr=e.Parser=e.ContextKeyExprType=e.setConstant=void 0;const S=new Map;S.set("false",!1),S.set("true",!0),S.set("isMac",$.isMacintosh),S.set("isLinux",$.isLinux),S.set("isWindows",$.isWindows),S.set("isWeb",$.isWeb),S.set("isMacNative",$.isMacintosh&&!$.isWeb),S.set("isEdge",$.isEdge),S.set("isFirefox",$.isFirefox),S.set("isChrome",$.isChrome),S.set("isSafari",$.isSafari);function m(y,i){if(S.get(y)!==void 0)throw(0,K.illegalArgument)("contextkey.setConstant(k, v) invoked with already set constant `k`");S.set(y,i)}e.setConstant=m;const E=Object.prototype.hasOwnProperty;var W;(function(y){y[y.False=0]="False",y[y.True=1]="True",y[y.Defined=2]="Defined",y[y.Not=3]="Not",y[y.Equals=4]="Equals",y[y.NotEquals=5]="NotEquals",y[y.And=6]="And",y[y.Regex=7]="Regex",y[y.NotRegex=8]="NotRegex",y[y.Or=9]="Or",y[y.In=10]="In",y[y.NotIn=11]="NotIn",y[y.Greater=12]="Greater",y[y.GreaterEquals=13]="GreaterEquals",y[y.Smaller=14]="Smaller",y[y.SmallerEquals=15]="SmallerEquals"})(W||(e.ContextKeyExprType=W={}));const f={regexParsingWithErrorRecovery:!0},L=(0,F.localize)(0,null),g=(0,F.localize)(1,null),c=(0,F.localize)(2,null),a=(0,F.localize)(3,null),l=(0,F.localize)(4,null),t=(0,F.localize)(5,null),r=(0,F.localize)(6,null),n=(0,F.localize)(7,null);class s{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(i=f){this._config=i,this._scanner=new j.Scanner,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(i){if(i===""){this._parsingErrors.push({message:L,offset:0,lexeme:"",additionalInfo:g});return}this._tokens=this._scanner.reset(i).scan(),this._current=0,this._parsingErrors=[];try{const u=this._expr();if(!this._isAtEnd()){const R=this._peek(),T=R.type===17?t:void 0;throw this._parsingErrors.push({message:l,offset:R.offset,lexeme:j.Scanner.getLexeme(R),additionalInfo:T}),s._parseError}return u}catch(u){if(u!==s._parseError)throw u;return}}_expr(){return this._or()}_or(){const i=[this._and()];for(;this._matchOne(16);){const u=this._and();i.push(u)}return i.length===1?i[0]:o.or(...i)}_and(){const i=[this._term()];for(;this._matchOne(15);){const u=this._term();i.push(u)}return i.length===1?i[0]:o.and(...i)}_term(){if(this._matchOne(2)){const i=this._peek();switch(i.type){case 11:return this._advance(),O.INSTANCE;case 12:return this._advance(),h.INSTANCE;case 0:{this._advance();const u=this._expr();return this._consume(1,a),u?.negate()}case 17:return this._advance(),z.create(i.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",i)}}return this._primary()}_primary(){const i=this._peek();switch(i.type){case 11:return this._advance(),o.true();case 12:return this._advance(),o.false();case 0:{this._advance();const u=this._expr();return this._consume(1,a),u}case 17:{const u=i.lexeme;if(this._advance(),this._matchOne(9)){const T=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),T.type!==10)throw this._errExpectedButGot("REGEX",T);const ie=T.lexeme,I=ie.lastIndexOf("/"),d=I===ie.length-1?void 0:this._removeFlagsGY(ie.substring(I+1));let w;try{w=new RegExp(ie.substring(1,I),d)}catch{throw this._errExpectedButGot("REGEX",T)}return b.create(u,w)}switch(T.type){case 10:case 19:{const ie=[T.lexeme];this._advance();let I=this._peek(),d=0;for(let oe=0;oe<T.lexeme.length;oe++)T.lexeme.charCodeAt(oe)===40?d++:T.lexeme.charCodeAt(oe)===41&&d--;for(;!this._isAtEnd()&&I.type!==15&&I.type!==16;){switch(I.type){case 0:d++;break;case 1:d--;break;case 10:case 18:for(let oe=0;oe<I.lexeme.length;oe++)I.lexeme.charCodeAt(oe)===40?d++:T.lexeme.charCodeAt(oe)===41&&d--}if(d<0)break;ie.push(j.Scanner.getLexeme(I)),this._advance(),I=this._peek()}const w=ie.join(""),B=w.lastIndexOf("/"),G=B===w.length-1?void 0:this._removeFlagsGY(w.substring(B+1));let J;try{J=new RegExp(w.substring(1,B),G)}catch{throw this._errExpectedButGot("REGEX",T)}return o.regex(u,J)}case 18:{const ie=T.lexeme;this._advance();let I=null;if(!(0,U.isFalsyOrWhitespace)(ie)){const d=ie.indexOf("/"),w=ie.lastIndexOf("/");if(d!==w&&d>=0){const B=ie.slice(d+1,w),G=ie[w+1]==="i"?"i":"";try{I=new RegExp(B,G)}catch{throw this._errExpectedButGot("REGEX",T)}}}if(I===null)throw this._errExpectedButGot("REGEX",T);return b.create(u,I)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,c);const T=this._value();return o.notIn(u,T)}switch(this._peek().type){case 3:{this._advance();const T=this._value();if(this._previous().type===18)return o.equals(u,T);switch(T){case"true":return o.has(u);case"false":return o.not(u);default:return o.equals(u,T)}}case 4:{this._advance();const T=this._value();if(this._previous().type===18)return o.notEquals(u,T);switch(T){case"true":return o.not(u);case"false":return o.has(u);default:return o.notEquals(u,T)}}case 5:return this._advance(),te.create(u,this._value());case 6:return this._advance(),ne.create(u,this._value());case 7:return this._advance(),ee.create(u,this._value());case 8:return this._advance(),re.create(u,this._value());case 13:return this._advance(),o.in(u,this._value());default:return o.has(u)}}case 20:throw this._parsingErrors.push({message:r,offset:i.offset,lexeme:"",additionalInfo:n}),s._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const i=this._peek();switch(i.type){case 17:case 18:return this._advance(),i.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(i){return i.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(i){return this._check(i)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(i,u){if(this._check(i))return this._advance();throw this._errExpectedButGot(u,this._peek())}_errExpectedButGot(i,u,R){const T=(0,F.localize)(8,null,i,j.Scanner.getLexeme(u)),ie=u.offset,I=j.Scanner.getLexeme(u);return this._parsingErrors.push({message:T,offset:ie,lexeme:I,additionalInfo:R}),s._parseError}_check(i){return this._peek().type===i}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}}e.Parser=s;class o{static false(){return O.INSTANCE}static true(){return h.INSTANCE}static has(i){return C.create(i)}static equals(i,u){return A.create(i,u)}static notEquals(i,u){return _.create(i,u)}static regex(i,u){return b.create(i,u)}static in(i,u){return V.create(i,u)}static notIn(i,u){return k.create(i,u)}static not(i){return z.create(i)}static and(...i){return D.create(i,null,!0)}static or(...i){return q.create(i,null,!0)}static greater(i,u){return ee.create(i,u)}static greaterEquals(i,u){return re.create(i,u)}static smaller(i,u){return te.create(i,u)}static smallerEquals(i,u){return ne.create(i,u)}static{this._parser=new s({regexParsingWithErrorRecovery:!1})}static deserialize(i){return i==null?void 0:this._parser.parse(i)}}e.ContextKeyExpr=o;function p(y){const i=new s({regexParsingWithErrorRecovery:!1});return y.map(u=>(i.parse(u),i.lexingErrors.length>0?i.lexingErrors.map(R=>({errorMessage:R.additionalInfo?(0,F.localize)(9,null,R.additionalInfo):(0,F.localize)(10,null),offset:R.offset,length:R.lexeme.length})):i.parsingErrors.length>0?i.parsingErrors.map(R=>({errorMessage:R.additionalInfo?`${R.message}. ${R.additionalInfo}`:R.message,offset:R.offset,length:R.lexeme.length})):[]))}e.validateWhenClauses=p;function v(y,i){const u=y?y.substituteConstants():void 0,R=i?i.substituteConstants():void 0;return!u&&!R?!0:!u||!R?!1:u.equals(R)}e.expressionsAreEqualWithConstantSubstitution=v;function P(y,i){return y.cmp(i)}class O{static{this.INSTANCE=new O}constructor(){this.type=0}cmp(i){return this.type-i.type}equals(i){return i.type===this.type}substituteConstants(){return this}evaluate(i){return!1}serialize(){return"false"}keys(){return[]}map(i){return this}negate(){return h.INSTANCE}}e.ContextKeyFalseExpr=O;class h{static{this.INSTANCE=new h}constructor(){this.type=1}cmp(i){return this.type-i.type}equals(i){return i.type===this.type}substituteConstants(){return this}evaluate(i){return!0}serialize(){return"true"}keys(){return[]}map(i){return this}negate(){return O.INSTANCE}}e.ContextKeyTrueExpr=h;class C{static create(i,u=null){const R=S.get(i);return typeof R=="boolean"?R?h.INSTANCE:O.INSTANCE:new C(i,u)}constructor(i,u){this.key=i,this.negated=u,this.type=2}cmp(i){return i.type!==this.type?this.type-i.type:H(this.key,i.key)}equals(i){return i.type===this.type?this.key===i.key:!1}substituteConstants(){const i=S.get(this.key);return typeof i=="boolean"?i?h.INSTANCE:O.INSTANCE:this}evaluate(i){return!!i.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(i){return i.mapDefined(this.key)}negate(){return this.negated||(this.negated=z.create(this.key,this)),this.negated}}e.ContextKeyDefinedExpr=C;class A{static create(i,u,R=null){if(typeof u=="boolean")return u?C.create(i,R):z.create(i,R);const T=S.get(i);return typeof T=="boolean"?u===(T?"true":"false")?h.INSTANCE:O.INSTANCE:new A(i,u,R)}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=4}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){const i=S.get(this.key);if(typeof i=="boolean"){const u=i?"true":"false";return this.value===u?h.INSTANCE:O.INSTANCE}return this}evaluate(i){return i.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(i){return i.mapEquals(this.key,this.value)}negate(){return this.negated||(this.negated=_.create(this.key,this.value,this)),this.negated}}e.ContextKeyEqualsExpr=A;class V{static create(i,u){return new V(i,u)}constructor(i,u){this.key=i,this.valueKey=u,this.type=10,this.negated=null}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.valueKey,i.key,i.valueKey)}equals(i){return i.type===this.type?this.key===i.key&&this.valueKey===i.valueKey:!1}substituteConstants(){return this}evaluate(i){const u=i.getValue(this.valueKey),R=i.getValue(this.key);return Array.isArray(u)?u.includes(R):typeof R=="string"&&typeof u=="object"&&u!==null?E.call(u,R):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(i){return i.mapIn(this.key,this.valueKey)}negate(){return this.negated||(this.negated=k.create(this.key,this.valueKey)),this.negated}}e.ContextKeyInExpr=V;class k{static create(i,u){return new k(i,u)}constructor(i,u){this.key=i,this.valueKey=u,this.type=11,this._negated=V.create(i,u)}cmp(i){return i.type!==this.type?this.type-i.type:this._negated.cmp(i._negated)}equals(i){return i.type===this.type?this._negated.equals(i._negated):!1}substituteConstants(){return this}evaluate(i){return!this._negated.evaluate(i)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(i){return i.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}e.ContextKeyNotInExpr=k;class _{static create(i,u,R=null){if(typeof u=="boolean")return u?z.create(i,R):C.create(i,R);const T=S.get(i);return typeof T=="boolean"?u===(T?"true":"false")?O.INSTANCE:h.INSTANCE:new _(i,u,R)}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=5}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){const i=S.get(this.key);if(typeof i=="boolean"){const u=i?"true":"false";return this.value===u?O.INSTANCE:h.INSTANCE}return this}evaluate(i){return i.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(i){return i.mapNotEquals(this.key,this.value)}negate(){return this.negated||(this.negated=A.create(this.key,this.value,this)),this.negated}}e.ContextKeyNotEqualsExpr=_;class z{static create(i,u=null){const R=S.get(i);return typeof R=="boolean"?R?O.INSTANCE:h.INSTANCE:new z(i,u)}constructor(i,u){this.key=i,this.negated=u,this.type=3}cmp(i){return i.type!==this.type?this.type-i.type:H(this.key,i.key)}equals(i){return i.type===this.type?this.key===i.key:!1}substituteConstants(){const i=S.get(this.key);return typeof i=="boolean"?i?O.INSTANCE:h.INSTANCE:this}evaluate(i){return!i.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(i){return i.mapNot(this.key)}negate(){return this.negated||(this.negated=C.create(this.key,this)),this.negated}}e.ContextKeyNotExpr=z;function Z(y,i){if(typeof y=="string"){const u=parseFloat(y);isNaN(u)||(y=u)}return typeof y=="string"||typeof y=="number"?i(y):O.INSTANCE}class ee{static create(i,u,R=null){return Z(u,T=>new ee(i,T,R))}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=12}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){return this}evaluate(i){return typeof this.value=="string"?!1:parseFloat(i.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(i){return i.mapGreater(this.key,this.value)}negate(){return this.negated||(this.negated=ne.create(this.key,this.value,this)),this.negated}}e.ContextKeyGreaterExpr=ee;class re{static create(i,u,R=null){return Z(u,T=>new re(i,T,R))}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=13}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){return this}evaluate(i){return typeof this.value=="string"?!1:parseFloat(i.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(i){return i.mapGreaterEquals(this.key,this.value)}negate(){return this.negated||(this.negated=te.create(this.key,this.value,this)),this.negated}}e.ContextKeyGreaterEqualsExpr=re;class te{static create(i,u,R=null){return Z(u,T=>new te(i,T,R))}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=14}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){return this}evaluate(i){return typeof this.value=="string"?!1:parseFloat(i.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(i){return i.mapSmaller(this.key,this.value)}negate(){return this.negated||(this.negated=re.create(this.key,this.value,this)),this.negated}}e.ContextKeySmallerExpr=te;class ne{static create(i,u,R=null){return Z(u,T=>new ne(i,T,R))}constructor(i,u,R){this.key=i,this.value=u,this.negated=R,this.type=15}cmp(i){return i.type!==this.type?this.type-i.type:Y(this.key,this.value,i.key,i.value)}equals(i){return i.type===this.type?this.key===i.key&&this.value===i.value:!1}substituteConstants(){return this}evaluate(i){return typeof this.value=="string"?!1:parseFloat(i.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(i){return i.mapSmallerEquals(this.key,this.value)}negate(){return this.negated||(this.negated=ee.create(this.key,this.value,this)),this.negated}}e.ContextKeySmallerEqualsExpr=ne;class b{static create(i,u){return new b(i,u)}constructor(i,u){this.key=i,this.regexp=u,this.type=7,this.negated=null}cmp(i){if(i.type!==this.type)return this.type-i.type;if(this.key<i.key)return-1;if(this.key>i.key)return 1;const u=this.regexp?this.regexp.source:"",R=i.regexp?i.regexp.source:"";return u<R?-1:u>R?1:0}equals(i){if(i.type===this.type){const u=this.regexp?this.regexp.source:"",R=i.regexp?i.regexp.source:"";return this.key===i.key&&u===R}return!1}substituteConstants(){return this}evaluate(i){const u=i.getValue(this.key);return this.regexp?this.regexp.test(u):!1}serialize(){const i=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${i}`}keys(){return[this.key]}map(i){return i.mapRegex(this.key,this.regexp)}negate(){return this.negated||(this.negated=Q.create(this)),this.negated}}e.ContextKeyRegexExpr=b;class Q{static create(i){return new Q(i)}constructor(i){this._actual=i,this.type=8}cmp(i){return i.type!==this.type?this.type-i.type:this._actual.cmp(i._actual)}equals(i){return i.type===this.type?this._actual.equals(i._actual):!1}substituteConstants(){return this}evaluate(i){return!this._actual.evaluate(i)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(i){return new Q(this._actual.map(i))}negate(){return this._actual}}e.ContextKeyNotRegexExpr=Q;function ae(y){let i=null;for(let u=0,R=y.length;u<R;u++){const T=y[u].substituteConstants();if(y[u]!==T&&i===null){i=[];for(let ie=0;ie<u;ie++)i[ie]=y[ie]}i!==null&&(i[u]=T)}return i===null?y:i}class D{static create(i,u,R){return D._normalizeArr(i,u,R)}constructor(i,u){this.expr=i,this.negated=u,this.type=6}cmp(i){if(i.type!==this.type)return this.type-i.type;if(this.expr.length<i.expr.length)return-1;if(this.expr.length>i.expr.length)return 1;for(let u=0,R=this.expr.length;u<R;u++){const T=P(this.expr[u],i.expr[u]);if(T!==0)return T}return 0}equals(i){if(i.type===this.type){if(this.expr.length!==i.expr.length)return!1;for(let u=0,R=this.expr.length;u<R;u++)if(!this.expr[u].equals(i.expr[u]))return!1;return!0}return!1}substituteConstants(){const i=ae(this.expr);return i===this.expr?this:D.create(i,this.negated,!1)}evaluate(i){for(let u=0,R=this.expr.length;u<R;u++)if(!this.expr[u].evaluate(i))return!1;return!0}static _normalizeArr(i,u,R){const T=[];let ie=!1;for(const I of i)if(I){if(I.type===1){ie=!0;continue}if(I.type===0)return O.INSTANCE;if(I.type===6){T.push(...I.expr);continue}T.push(I)}if(T.length===0&&ie)return h.INSTANCE;if(T.length!==0){if(T.length===1)return T[0];T.sort(P);for(let I=1;I<T.length;I++)T[I-1].equals(T[I])&&(T.splice(I,1),I--);if(T.length===1)return T[0];for(;T.length>1;){const I=T[T.length-1];if(I.type!==9)break;T.pop();const d=T.pop(),w=T.length===0,B=q.create(I.expr.map(G=>D.create([G,d],null,R)),null,w);B&&(T.push(B),T.sort(P))}if(T.length===1)return T[0];if(R){for(let I=0;I<T.length;I++)for(let d=I+1;d<T.length;d++)if(T[I].negate().equals(T[d]))return O.INSTANCE;if(T.length===1)return T[0]}return new D(T,u)}}serialize(){return this.expr.map(i=>i.serialize()).join(" && ")}keys(){const i=[];for(const u of this.expr)i.push(...u.keys());return i}map(i){return new D(this.expr.map(u=>u.map(i)),null)}negate(){if(!this.negated){const i=[];for(const u of this.expr)i.push(u.negate());this.negated=q.create(i,this,!0)}return this.negated}}e.ContextKeyAndExpr=D;class q{static create(i,u,R){return q._normalizeArr(i,u,R)}constructor(i,u){this.expr=i,this.negated=u,this.type=9}cmp(i){if(i.type!==this.type)return this.type-i.type;if(this.expr.length<i.expr.length)return-1;if(this.expr.length>i.expr.length)return 1;for(let u=0,R=this.expr.length;u<R;u++){const T=P(this.expr[u],i.expr[u]);if(T!==0)return T}return 0}equals(i){if(i.type===this.type){if(this.expr.length!==i.expr.length)return!1;for(let u=0,R=this.expr.length;u<R;u++)if(!this.expr[u].equals(i.expr[u]))return!1;return!0}return!1}substituteConstants(){const i=ae(this.expr);return i===this.expr?this:q.create(i,this.negated,!1)}evaluate(i){for(let u=0,R=this.expr.length;u<R;u++)if(this.expr[u].evaluate(i))return!0;return!1}static _normalizeArr(i,u,R){let T=[],ie=!1;if(i){for(let I=0,d=i.length;I<d;I++){const w=i[I];if(w){if(w.type===0){ie=!0;continue}if(w.type===1)return h.INSTANCE;if(w.type===9){T=T.concat(w.expr);continue}T.push(w)}}if(T.length===0&&ie)return O.INSTANCE;T.sort(P)}if(T.length!==0){if(T.length===1)return T[0];for(let I=1;I<T.length;I++)T[I-1].equals(T[I])&&(T.splice(I,1),I--);if(T.length===1)return T[0];if(R){for(let I=0;I<T.length;I++)for(let d=I+1;d<T.length;d++)if(T[I].negate().equals(T[d]))return h.INSTANCE;if(T.length===1)return T[0]}return new q(T,u)}}serialize(){return this.expr.map(i=>i.serialize()).join(" || ")}keys(){const i=[];for(const u of this.expr)i.push(...u.keys());return i}map(i){return new q(this.expr.map(u=>u.map(i)),null)}negate(){if(!this.negated){const i=[];for(const u of this.expr)i.push(u.negate());for(;i.length>1;){const u=i.shift(),R=i.shift(),T=[];for(const ie of x(u))for(const I of x(R))T.push(D.create([ie,I],null,!1));i.unshift(q.create(T,null,!1))}this.negated=q.create(i,this,!0)}return this.negated}}e.ContextKeyOrExpr=q;class M extends C{static{this._info=[]}static all(){return M._info.values()}constructor(i,u,R){super(i,null),this._defaultValue=u,typeof R=="object"?M._info.push({...R,key:i}):R!==!0&&M._info.push({key:i,description:R,type:u!=null?typeof u:void 0})}bindTo(i){return i.createKey(this.key,this._defaultValue)}getValue(i){return i.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(i){return A.create(this.key,i)}notEqualsTo(i){return _.create(this.key,i)}}e.RawContextKey=M,e.IContextKeyService=(0,N.createDecorator)("contextKeyService");function H(y,i){return y<i?-1:y>i?1:0}function Y(y,i,u,R){return y<u?-1:y>u?1:i<R?-1:i>R?1:0}function X(y,i){if(y.type===0||i.type===1)return!0;if(y.type===9)return i.type===9?se(y.expr,i.expr):!1;if(i.type===9){for(const u of i.expr)if(X(y,u))return!0;return!1}if(y.type===6){if(i.type===6)return se(i.expr,y.expr);for(const u of y.expr)if(X(u,i))return!0;return!1}return y.equals(i)}e.implies=X;function se(y,i){let u=0,R=0;for(;u<y.length&&R<i.length;){const T=y[u].cmp(i[R]);if(T<0)return!1;T===0&&u++,R++}return u===y.length}function x(y){return y.type===9?y.expr:[y]}}),define(ue[36],ce([0,1,6,24,42,20,11,5,2,35]),function(le,e,$,U,j,N,F,K,S,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOVE_CURSOR_1_LINE_COMMAND=e.compressOutputItemStreams=e.isTextStreamMime=e.NotebookWorkingCopyTypeIdentifier=e.CellStatusbarAlignment=e.NotebookSetting=e.notebookDocumentFilterMatch=e.isDocumentExcludePattern=e.NotebookEditorPriority=e.NOTEBOOK_EDITOR_CURSOR_LINE_BOUNDARY=e.NOTEBOOK_EDITOR_CURSOR_BOUNDARY=e.diff=e.MimeTypeDisplayOrder=e.CellUri=e.CellEditType=e.SelectionStateType=e.NotebookCellsChangeType=e.RendererMessagingSpec=e.NotebookRendererMatch=e.NotebookExecutionState=e.NotebookCellExecutionState=e.NotebookRunState=e.RENDERER_NOT_AVAILABLE=e.RENDERER_EQUIVALENT_EXTENSIONS=e.ACCESSIBLE_NOTEBOOK_DISPLAY_ORDER=e.NOTEBOOK_DISPLAY_ORDER=e.CellKind=e.INTERACTIVE_WINDOW_EDITOR_ID=e.NOTEBOOK_DIFF_EDITOR_ID=e.NOTEBOOK_EDITOR_ID=void 0,e.NOTEBOOK_EDITOR_ID="workbench.editor.notebook",e.NOTEBOOK_DIFF_EDITOR_ID="workbench.editor.notebookTextDiffEditor",e.INTERACTIVE_WINDOW_EDITOR_ID="workbench.editor.interactive";var E;(function(b){b[b.Markup=1]="Markup",b[b.Code=2]="Code"})(E||(e.CellKind=E={})),e.NOTEBOOK_DISPLAY_ORDER=["application/json","application/javascript","text/html","image/svg+xml",N.Mimes.latex,N.Mimes.markdown,"image/png","image/jpeg",N.Mimes.text],e.ACCESSIBLE_NOTEBOOK_DISPLAY_ORDER=[N.Mimes.latex,N.Mimes.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",N.Mimes.text],e.RENDERER_EQUIVALENT_EXTENSIONS=new Map([["ms-toolsai.jupyter",new Set(["jupyter-notebook","interactive"])],["ms-toolsai.jupyter-renderers",new Set(["jupyter-notebook","interactive"])]]),e.RENDERER_NOT_AVAILABLE="_notAvailable";var W;(function(b){b[b.Running=1]="Running",b[b.Idle=2]="Idle"})(W||(e.NotebookRunState=W={}));var f;(function(b){b[b.Unconfirmed=1]="Unconfirmed",b[b.Pending=2]="Pending",b[b.Executing=3]="Executing"})(f||(e.NotebookCellExecutionState=f={}));var L;(function(b){b[b.Unconfirmed=1]="Unconfirmed",b[b.Pending=2]="Pending",b[b.Executing=3]="Executing"})(L||(e.NotebookExecutionState=L={}));var g;(function(b){b[b.WithHardKernelDependency=0]="WithHardKernelDependency",b[b.WithOptionalKernelDependency=1]="WithOptionalKernelDependency",b[b.Pure=2]="Pure",b[b.Never=3]="Never"})(g||(e.NotebookRendererMatch=g={}));var c;(function(b){b.Always="always",b.Never="never",b.Optional="optional"})(c||(e.RendererMessagingSpec=c={}));var a;(function(b){b[b.ModelChange=1]="ModelChange",b[b.Move=2]="Move",b[b.ChangeCellLanguage=5]="ChangeCellLanguage",b[b.Initialize=6]="Initialize",b[b.ChangeCellMetadata=7]="ChangeCellMetadata",b[b.Output=8]="Output",b[b.OutputItem=9]="OutputItem",b[b.ChangeCellContent=10]="ChangeCellContent",b[b.ChangeDocumentMetadata=11]="ChangeDocumentMetadata",b[b.ChangeCellInternalMetadata=12]="ChangeCellInternalMetadata",b[b.ChangeCellMime=13]="ChangeCellMime",b[b.Unknown=100]="Unknown"})(a||(e.NotebookCellsChangeType=a={}));var l;(function(b){b[b.Handle=0]="Handle",b[b.Index=1]="Index"})(l||(e.SelectionStateType=l={}));var t;(function(b){b[b.Replace=1]="Replace",b[b.Output=2]="Output",b[b.Metadata=3]="Metadata",b[b.CellLanguage=4]="CellLanguage",b[b.DocumentMetadata=5]="DocumentMetadata",b[b.Move=6]="Move",b[b.OutputItems=7]="OutputItems",b[b.PartialMetadata=8]="PartialMetadata",b[b.PartialInternalMetadata=9]="PartialInternalMetadata"})(t||(e.CellEditType=t={}));var r;(function(b){b.scheme=F.Schemas.vscodeNotebookCell;const Q=["W","X","Y","Z","a","b","c","d","e","f"],ae=new RegExp(`^[${Q.join("")}]+`),D=7;function q(x,y){const i=y.toString(D),R=`${i.length<Q.length?Q[i.length-1]:"z"}${i}s${(0,$.encodeBase64)($.VSBuffer.fromString(x.scheme),!0,!0)}`;return x.with({scheme:b.scheme,fragment:R})}b.generate=q;function M(x){if(x.scheme!==b.scheme)return;const y=x.fragment.indexOf("s");if(y<0)return;const i=parseInt(x.fragment.substring(0,y).replace(ae,""),D),u=(0,$.decodeBase64)(x.fragment.substring(y+1)).toString();if(!isNaN(i))return{handle:i,notebook:x.with({scheme:u,fragment:null})}}b.parse=M;function H(x,y){return x.with({scheme:F.Schemas.vscodeNotebookCellOutput,fragment:`op${y??""},${x.scheme!==F.Schemas.file?x.scheme:""}`})}b.generateCellOutputUri=H;function Y(x){if(x.scheme!==F.Schemas.vscodeNotebookCellOutput)return;const y=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(x.fragment);if(!y)return;const i=y[1]&&y[1]!==""?y[1]:void 0,u=y[2];return{outputId:i,notebook:x.with({scheme:u||F.Schemas.file,fragment:null})}}b.parseCellOutputUri=Y;function X(x,y,i){return b.generate(x,y).with({scheme:i})}b.generateCellPropertyUri=X;function se(x,y){if(x.scheme===y)return b.parse(x.with({scheme:b.scheme}))}b.parseCellPropertyUri=se})(r||(e.CellUri=r={}));const n=b=>S.isWindows?b.replace(/\//g,"\\"):b;class s{constructor(Q=[],ae=e.NOTEBOOK_DISPLAY_ORDER){this.defaultOrder=ae,this.order=[...new Set(Q)].map(D=>({pattern:D,matches:U.parse(n(D))}))}sort(Q){const ae=new Map(j.Iterable.map(Q,q=>[q,n(q)]));let D=[];for(const{matches:q}of this.order)for(const[M,H]of ae)if(q(H)){D.push(M),ae.delete(M);break}return ae.size&&(D=D.concat([...ae.keys()].sort((q,M)=>this.defaultOrder.indexOf(q)-this.defaultOrder.indexOf(M)))),D}prioritize(Q,ae){const D=this.findIndex(Q);if(D===-1){this.order.unshift({pattern:Q,matches:U.parse(n(Q))});return}const q=new Set(ae.map(H=>this.findIndex(H,D)));q.delete(-1);const M=Array.from(q).sort();this.order.splice(D+1,0,...M.map(H=>this.order[H]));for(let H=M.length-1;H>=0;H--)this.order.splice(M[H],1)}toArray(){return this.order.map(Q=>Q.pattern)}findIndex(Q,ae=this.order.length){const D=n(Q);for(let q=0;q<ae;q++)if(this.order[q].matches(D))return q;return-1}}e.MimeTypeDisplayOrder=s;function o(b,Q,ae,D=(q,M)=>q===M){const q=[];function M(X,se,x){if(se===0&&x.length===0)return;const y=q[q.length-1];y&&y.start+y.deleteCount===X?(y.deleteCount+=se,y.toInsert.push(...x)):q.push({start:X,deleteCount:se,toInsert:x})}let H=0,Y=0;for(;;){if(H===b.length){M(H,0,Q.slice(Y));break}if(Y===Q.length){M(H,b.length-H,[]);break}const X=b[H],se=Q[Y];if(D(X,se)){H+=1,Y+=1;continue}ae(se)?(M(H,1,[]),H+=1):(M(H,0,[se]),Y+=1)}return q}e.diff=o,e.NOTEBOOK_EDITOR_CURSOR_BOUNDARY=new m.RawContextKey("notebookEditorCursorAtBoundary","none"),e.NOTEBOOK_EDITOR_CURSOR_LINE_BOUNDARY=new m.RawContextKey("notebookEditorCursorAtLineBoundary","none");var p;(function(b){b.default="default",b.option="option"})(p||(e.NotebookEditorPriority=p={}));function v(b){const Q=b;return!!((typeof Q.include=="string"||U.isRelativePattern(Q.include))&&(typeof Q.exclude=="string"||U.isRelativePattern(Q.exclude)))}e.isDocumentExcludePattern=v;function P(b,Q,ae){if(Array.isArray(b.viewType)&&b.viewType.indexOf(Q)>=0||b.viewType===Q)return!0;if(b.filenamePattern){const D=v(b.filenamePattern)?b.filenamePattern.include:b.filenamePattern,q=v(b.filenamePattern)?b.filenamePattern.exclude:void 0;if(U.match(D,(0,K.basename)(ae.fsPath).toLowerCase()))return!(q&&U.match(q,(0,K.basename)(ae.fsPath).toLowerCase()))}return!1}e.notebookDocumentFilterMatch=P,e.NotebookSetting={displayOrder:"notebook.displayOrder",cellToolbarLocation:"notebook.cellToolbarLocation",cellToolbarVisibility:"notebook.cellToolbarVisibility",showCellStatusBar:"notebook.showCellStatusBar",textDiffEditorPreview:"notebook.diff.enablePreview",diffOverviewRuler:"notebook.diff.overviewRuler",experimentalInsertToolbarAlignment:"notebook.experimental.insertToolbarAlignment",compactView:"notebook.compactView",focusIndicator:"notebook.cellFocusIndicator",insertToolbarLocation:"notebook.insertToolbarLocation",globalToolbar:"notebook.globalToolbar",stickyScroll:"notebook.stickyScroll.enabled",undoRedoPerCell:"notebook.undoRedoPerCell",consolidatedOutputButton:"notebook.consolidatedOutputButton",showFoldingControls:"notebook.showFoldingControls",dragAndDropEnabled:"notebook.dragAndDropEnabled",cellEditorOptionsCustomizations:"notebook.editorOptionsCustomizations",consolidatedRunButton:"notebook.consolidatedRunButton",openGettingStarted:"notebook.experimental.openGettingStarted",globalToolbarShowLabel:"notebook.globalToolbarShowLabel",markupFontSize:"notebook.markup.fontSize",interactiveWindowCollapseCodeCells:"interactiveWindow.collapseCellInputCode",outputScrollingDeprecated:"notebook.experimental.outputScrolling",outputScrolling:"notebook.output.scrolling",textOutputLineLimit:"notebook.output.textLineLimit",formatOnSave:"notebook.formatOnSave.enabled",insertFinalNewline:"notebook.insertFinalNewline",formatOnCellExecution:"notebook.formatOnCellExecution",codeActionsOnSave:"notebook.codeActionsOnSave",outputWordWrap:"notebook.output.wordWrap",outputLineHeightDeprecated:"notebook.outputLineHeight",outputLineHeight:"notebook.output.lineHeight",outputFontSizeDeprecated:"notebook.outputFontSize",outputFontSize:"notebook.output.fontSize",outputFontFamilyDeprecated:"notebook.outputFontFamily",outputFontFamily:"notebook.output.fontFamily",findScope:"notebook.find.scope",logging:"notebook.logging",confirmDeleteRunningCell:"notebook.confirmDeleteRunningCell",remoteSaving:"notebook.experimental.remoteSave",gotoSymbolsAllSymbols:"notebook.gotoSymbols.showAllSymbols",scrollToRevealCell:"notebook.scrolling.revealNextCellOnExecute",anchorToFocusedCell:"notebook.scrolling.experimental.anchorToFocusedCell",cellChat:"notebook.experimental.cellChat"};var O;(function(b){b[b.Left=1]="Left",b[b.Right=2]="Right"})(O||(e.CellStatusbarAlignment=O={}));class h{static{this._prefix="notebook/"}static create(Q){return`${h._prefix}${Q}`}static parse(Q){if(Q.startsWith(h._prefix))return Q.substring(h._prefix.length)}}e.NotebookWorkingCopyTypeIdentifier=h;function C(b){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(b)}e.isTextStreamMime=C;const A=new TextDecoder;function V(b){const Q=[];let ae=!1;for(const H of b)(Q.length===0||ae)&&(Q.push(H),ae=!0);let D=z(Q);const q=$.VSBuffer.concat(Q.map(H=>$.VSBuffer.wrap(H))),M=ne(q);return D=D||M.byteLength!==q.byteLength,{data:M,didCompression:D}}e.compressOutputItemStreams=V,e.MOVE_CURSOR_1_LINE_COMMAND=`${String.fromCharCode(27)}[A`;const k=e.MOVE_CURSOR_1_LINE_COMMAND.split("").map(b=>b.charCodeAt(0)),_=10;function z(b){let Q=!1;return b.forEach((ae,D)=>{if(D===0||ae.length<e.MOVE_CURSOR_1_LINE_COMMAND.length)return;const q=b[D-1],M=ae.subarray(0,e.MOVE_CURSOR_1_LINE_COMMAND.length);if(M[0]===k[0]&&M[1]===k[1]&&M[2]===k[2]){const H=q.lastIndexOf(_);if(H===-1)return;Q=!0,b[D-1]=q.subarray(0,H),b[D]=ae.subarray(e.MOVE_CURSOR_1_LINE_COMMAND.length)}}),Q}function Z(b){let Q=b;do b=Q,Q=b.replace(/[^\n]\x08/gm,"");while(Q.length<b.length);return b}function ee(b){for(b=b.replace(/\r+\n/gm,`
`);b.search(/\r[^$]/g)>-1;){const Q=b.match(/^(.*)\r+/m)[1];let ae=b.match(/\r+(.*)$/m)[1];ae=ae+Q.slice(ae.length,Q.length),b=b.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,ae)}return b}const re="\b".charCodeAt(0),te="\r".charCodeAt(0);function ne(b){return!b.buffer.includes(re)&&!b.buffer.includes(te)?b:$.VSBuffer.fromString(ee(Z(A.decode(b.buffer))))}}),define(ue[43],ce([0,1,44,45,12,28,36,9,19]),function(le,e,$,U,j,N,F,K,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=e.NotebookEditorSimpleWorker=void 0;function m(c){let a=(0,U.numberHash)(104579,0);for(let l=0;l<c.buffer.length;l++)a=(0,U.doHash)(c.buffer[l],a);return a}class E{get textBuffer(){if(this._textBuffer)return this._textBuffer;const a=new N.PieceTreeTextBufferBuilder;a.acceptChunk(Array.isArray(this._source)?this._source.join(`
`):this._source);const l=a.finish(!0);return this._textBuffer=l.create(1).textBuffer,this._textBuffer}primaryKey(){return this._primaryKey===void 0&&(this._primaryKey=(0,U.hash)(this.getValue())),this._primaryKey}constructor(a,l,t,r,n,s,o){this.handle=a,this._source=l,this.language=t,this.cellKind=r,this.outputs=n,this.metadata=s,this.internalMetadata=o,this._primaryKey=null,this._hash=null}getFullModelRange(){const a=this.textBuffer.getLineCount();return new K.Range(1,1,a,this.textBuffer.getLineLength(a)+1)}getValue(){const a=this.getFullModelRange();return this.textBuffer.getValueInRange(a,1)}getComparisonValue(){return this._primaryKey!==null?this._primaryKey:(this._hash=(0,U.hash)([(0,U.hash)(this.language),(0,U.hash)(this.getValue()),this.metadata,this.internalMetadata,this.outputs.map(a=>({outputs:a.outputs.map(l=>({mime:l.mime,data:m(l.data)})),metadata:a.metadata}))]),this._hash)}getHashValue(){return this._hash!==null?this._hash:(this._hash=(0,U.hash)([(0,U.hash)(this.getValue()),this.language,this.metadata,this.internalMetadata]),this._hash)}}class W{constructor(a,l,t){this.uri=a,this.cells=l,this.metadata=t}acceptModelChanged(a){a.rawEvents.forEach(l=>{if(l.kind===F.NotebookCellsChangeType.ModelChange)this._spliceNotebookCells(l.changes);else if(l.kind===F.NotebookCellsChangeType.Move){const t=this.cells.splice(l.index,1);this.cells.splice(l.newIdx,0,...t)}else if(l.kind===F.NotebookCellsChangeType.Output){const t=this.cells[l.index];t.outputs=l.outputs}else if(l.kind===F.NotebookCellsChangeType.ChangeCellLanguage){this._assertIndex(l.index);const t=this.cells[l.index];t.language=l.language}else if(l.kind===F.NotebookCellsChangeType.ChangeCellMetadata){this._assertIndex(l.index);const t=this.cells[l.index];t.metadata=l.metadata}else if(l.kind===F.NotebookCellsChangeType.ChangeCellInternalMetadata){this._assertIndex(l.index);const t=this.cells[l.index];t.internalMetadata=l.internalMetadata}})}_assertIndex(a){if(a<0||a>=this.cells.length)throw new Error(`Illegal index ${a}. Cells length: ${this.cells.length}`)}_spliceNotebookCells(a){a.reverse().forEach(l=>{const r=l[2].map(n=>new E(n.handle,n.source,n.language,n.cellKind,n.outputs,n.metadata));this.cells.splice(l[0],l[1],...r)})}}class f{constructor(a){this.textModel=a}getElements(){const a=new Int32Array(this.textModel.cells.length);for(let l=0;l<this.textModel.cells.length;l++)a[l]=this.textModel.cells[l].getComparisonValue();return a}getCellHash(a){const l=Array.isArray(a.source)?a.source.join(`
`):a.source;return(0,U.hash)([(0,U.hash)(l),a.metadata])}}class L{constructor(){this._models=Object.create(null)}dispose(){}acceptNewModel(a,l){this._models[a]=new W(j.URI.parse(a),l.cells.map(t=>new E(t.handle,t.source,t.language,t.cellKind,t.outputs,t.metadata)),l.metadata)}acceptModelChanged(a,l){this._models[a]?.acceptModelChanged(l)}acceptRemovedModel(a){this._models[a]&&delete this._models[a]}computeDiff(a,l){const t=this._getModel(a),r=this._getModel(l);return{cellsDiff:new $.LcsDiff(new f(t),new f(r)).ComputeDiff(!1)}}canPromptRecommendation(a){const t=this._getModel(a).cells;for(let r=0;r<t.length;r++){const n=t[r];if(n.cellKind===F.CellKind.Markup||n.language!=="python")continue;const s=n.textBuffer.getLineCount(),o=Math.min(s,20),p=new K.Range(1,1,o,n.textBuffer.getLineLength(o)+1),P=new S.SearchParams("import\\s*pandas|from\\s*pandas",!0,!1,null).parseSearchRequest();if(!P)continue;if(n.textBuffer.findMatchesLineByLine(p,P,!0,1).length>0)return!0}return!1}_getModel(a){return this._models[a]}}e.NotebookEditorSimpleWorker=L;function g(c){return new L}e.create=g})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/08e6c15293922dd53a864bb041be381322fee401/core/vs\workbench\contrib\notebook\common\services\notebookSimpleWorker.js.map
