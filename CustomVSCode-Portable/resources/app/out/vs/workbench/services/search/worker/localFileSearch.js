/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var ce=["require","exports","vs/base/common/platform","vs/base/common/strings","vs/base/common/path","vs/base/common/extpath","vs/base/common/uri","vs/base/common/resources","vs/base/common/async","vs/base/common/glob","vs/base/common/symbols","vs/base/common/network","vs/base/common/errors","vs/base/common/cancellation","vs/workbench/services/search/common/getFileResults","vs/workbench/services/search/common/ignoreFile","vs/base/common/types","vs/base/common/event","vs/base/common/lifecycle","vs/base/common/lazy","vs/base/common/arrays","vs/base/common/map","vs/editor/common/core/range","vs/workbench/services/search/worker/localFileSearch"],he=function(re){for(var e=[],S=0,L=re.length;S<L;S++)e[S]=ce[re[S]];return e};define(ce[10],he([0,1]),function(re,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MicrotaskDelay=void 0,e.MicrotaskDelay=Symbol("MicrotaskDelay")}),define(ce[5],he([0,1,4,2,3,16]),function(re,e,S,L,D,T){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.randomPath=e.parseLineAndColumnAware=e.indexOfPath=e.getDriveLetter=e.hasDriveLetter=e.isRootOrDriveLetter=e.sanitizeFilePath=e.isWindowsDriveLetter=e.isEqualOrParent=e.isEqual=e.isValidBasename=e.isUNC=e.getRoot=e.toPosixPath=e.toSlashes=e.isPathSeparator=void 0;function g(s){return s===47||s===92}e.isPathSeparator=g;function O(s){return s.replace(/[\\/]/g,S.posix.sep)}e.toSlashes=O;function B(s){return s.indexOf("/")===-1&&(s=O(s)),/^[a-zA-Z]:(\/|$)/.test(s)&&(s="/"+s),s}e.toPosixPath=B;function H(s,h=S.posix.sep){if(!s)return"";const _=s.length,F=s.charCodeAt(0);if(g(F)){if(g(s.charCodeAt(1))&&!g(s.charCodeAt(2))){let W=3;const X=W;for(;W<_&&!g(s.charCodeAt(W));W++);if(X!==W&&!g(s.charCodeAt(W+1))){for(W+=1;W<_;W++)if(g(s.charCodeAt(W)))return s.slice(0,W+1).replace(/[\\/]/g,h)}}return h}else if(C(F)&&s.charCodeAt(1)===58)return g(s.charCodeAt(2))?s.slice(0,2)+h:s.slice(0,2);let Q=s.indexOf("://");if(Q!==-1){for(Q+=3;Q<_;Q++)if(g(s.charCodeAt(Q)))return s.slice(0,Q+1)}return""}e.getRoot=H;function p(s){if(!L.isWindows||!s||s.length<5)return!1;let h=s.charCodeAt(0);if(h!==92||(h=s.charCodeAt(1),h!==92))return!1;let _=2;const F=_;for(;_<s.length&&(h=s.charCodeAt(_),h!==92);_++);return!(F===_||(h=s.charCodeAt(_+1),isNaN(h)||h===92))}e.isUNC=p;const K=/[\\/:\*\?"<>\|]/g,w=/[\\/]/g,f=/^(con|prn|aux|clock\$|nul|lpt[0-9]|com[0-9])(\.(.*?))?$/i;function n(s,h=L.isWindows){const _=h?K:w;return!(!s||s.length===0||/^\s+$/.test(s)||(_.lastIndex=0,_.test(s))||h&&f.test(s)||s==="."||s===".."||h&&s[s.length-1]==="."||h&&s.length!==s.trim().length||s.length>255)}e.isValidBasename=n;function l(s,h,_){const F=s===h;return!_||F?F:!s||!h?!1:(0,D.equalsIgnoreCase)(s,h)}e.isEqual=l;function P(s,h,_,F=S.sep){if(s===h)return!0;if(!s||!h||h.length>s.length)return!1;if(_){if(!(0,D.startsWithIgnoreCase)(s,h))return!1;if(h.length===s.length)return!0;let W=h.length;return h.charAt(h.length-1)===F&&W--,s.charAt(W)===F}return h.charAt(h.length-1)!==F&&(h+=F),s.indexOf(h)===0}e.isEqualOrParent=P;function C(s){return s>=65&&s<=90||s>=97&&s<=122}e.isWindowsDriveLetter=C;function U(s,h){return L.isWindows&&s.endsWith(":")&&(s+=S.sep),(0,S.isAbsolute)(s)||(s=(0,S.join)(h,s)),s=(0,S.normalize)(s),L.isWindows?(s=(0,D.rtrim)(s,S.sep),s.endsWith(":")&&(s+=S.sep)):(s=(0,D.rtrim)(s,S.sep),s||(s=S.sep)),s}e.sanitizeFilePath=U;function v(s){const h=(0,S.normalize)(s);return L.isWindows?s.length>3?!1:z(h)&&(s.length===2||h.charCodeAt(2)===92):h===S.posix.sep}e.isRootOrDriveLetter=v;function z(s,h=L.isWindows){return h?C(s.charCodeAt(0))&&s.charCodeAt(1)===58:!1}e.hasDriveLetter=z;function te(s,h=L.isWindows){return z(s,h)?s[0]:void 0}e.getDriveLetter=te;function b(s,h,_){return h.length>s.length?-1:s===h?0:(_&&(s=s.toLowerCase(),h=h.toLowerCase()),s.indexOf(h))}e.indexOfPath=b;function M(s){const h=s.split(":");let _,F,Q;for(const W of h){const X=Number(W);(0,T.isNumber)(X)?F===void 0?F=X:Q===void 0&&(Q=X):_=_?[_,W].join(":"):W}if(!_)throw new Error("Format for `--goto` should be: `FILE:LINE(:COLUMN)`");return{path:_,line:F!==void 0?F:void 0,column:Q!==void 0?Q:F!==void 0?1:void 0}}e.parseLineAndColumnAware=M;const A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",V="BDEFGHIJKMOQRSTUVWXYZbdefghijkmoqrstuvwxyz0123456789";function Z(s,h,_=8){let F="";for(let W=0;W<_;W++){let X;W===0&&L.isWindows&&!h&&(_===3||_===4)?X=V:X=A,F+=X.charAt(Math.floor(Math.random()*X.length))}let Q;return h?Q=`${h}-${F}`:Q=F,s?(0,S.join)(s,Q):Q}e.randomPath=Z}),define(ce[11],he([0,1,12,2,3,6]),function(re,e,S,L,D,T){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COI=e.FileAccess=e.VSCODE_AUTHORITY=e.nodeModulesAsarUnpackedPath=e.nodeModulesAsarPath=e.nodeModulesPath=e.builtinExtensionsPath=e.RemoteAuthorities=e.connectionTokenQueryName=e.connectionTokenCookieName=e.matchesSomeScheme=e.matchesScheme=e.Schemas=void 0;var g;(function(w){w.inMemory="inmemory",w.vscode="vscode",w.internal="private",w.walkThrough="walkThrough",w.walkThroughSnippet="walkThroughSnippet",w.http="http",w.https="https",w.file="file",w.mailto="mailto",w.untitled="untitled",w.data="data",w.command="command",w.vscodeRemote="vscode-remote",w.vscodeRemoteResource="vscode-remote-resource",w.vscodeManagedRemoteResource="vscode-managed-remote-resource",w.vscodeUserData="vscode-userdata",w.vscodeCustomEditor="vscode-custom-editor",w.vscodeNotebookCell="vscode-notebook-cell",w.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",w.vscodeNotebookCellOutput="vscode-notebook-cell-output",w.vscodeInteractiveInput="vscode-interactive-input",w.vscodeSettings="vscode-settings",w.vscodeWorkspaceTrust="vscode-workspace-trust",w.vscodeTerminal="vscode-terminal",w.vscodeChatSesssion="vscode-chat-editor",w.webviewPanel="webview-panel",w.vscodeWebview="vscode-webview",w.extension="extension",w.vscodeFileResource="vscode-file",w.tmp="tmp",w.vsls="vsls",w.vscodeSourceControl="vscode-scm"})(g||(e.Schemas=g={}));function O(w,f){return T.URI.isUri(w)?(0,D.equalsIgnoreCase)(w.scheme,f):(0,D.startsWithIgnoreCase)(w,f+":")}e.matchesScheme=O;function B(w,...f){return f.some(n=>O(w,n))}e.matchesSomeScheme=B,e.connectionTokenCookieName="vscode-tkn",e.connectionTokenQueryName="tkn";class H{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._remoteResourcesPath=`/${g.vscodeRemoteResource}`}setPreferredWebSchema(f){this._preferredWebSchema=f}setDelegate(f){this._delegate=f}setServerRootPath(f){this._remoteResourcesPath=`${f}/${g.vscodeRemoteResource}`}set(f,n,l){this._hosts[f]=n,this._ports[f]=l}setConnectionToken(f,n){this._connectionTokens[f]=n}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(f){if(this._delegate)try{return this._delegate(f)}catch(v){return S.onUnexpectedError(v),f}const n=f.authority;let l=this._hosts[n];l&&l.indexOf(":")!==-1&&l.indexOf("[")===-1&&(l=`[${l}]`);const P=this._ports[n],C=this._connectionTokens[n];let U=`path=${encodeURIComponent(f.path)}`;return typeof C=="string"&&(U+=`&${e.connectionTokenQueryName}=${encodeURIComponent(C)}`),T.URI.from({scheme:L.isWeb?this._preferredWebSchema:g.vscodeRemoteResource,authority:`${l}:${P}`,path:this._remoteResourcesPath,query:U})}}e.RemoteAuthorities=new H,e.builtinExtensionsPath="vs/../../extensions",e.nodeModulesPath="vs/../../node_modules",e.nodeModulesAsarPath="vs/../../node_modules.asar",e.nodeModulesAsarUnpackedPath="vs/../../node_modules.asar.unpacked",e.VSCODE_AUTHORITY="vscode-app";class p{static{this.FALLBACK_AUTHORITY=e.VSCODE_AUTHORITY}asBrowserUri(f){const n=this.toUri(f,re);return this.uriToBrowserUri(n)}uriToBrowserUri(f){return f.scheme===g.vscodeRemote?e.RemoteAuthorities.rewrite(f):f.scheme===g.file&&(L.isNative||L.webWorkerOrigin===`${g.vscodeFileResource}://${p.FALLBACK_AUTHORITY}`)?f.with({scheme:g.vscodeFileResource,authority:f.authority||p.FALLBACK_AUTHORITY,query:null,fragment:null}):f}asFileUri(f){const n=this.toUri(f,re);return this.uriToFileUri(n)}uriToFileUri(f){return f.scheme===g.vscodeFileResource?f.with({scheme:g.file,authority:f.authority!==p.FALLBACK_AUTHORITY?f.authority:null,query:null,fragment:null}):f}toUri(f,n){return T.URI.isUri(f)?f:T.URI.parse(n.toUrl(f))}}e.FileAccess=new p;var K;(function(w){const f=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);w.CoopAndCoep=Object.freeze(f.get("3"));const n="vscode-coi";function l(C){let U;typeof C=="string"?U=new URL(C).searchParams:C instanceof URL?U=C.searchParams:T.URI.isUri(C)&&(U=new URL(C.toString(!0)).searchParams);const v=U?.get(n);if(v)return f.get(v)}w.getHeadersFromQuery=l;function P(C,U,v){if(!globalThis.crossOriginIsolated)return;const z=U&&v?"3":v?"2":"1";C instanceof URLSearchParams?C.set(n,z):C[n]=z}w.addSearchParam=P})(K||(e.COI=K={}))}),define(ce[7],he([0,1,5,11,4,2,3,6]),function(re,e,S,L,D,T,g,O){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toLocalResource=e.DataUri=e.distinctParents=e.addTrailingPathSeparator=e.removeTrailingPathSeparator=e.hasTrailingPathSeparator=e.isEqualAuthority=e.isAbsolutePath=e.resolvePath=e.relativePath=e.normalizePath=e.joinPath=e.dirname=e.extname=e.basename=e.basenameOrAuthority=e.getComparisonKey=e.isEqualOrParent=e.isEqual=e.extUriIgnorePathCase=e.extUriBiasedIgnorePathCase=e.extUri=e.ExtUri=e.originalFSPath=void 0;function B(f){return(0,O.uriToFsPath)(f,!0)}e.originalFSPath=B;class H{constructor(n){this._ignorePathCasing=n}compare(n,l,P=!1){return n===l?0:(0,g.compare)(this.getComparisonKey(n,P),this.getComparisonKey(l,P))}isEqual(n,l,P=!1){return n===l?!0:!n||!l?!1:this.getComparisonKey(n,P)===this.getComparisonKey(l,P)}getComparisonKey(n,l=!1){return n.with({path:this._ignorePathCasing(n)?n.path.toLowerCase():void 0,fragment:l?null:void 0}).toString()}ignorePathCasing(n){return this._ignorePathCasing(n)}isEqualOrParent(n,l,P=!1){if(n.scheme===l.scheme){if(n.scheme===L.Schemas.file)return S.isEqualOrParent(B(n),B(l),this._ignorePathCasing(n))&&n.query===l.query&&(P||n.fragment===l.fragment);if((0,e.isEqualAuthority)(n.authority,l.authority))return S.isEqualOrParent(n.path,l.path,this._ignorePathCasing(n),"/")&&n.query===l.query&&(P||n.fragment===l.fragment)}return!1}joinPath(n,...l){return O.URI.joinPath(n,...l)}basenameOrAuthority(n){return(0,e.basename)(n)||n.authority}basename(n){return D.posix.basename(n.path)}extname(n){return D.posix.extname(n.path)}dirname(n){if(n.path.length===0)return n;let l;return n.scheme===L.Schemas.file?l=O.URI.file(D.dirname(B(n))).path:(l=D.posix.dirname(n.path),n.authority&&l.length&&l.charCodeAt(0)!==47&&(console.error(`dirname("${n.toString})) resulted in a relative path`),l="/")),n.with({path:l})}normalizePath(n){if(!n.path.length)return n;let l;return n.scheme===L.Schemas.file?l=O.URI.file(D.normalize(B(n))).path:l=D.posix.normalize(n.path),n.with({path:l})}relativePath(n,l){if(n.scheme!==l.scheme||!(0,e.isEqualAuthority)(n.authority,l.authority))return;if(n.scheme===L.Schemas.file){const U=D.relative(B(n),B(l));return T.isWindows?S.toSlashes(U):U}let P=n.path||"/";const C=l.path||"/";if(this._ignorePathCasing(n)){let U=0;for(const v=Math.min(P.length,C.length);U<v&&!(P.charCodeAt(U)!==C.charCodeAt(U)&&P.charAt(U).toLowerCase()!==C.charAt(U).toLowerCase());U++);P=C.substr(0,U)+P.substr(U)}return D.posix.relative(P,C)}resolvePath(n,l){if(n.scheme===L.Schemas.file){const P=O.URI.file(D.resolve(B(n),l));return n.with({authority:P.authority,path:P.path})}return l=S.toPosixPath(l),n.with({path:D.posix.resolve(n.path,l)})}isAbsolutePath(n){return!!n.path&&n.path[0]==="/"}isEqualAuthority(n,l){return n===l||n!==void 0&&l!==void 0&&(0,g.equalsIgnoreCase)(n,l)}hasTrailingPathSeparator(n,l=D.sep){if(n.scheme===L.Schemas.file){const P=B(n);return P.length>S.getRoot(P).length&&P[P.length-1]===l}else{const P=n.path;return P.length>1&&P.charCodeAt(P.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(n.fsPath)}}removeTrailingPathSeparator(n,l=D.sep){return(0,e.hasTrailingPathSeparator)(n,l)?n.with({path:n.path.substr(0,n.path.length-1)}):n}addTrailingPathSeparator(n,l=D.sep){let P=!1;if(n.scheme===L.Schemas.file){const C=B(n);P=C!==void 0&&C.length===S.getRoot(C).length&&C[C.length-1]===l}else{l="/";const C=n.path;P=C.length===1&&C.charCodeAt(C.length-1)===47}return!P&&!(0,e.hasTrailingPathSeparator)(n,l)?n.with({path:n.path+"/"}):n}}e.ExtUri=H,e.extUri=new H(()=>!1),e.extUriBiasedIgnorePathCase=new H(f=>f.scheme===L.Schemas.file?!T.isLinux:!0),e.extUriIgnorePathCase=new H(f=>!0),e.isEqual=e.extUri.isEqual.bind(e.extUri),e.isEqualOrParent=e.extUri.isEqualOrParent.bind(e.extUri),e.getComparisonKey=e.extUri.getComparisonKey.bind(e.extUri),e.basenameOrAuthority=e.extUri.basenameOrAuthority.bind(e.extUri),e.basename=e.extUri.basename.bind(e.extUri),e.extname=e.extUri.extname.bind(e.extUri),e.dirname=e.extUri.dirname.bind(e.extUri),e.joinPath=e.extUri.joinPath.bind(e.extUri),e.normalizePath=e.extUri.normalizePath.bind(e.extUri),e.relativePath=e.extUri.relativePath.bind(e.extUri),e.resolvePath=e.extUri.resolvePath.bind(e.extUri),e.isAbsolutePath=e.extUri.isAbsolutePath.bind(e.extUri),e.isEqualAuthority=e.extUri.isEqualAuthority.bind(e.extUri),e.hasTrailingPathSeparator=e.extUri.hasTrailingPathSeparator.bind(e.extUri),e.removeTrailingPathSeparator=e.extUri.removeTrailingPathSeparator.bind(e.extUri),e.addTrailingPathSeparator=e.extUri.addTrailingPathSeparator.bind(e.extUri);function p(f,n){const l=[];for(let P=0;P<f.length;P++){const C=n(f[P]);f.some((U,v)=>v===P?!1:(0,e.isEqualOrParent)(C,n(U)))||l.push(f[P])}return l}e.distinctParents=p;var K;(function(f){f.META_DATA_LABEL="label",f.META_DATA_DESCRIPTION="description",f.META_DATA_SIZE="size",f.META_DATA_MIME="mime";function n(l){const P=new Map;l.path.substring(l.path.indexOf(";")+1,l.path.lastIndexOf(";")).split(";").forEach(v=>{const[z,te]=v.split(":");z&&te&&P.set(z,te)});const U=l.path.substring(0,l.path.indexOf(";"));return U&&P.set(f.META_DATA_MIME,U),P}f.parseMetaData=n})(K||(e.DataUri=K={}));function w(f,n,l){if(n){let P=f.path;return P&&P[0]!==D.posix.sep&&(P=D.posix.sep+P),f.with({scheme:l,authority:n,path:P})}return f.with({scheme:l})}e.toLocalResource=w}),define(ce[8],he([0,1,13,12,17,18,7,2,10,19]),function(re,e,S,L,D,T,g,O,B,H){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncIterableSource=e.createCancelableAsyncIterable=e.CancelableAsyncIterableObject=e.AsyncIterableObject=e.LazyStatefulPromise=e.StatefulPromise=e.Promises=e.DeferredPromise=e.IntervalCounter=e.TaskSequentializer=e.retry=e.GlobalIdleValue=e.AbstractIdleValue=e._runWhenIdle=e.runWhenGlobalIdle=e.ThrottledWorker=e.RunOnceWorker=e.ProcessTimeRunOnceScheduler=e.RunOnceScheduler=e.IntervalTimer=e.TimeoutTimer=e.ResourceQueue=e.LimitedQueue=e.Queue=e.Limiter=e.firstParallel=e.first=e.sequence=e.disposableTimeout=e.timeout=e.AutoOpenBarrier=e.Barrier=e.ThrottledDelayer=e.Delayer=e.SequencerByKey=e.Sequencer=e.Throttler=e.asPromise=e.raceTimeout=e.raceCancellablePromises=e.raceCancellationError=e.raceCancellation=e.createCancelablePromise=e.isThenable=void 0;function p(o){return!!o&&typeof o.then=="function"}e.isThenable=p;function K(o){const t=new S.CancellationTokenSource,i=o(t.token),r=new Promise((c,q)=>{const J=t.token.onCancellationRequested(()=>{J.dispose(),t.dispose(),q(new L.CancellationError)});Promise.resolve(i).then(ae=>{J.dispose(),t.dispose(),c(ae)},ae=>{J.dispose(),t.dispose(),q(ae)})});return new class{cancel(){t.cancel()}then(c,q){return r.then(c,q)}catch(c){return this.then(void 0,c)}finally(c){return r.finally(c)}}}e.createCancelablePromise=K;function w(o,t,i){return new Promise((r,c)=>{const q=t.onCancellationRequested(()=>{q.dispose(),r(i)});o.then(r,c).finally(()=>q.dispose())})}e.raceCancellation=w;function f(o,t){return new Promise((i,r)=>{const c=t.onCancellationRequested(()=>{c.dispose(),r(new L.CancellationError)});o.then(i,r).finally(()=>c.dispose())})}e.raceCancellationError=f;async function n(o){let t=-1;const i=o.map((r,c)=>r.then(q=>(t=c,q)));try{return await Promise.race(i)}finally{o.forEach((r,c)=>{c!==t&&r.cancel()})}}e.raceCancellablePromises=n;function l(o,t,i){let r;const c=setTimeout(()=>{r?.(void 0),i?.()},t);return Promise.race([o.finally(()=>clearTimeout(c)),new Promise(q=>r=q)])}e.raceTimeout=l;function P(o){return new Promise((t,i)=>{const r=o();p(r)?r.then(t,i):t(r)})}e.asPromise=P;class C{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(t){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=t,!this.queuedPromise){const i=()=>{if(this.queuedPromise=null,this.isDisposed)return;const r=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,r};this.queuedPromise=new Promise(r=>{this.activePromise.then(i,i).then(r)})}return new Promise((i,r)=>{this.queuedPromise.then(i,r)})}return this.activePromise=t(),new Promise((i,r)=>{this.activePromise.then(c=>{this.activePromise=null,i(c)},c=>{this.activePromise=null,r(c)})})}dispose(){this.isDisposed=!0}}e.Throttler=C;class U{constructor(){this.current=Promise.resolve(null)}queue(t){return this.current=this.current.then(()=>t(),()=>t())}}e.Sequencer=U;class v{constructor(){this.promiseMap=new Map}queue(t,i){const c=(this.promiseMap.get(t)??Promise.resolve()).catch(()=>{}).then(i).finally(()=>{this.promiseMap.get(t)===c&&this.promiseMap.delete(t)});return this.promiseMap.set(t,c),c}}e.SequencerByKey=v;const z=(o,t)=>{let i=!0;const r=setTimeout(()=>{i=!1,t()},o);return{isTriggered:()=>i,dispose:()=>{clearTimeout(r),i=!1}}},te=o=>{let t=!0;return queueMicrotask(()=>{t&&(t=!1,o())}),{isTriggered:()=>t,dispose:()=>{t=!1}}};class b{constructor(t){this.defaultDelay=t,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(t,i=this.defaultDelay){this.task=t,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((c,q)=>{this.doResolve=c,this.doReject=q}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const c=this.task;return this.task=null,c()}}));const r=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=i===B.MicrotaskDelay?te(r):z(i,r),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new L.CancellationError),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}e.Delayer=b;class M{constructor(t){this.delayer=new b(t),this.throttler=new C}trigger(t,i){return this.delayer.trigger(()=>this.throttler.queue(t),i)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}e.ThrottledDelayer=M;class A{constructor(){this._isOpen=!1,this._promise=new Promise((t,i)=>{this._completePromise=t})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}e.Barrier=A;class V extends A{constructor(t){super(),this._timeout=setTimeout(()=>this.open(),t)}open(){clearTimeout(this._timeout),super.open()}}e.AutoOpenBarrier=V;function Z(o,t){return t?new Promise((i,r)=>{const c=setTimeout(()=>{q.dispose(),i()},o),q=t.onCancellationRequested(()=>{clearTimeout(c),q.dispose(),r(new L.CancellationError)})}):K(i=>Z(o,i))}e.timeout=Z;function s(o,t=0,i){const r=setTimeout(()=>{o(),i&&c.dispose()},t),c=(0,T.toDisposable)(()=>{clearTimeout(r),i?.deleteAndLeak(c)});return i?.add(c),c}e.disposableTimeout=s;function h(o){const t=[];let i=0;const r=o.length;function c(){return i<r?o[i++]():null}function q(J){J!=null&&t.push(J);const ae=c();return ae?ae.then(q):Promise.resolve(t)}return Promise.resolve(null).then(q)}e.sequence=h;function _(o,t=r=>!!r,i=null){let r=0;const c=o.length,q=()=>{if(r>=c)return Promise.resolve(i);const J=o[r++];return Promise.resolve(J()).then(fe=>t(fe)?Promise.resolve(fe):q())};return q()}e.first=_;function F(o,t=r=>!!r,i=null){if(o.length===0)return Promise.resolve(i);let r=o.length;const c=()=>{r=-1;for(const q of o)q.cancel?.()};return new Promise((q,J)=>{for(const ae of o)ae.then(fe=>{--r>=0&&t(fe)?(c(),q(fe)):r===0&&q(i)}).catch(fe=>{--r>=0&&(c(),J(fe))})})}e.firstParallel=F;class Q{constructor(t){this._size=0,this.maxDegreeOfParalellism=t,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new D.Emitter}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(t){return this._size++,new Promise((i,r)=>{this.outstandingPromises.push({factory:t,c:i,e:r}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){const t=this.outstandingPromises.shift();this.runningPromises++;const i=t.factory();i.then(t.c,t.e),i.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._size--,this.runningPromises--,this.outstandingPromises.length>0?this.consume():this._onDrained.fire()}dispose(){this._onDrained.dispose()}}e.Limiter=Q;class W extends Q{constructor(){super(1)}}e.Queue=W;class X{constructor(){this.sequentializer=new a,this.tasks=0}queue(t){return this.sequentializer.isRunning()?this.sequentializer.queue(()=>this.sequentializer.run(this.tasks++,t())):this.sequentializer.run(this.tasks++,t())}}e.LimitedQueue=X;class le{constructor(){this.queues=new Map,this.drainers=new Set,this.drainListeners=void 0,this.drainListenerCount=0}async whenDrained(){if(this.isDrained())return;const t=new k;return this.drainers.add(t),t.p}isDrained(){for(const[,t]of this.queues)if(t.size>0)return!1;return!0}queueFor(t,i=g.extUri){const r=i.getComparisonKey(t);let c=this.queues.get(r);if(!c){c=new W;const q=this.drainListenerCount++,J=D.Event.once(c.onDrained)(()=>{c?.dispose(),this.queues.delete(r),this.onDidQueueDrain(),this.drainListeners?.deleteAndDispose(q),this.drainListeners?.size===0&&(this.drainListeners.dispose(),this.drainListeners=void 0)});this.drainListeners||(this.drainListeners=new T.DisposableMap),this.drainListeners.set(q,J),this.queues.set(r,c)}return c}onDidQueueDrain(){this.isDrained()&&this.releaseDrainers()}releaseDrainers(){for(const t of this.drainers)t.complete();this.drainers.clear()}dispose(){for(const[,t]of this.queues)t.dispose();this.queues.clear(),this.releaseDrainers(),this.drainListeners?.dispose()}}e.ResourceQueue=le;class oe{constructor(t,i){this._token=-1,typeof t=="function"&&typeof i=="number"&&this.setIfNotSet(t,i)}dispose(){this.cancel()}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(t,i){this.cancel(),this._token=setTimeout(()=>{this._token=-1,t()},i)}setIfNotSet(t,i){this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,t()},i))}}e.TimeoutTimer=oe;class ne{constructor(){this.disposable=void 0}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(t,i,r=globalThis){this.cancel();const c=r.setInterval(()=>{t()},i);this.disposable=(0,T.toDisposable)(()=>{r.clearInterval(c),this.disposable=void 0})}dispose(){this.cancel()}}e.IntervalTimer=ne;class ue{constructor(t,i){this.timeoutToken=-1,this.runner=t,this.timeout=i,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(t=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,t)}get delay(){return this.timeout}set delay(t){this.timeout=t}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}e.RunOnceScheduler=ue;class N{constructor(t,i){i%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${i}ms is not a multiple of 1000ms.`),this.runner=t,this.timeout=i,this.counter=0,this.intervalToken=-1,this.intervalHandler=this.onInterval.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearInterval(this.intervalToken),this.intervalToken=-1)}schedule(t=this.timeout){t%1e3!==0&&console.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${t}ms is not a multiple of 1000ms.`),this.cancel(),this.counter=Math.ceil(t/1e3),this.intervalToken=setInterval(this.intervalHandler,1e3)}isScheduled(){return this.intervalToken!==-1}onInterval(){this.counter--,!(this.counter>0)&&(clearInterval(this.intervalToken),this.intervalToken=-1,this.runner?.())}}e.ProcessTimeRunOnceScheduler=N;class x extends ue{constructor(t,i){super(t,i),this.units=[]}work(t){this.units.push(t),this.isScheduled()||this.schedule()}doRun(){const t=this.units;this.units=[],this.runner?.(t)}dispose(){this.units=[],super.dispose()}}e.RunOnceWorker=x;class Y extends T.Disposable{constructor(t,i){super(),this.options=t,this.handler=i,this.pendingWork=[],this.throttler=this._register(new T.MutableDisposable),this.disposed=!1}get pending(){return this.pendingWork.length}work(t){if(this.disposed)return!1;if(typeof this.options.maxBufferedWork=="number"){if(this.throttler.value){if(this.pending+t.length>this.options.maxBufferedWork)return!1}else if(this.pending+t.length-this.options.maxWorkChunkSize>this.options.maxBufferedWork)return!1}for(const i of t)this.pendingWork.push(i);return this.throttler.value||this.doWork(),!0}doWork(){this.handler(this.pendingWork.splice(0,this.options.maxWorkChunkSize)),this.pendingWork.length>0&&(this.throttler.value=new ue(()=>{this.throttler.clear(),this.doWork()},this.options.throttleDelay),this.throttler.value.schedule())}dispose(){super.dispose(),this.disposed=!0}}e.ThrottledWorker=Y,function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?e._runWhenIdle=(o,t)=>{(0,O.setTimeout0)(()=>{if(i)return;const r=Date.now()+15;t(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,r-Date.now())}}))});let i=!1;return{dispose(){i||(i=!0)}}}:e._runWhenIdle=(o,t,i)=>{const r=o.requestIdleCallback(t,typeof i=="number"?{timeout:i}:void 0);let c=!1;return{dispose(){c||(c=!0,o.cancelIdleCallback(r))}}},e.runWhenGlobalIdle=o=>(0,e._runWhenIdle)(globalThis,o)}();class ie{constructor(t,i){this._didRun=!1,this._executor=()=>{try{this._value=i()}catch(r){this._error=r}finally{this._didRun=!0}},this._handle=(0,e._runWhenIdle)(t,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}e.AbstractIdleValue=ie;class u extends ie{constructor(t){super(globalThis,t)}}e.GlobalIdleValue=u;async function d(o,t,i){let r;for(let c=0;c<i;c++)try{return await o()}catch(q){r=q,await Z(t)}throw r}e.retry=d;class a{isRunning(t){return typeof t=="number"?this._running?.taskId===t:!!this._running}get running(){return this._running?.promise}cancelRunning(){this._running?.cancel()}run(t,i,r){return this._running={taskId:t,cancel:()=>r?.(),promise:i},i.then(()=>this.doneRunning(t),()=>this.doneRunning(t)),i}doneRunning(t){this._running&&t===this._running.taskId&&(this._running=void 0,this.runQueued())}runQueued(){if(this._queued){const t=this._queued;this._queued=void 0,t.run().then(t.promiseResolve,t.promiseReject)}}queue(t){if(this._queued)this._queued.run=t;else{let i,r;const c=new Promise((q,J)=>{i=q,r=J});this._queued={run:t,promise:c,promiseResolve:i,promiseReject:r}}return this._queued.promise}hasQueued(){return!!this._queued}async join(){return this._queued?.promise??this._running?.promise}}e.TaskSequentializer=a;class R{constructor(t,i=()=>Date.now()){this.interval=t,this.nowFn=i,this.lastIncrementTime=0,this.value=0}increment(){const t=this.nowFn();return t-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=t,this.value=0),this.value++,this.value}}e.IntervalCounter=R;var y;(function(o){o[o.Resolved=0]="Resolved",o[o.Rejected=1]="Rejected"})(y||(y={}));class k{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((t,i)=>{this.completeCallback=t,this.errorCallback=i})}complete(t){return new Promise(i=>{this.completeCallback(t),this.outcome={outcome:0,value:t},i()})}error(t){return new Promise(i=>{this.errorCallback(t),this.outcome={outcome:1,value:t},i()})}cancel(){return this.error(new L.CancellationError)}}e.DeferredPromise=k;var j;(function(o){async function t(r){let c;const q=await Promise.all(r.map(J=>J.then(ae=>ae,ae=>{c||(c=ae)})));if(typeof c<"u")throw c;return q}o.settled=t;function i(r){return new Promise(async(c,q)=>{try{await r(c,q)}catch(J){q(J)}})}o.withAsyncBody=i})(j||(e.Promises=j={}));class m{get value(){return this._value}get error(){return this._error}get isResolved(){return this._isResolved}constructor(t){this._value=void 0,this._error=void 0,this._isResolved=!1,this.promise=t.then(i=>(this._value=i,this._isResolved=!0,i),i=>{throw this._error=i,this._isResolved=!0,i})}requireValue(){if(!this._isResolved)throw new L.BugIndicatingError("Promise is not resolved yet");if(this._error)throw this._error;return this._value}}e.StatefulPromise=m;class E{constructor(t){this._compute=t,this._promise=new H.Lazy(()=>new m(this._compute()))}requireValue(){return this._promise.value.requireValue()}getPromise(){return this._promise.value.promise}}e.LazyStatefulPromise=E;var $;(function(o){o[o.Initial=0]="Initial",o[o.DoneOK=1]="DoneOK",o[o.DoneError=2]="DoneError"})($||($={}));class I{static fromArray(t){return new I(i=>{i.emitMany(t)})}static fromPromise(t){return new I(async i=>{i.emitMany(await t)})}static fromPromises(t){return new I(async i=>{await Promise.all(t.map(async r=>i.emitOne(await r)))})}static merge(t){return new I(async i=>{await Promise.all(t.map(async r=>{for await(const c of r)i.emitOne(c)}))})}static{this.EMPTY=I.fromArray([])}constructor(t){this._state=0,this._results=[],this._error=null,this._onStateChanged=new D.Emitter,queueMicrotask(async()=>{const i={emitOne:r=>this.emitOne(r),emitMany:r=>this.emitMany(r),reject:r=>this.reject(r)};try{await Promise.resolve(t(i)),this.resolve()}catch(r){this.reject(r)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await D.Event.toPromise(this._onStateChanged.event)}while(!0)}}}static map(t,i){return new I(async r=>{for await(const c of t)r.emitOne(i(c))})}map(t){return I.map(this,t)}static filter(t,i){return new I(async r=>{for await(const c of t)i(c)&&r.emitOne(c)})}filter(t){return I.filter(this,t)}static coalesce(t){return I.filter(t,i=>!!i)}coalesce(){return I.coalesce(this)}static async toPromise(t){const i=[];for await(const r of t)i.push(r);return i}toPromise(){return I.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}}e.AsyncIterableObject=I;class G extends I{constructor(t,i){super(i),this._source=t}cancel(){this._source.cancel()}}e.CancelableAsyncIterableObject=G;function ee(o){const t=new S.CancellationTokenSource,i=o(t.token);return new G(t,async r=>{const c=t.token.onCancellationRequested(()=>{c.dispose(),t.dispose(),r.reject(new L.CancellationError)});try{for await(const q of i){if(t.token.isCancellationRequested)return;r.emitOne(q)}c.dispose(),t.dispose()}catch(q){c.dispose(),t.dispose(),r.reject(q)}})}e.createCancelableAsyncIterable=ee;class se{constructor(){this._deferred=new k,this._asyncIterable=new I(r=>{if(t){r.reject(t);return}return i&&r.emitMany(i),this._errorFn=c=>r.reject(c),this._emitFn=c=>r.emitOne(c),this._deferred.p});let t,i;this._emitFn=r=>{i||(i=[]),i.push(r)},this._errorFn=r=>{t||(t=r)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(t){this._errorFn(t),this._deferred.complete()}emitOne(t){this._emitFn(t)}}e.AsyncIterableSource=se}),define(ce[9],he([0,1,20,8,5,21,4,2,3]),function(re,e,S,L,D,T,g,O,B){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.patternsEquals=e.getPathTerms=e.getBasenameTerms=e.isRelativePattern=e.parse=e.match=e.splitGlobAware=e.GLOB_SPLIT=e.GLOBSTAR=e.getEmptyExpression=void 0;function H(){return Object.create(null)}e.getEmptyExpression=H,e.GLOBSTAR="**",e.GLOB_SPLIT="/";const p="[/\\\\]",K="[^/\\\\]",w=/\//g;function f(u,d){switch(u){case 0:return"";case 1:return`${K}*?`;default:return`(?:${p}|${K}+${p}${d?`|${p}${K}+`:""})*?`}}function n(u,d){if(!u)return[];const a=[];let R=!1,y=!1,k="";for(const j of u){switch(j){case d:if(!R&&!y){a.push(k),k="";continue}break;case"{":R=!0;break;case"}":R=!1;break;case"[":y=!0;break;case"]":y=!1;break}k+=j}return k&&a.push(k),a}e.splitGlobAware=n;function l(u){if(!u)return"";let d="";const a=n(u,e.GLOB_SPLIT);if(a.every(R=>R===e.GLOBSTAR))d=".*";else{let R=!1;a.forEach((y,k)=>{if(y===e.GLOBSTAR){if(R)return;d+=f(2,k===a.length-1)}else{let j=!1,m="",E=!1,$="";for(const I of y){if(I!=="}"&&j){m+=I;continue}if(E&&(I!=="]"||!$)){let G;I==="-"?G=I:(I==="^"||I==="!")&&!$?G="^":I===e.GLOB_SPLIT?G="":G=(0,B.escapeRegExpCharacters)(I),$+=G;continue}switch(I){case"{":j=!0;continue;case"[":E=!0;continue;case"}":{const ee=`(?:${n(m,",").map(se=>l(se)).join("|")})`;d+=ee,j=!1,m="";break}case"]":{d+="["+$+"]",E=!1,$="";break}case"?":d+=K;continue;case"*":d+=f(1);continue;default:d+=(0,B.escapeRegExpCharacters)(I)}}k<a.length-1&&(a[k+1]!==e.GLOBSTAR||k+2<a.length)&&(d+=p)}R=y===e.GLOBSTAR})}return d}const P=/^\*\*\/\*\.[\w\.-]+$/,C=/^\*\*\/([\w\.-]+)\/?$/,U=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,v=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,z=/^\*\*((\/[\w\.-]+)+)\/?$/,te=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,b=new T.LRUCache(1e4),M=function(){return!1},A=function(){return null};function V(u,d){if(!u)return A;let a;typeof u!="string"?a=u.pattern:a=u,a=a.trim();const R=`${a}_${!!d.trimForExclusions}`;let y=b.get(R);if(y)return Z(y,u);let k;return P.test(a)?y=h(a.substr(4),a):(k=C.exec(s(a,d)))?y=_(k[1],a):(d.trimForExclusions?v:U).test(a)?y=F(a,d):(k=z.exec(s(a,d)))?y=Q(k[1].substr(1),a,!0):(k=te.exec(s(a,d)))?y=Q(k[1],a,!1):y=W(a),b.set(R,y),Z(y,u)}function Z(u,d){if(typeof d=="string")return u;const a=function(R,y){return(0,D.isEqualOrParent)(R,d.base,!O.isLinux)?u((0,B.ltrim)(R.substr(d.base.length),g.sep),y):null};return a.allBasenames=u.allBasenames,a.allPaths=u.allPaths,a.basenames=u.basenames,a.patterns=u.patterns,a}function s(u,d){return d.trimForExclusions&&u.endsWith("/**")?u.substr(0,u.length-2):u}function h(u,d){return function(a,R){return typeof a=="string"&&a.endsWith(u)?d:null}}function _(u,d){const a=`/${u}`,R=`\\${u}`,y=function(j,m){return typeof j!="string"?null:m?m===u?d:null:j===u||j.endsWith(a)||j.endsWith(R)?d:null},k=[u];return y.basenames=k,y.patterns=[d],y.allBasenames=k,y}function F(u,d){const a=Y(u.slice(1,-1).split(",").map(m=>V(m,d)).filter(m=>m!==A),u),R=a.length;if(!R)return A;if(R===1)return a[0];const y=function(m,E){for(let $=0,I=a.length;$<I;$++)if(a[$](m,E))return u;return null},k=a.find(m=>!!m.allBasenames);k&&(y.allBasenames=k.allBasenames);const j=a.reduce((m,E)=>E.allPaths?m.concat(E.allPaths):m,[]);return j.length&&(y.allPaths=j),y}function Q(u,d,a){const R=g.sep===g.posix.sep,y=R?u:u.replace(w,g.sep),k=g.sep+y,j=g.posix.sep+u;let m;return a?m=function(E,$){return typeof E=="string"&&(E===y||E.endsWith(k)||!R&&(E===u||E.endsWith(j)))?d:null}:m=function(E,$){return typeof E=="string"&&(E===y||!R&&E===u)?d:null},m.allPaths=[(a?"*/":"./")+u],m}function W(u){try{const d=new RegExp(`^${l(u)}$`);return function(a){return d.lastIndex=0,typeof a=="string"&&d.test(a)?u:null}}catch{return A}}function X(u,d,a){return!u||typeof d!="string"?!1:le(u)(d,void 0,a)}e.match=X;function le(u,d={}){if(!u)return M;if(typeof u=="string"||oe(u)){const a=V(u,d);if(a===A)return M;const R=function(y,k){return!!a(y,k)};return a.allBasenames&&(R.allBasenames=a.allBasenames),a.allPaths&&(R.allPaths=a.allPaths),R}return N(u,d)}e.parse=le;function oe(u){const d=u;return d?typeof d.base=="string"&&typeof d.pattern=="string":!1}e.isRelativePattern=oe;function ne(u){return u.allBasenames||[]}e.getBasenameTerms=ne;function ue(u){return u.allPaths||[]}e.getPathTerms=ue;function N(u,d){const a=Y(Object.getOwnPropertyNames(u).map(m=>x(m,u[m],d)).filter(m=>m!==A)),R=a.length;if(!R)return A;if(!a.some(m=>!!m.requiresSiblings)){if(R===1)return a[0];const m=function(I,G){let ee;for(let se=0,o=a.length;se<o;se++){const t=a[se](I,G);if(typeof t=="string")return t;(0,L.isThenable)(t)&&(ee||(ee=[]),ee.push(t))}return ee?(async()=>{for(const se of ee){const o=await se;if(typeof o=="string")return o}return null})():null},E=a.find(I=>!!I.allBasenames);E&&(m.allBasenames=E.allBasenames);const $=a.reduce((I,G)=>G.allPaths?I.concat(G.allPaths):I,[]);return $.length&&(m.allPaths=$),m}const y=function(m,E,$){let I,G;for(let ee=0,se=a.length;ee<se;ee++){const o=a[ee];o.requiresSiblings&&$&&(E||(E=(0,g.basename)(m)),I||(I=E.substr(0,E.length-(0,g.extname)(m).length)));const t=o(m,E,I,$);if(typeof t=="string")return t;(0,L.isThenable)(t)&&(G||(G=[]),G.push(t))}return G?(async()=>{for(const ee of G){const se=await ee;if(typeof se=="string")return se}return null})():null},k=a.find(m=>!!m.allBasenames);k&&(y.allBasenames=k.allBasenames);const j=a.reduce((m,E)=>E.allPaths?m.concat(E.allPaths):m,[]);return j.length&&(y.allPaths=j),y}function x(u,d,a){if(d===!1)return A;const R=V(u,a);if(R===A)return A;if(typeof d=="boolean")return R;if(d){const y=d.when;if(typeof y=="string"){const k=(j,m,E,$)=>{if(!$||!R(j,m))return null;const I=y.replace("$(basename)",()=>E),G=$(I);return(0,L.isThenable)(G)?G.then(ee=>ee?u:null):G?u:null};return k.requiresSiblings=!0,k}}return R}function Y(u,d){const a=u.filter(m=>!!m.basenames);if(a.length<2)return u;const R=a.reduce((m,E)=>{const $=E.basenames;return $?m.concat($):m},[]);let y;if(d){y=[];for(let m=0,E=R.length;m<E;m++)y.push(d)}else y=a.reduce((m,E)=>{const $=E.patterns;return $?m.concat($):m},[]);const k=function(m,E){if(typeof m!="string")return null;if(!E){let I;for(I=m.length;I>0;I--){const G=m.charCodeAt(I-1);if(G===47||G===92)break}E=m.substr(I)}const $=R.indexOf(E);return $!==-1?y[$]:null};k.basenames=R,k.patterns=y,k.allBasenames=R;const j=u.filter(m=>!m.basenames);return j.push(k),j}function ie(u,d){return(0,S.equals)(u,d,(a,R)=>typeof a=="string"&&typeof R=="string"?a===R:typeof a!="string"&&typeof R!="string"?a.base===R.base&&a.pattern===R.pattern:!1)}e.patternsEquals=ie}),define(ce[14],he([0,1,22]),function(re,e,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getFileResults=void 0;const L=(D,T,g)=>{let O;if(D[0]===255&&D[1]===254)O=new TextDecoder("utf-16le").decode(D);else if(D[0]===254&&D[1]===255)O=new TextDecoder("utf-16be").decode(D);else if(O=new TextDecoder("utf8").decode(D),O.slice(0,1e3).includes("\uFFFD")&&D.includes(0))return[];const B=[],H=[];let p=null,K=g.remainingResultQuota;for(;K>=0&&(p=T.exec(O));)H.push({matchStartIndex:p.index,matchedText:p[0]}),K--;if(H.length){const w=new Set,f=new Set,n=[],l=z=>O.slice(n[z].start,n[z].end);let P=0,C=null;const U=/\r?\n/g;for(;C=U.exec(O);)n.push({start:P,end:C.index}),P=C.index+C[0].length;P<O.length&&n.push({start:P,end:O.length});let v=0;for(const{matchStartIndex:z,matchedText:te}of H){if(K<0)break;for(;n[v+1]&&z>n[v].end;)v++;let b=v;for(;n[b+1]&&z+te.length>n[b].end;)b++;if(g.beforeContext)for(let h=Math.max(0,v-g.beforeContext);h<v;h++)w.add(h);let M="",A=0;for(let h=v;h<=b;h++){let _=l(h);g.previewOptions?.charsPerLine&&_.length>g.previewOptions.charsPerLine&&(A=Math.max(z-n[v].start-20,0),_=_.substr(A,g.previewOptions.charsPerLine)),M+=`${_}
`,f.add(h)}const V=new S.Range(v,z-n[v].start,b,z+te.length-n[b].start),Z=new S.Range(0,z-n[v].start-A,b-v,z+te.length-n[b].start-(b===v?A:0)),s={ranges:V,preview:{text:M,matches:Z}};if(B.push(s),g.afterContext)for(let h=b+1;h<=Math.min(b+g.afterContext,n.length-1);h++)w.add(h)}for(const z of w)f.has(z)||B.push({text:l(z),lineNumber:z+1})}return B};e.getFileResults=L}),define(ce[15],he([0,1,9]),function(re,e,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IgnoreFile=void 0;class L{constructor(T,g,O){if(this.location=g,this.parent=O,g[g.length-1]==="\\")throw Error("Unexpected path format, do not use trailing backslashes");g[g.length-1]!=="/"&&(g+="/"),this.isPathIgnored=this.parseIgnoreFile(T,this.location,this.parent)}updateContents(T){this.isPathIgnored=this.parseIgnoreFile(T,this.location,this.parent)}isPathIncludedInTraversal(T,g){if(T[0]!=="/"||T[T.length-1]==="/")throw Error("Unexpected path format, expectred to begin with slash and end without. got:"+T);return!this.isPathIgnored(T,g)}isArbitraryPathIgnored(T,g){if(T[0]!=="/"||T[T.length-1]==="/")throw Error("Unexpected path format, expectred to begin with slash and end without. got:"+T);const O=T.split("/").filter(p=>p);let B=!1,H="";for(let p=0;p<O.length;p++){const K=p===O.length-1,w=O[p];if(H=H+"/"+w,!this.isPathIncludedInTraversal(H,K?g:!0)){B=!0;break}}return B}gitignoreLinesToExpression(T,g,O){const B=T.map(p=>this.gitignoreLineToGlob(p,g)),H=Object.create(null);for(const p of B)H[p]=!0;return S.parse(H,{trimForExclusions:O})}parseIgnoreFile(T,g,O){const B=T.split(`
`).map(v=>v.trim()).filter(v=>v&&v[0]!=="#"),H=B.filter(v=>!v.endsWith("/")),p=H.filter(v=>!v.includes("!")),K=this.gitignoreLinesToExpression(p,g,!0),w=H.filter(v=>v.includes("!")).map(v=>v.replace(/!/g,"")),f=this.gitignoreLinesToExpression(w,g,!1),n=B.filter(v=>!v.includes("!")),l=this.gitignoreLinesToExpression(n,g,!0),P=B.filter(v=>v.includes("!")).map(v=>v.replace(/!/g,"")),C=this.gitignoreLinesToExpression(P,g,!1);return(v,z)=>v.startsWith(g)?z&&l(v)&&!C(v)||K(v)&&!f(v)?!0:O?O.isPathIgnored(v,z):!1:!1}gitignoreLineToGlob(T,g){const O=T.indexOf("/");return O===-1||O===T.length-1?T="**/"+T:(O===0?g.slice(-1)==="/"&&(T=T.slice(1)):g.slice(-1)!=="/"&&(T="/"+T),T=g+T),T}}e.IgnoreFile=L}),define(ce[23],he([0,1,9,6,4,13,14,15,3,8,7]),function(re,e,S,L,D,T,g,O,B,H,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LocalFileSearchSimpleWorker=e.create=void 0;const K=!1,w=+new Date,f={},n=async(b,M)=>{if(!K)return M();const A=Date.now(),V=(f[b]??0)+1;console.info(b,V,"starting",Math.round((A-w)*10)/1e4),f[b]=V;const Z=await M(),s=Date.now();return console.info(b,V,"took",s-A),Z};function l(b){return new P(b)}e.create=l;class P{constructor(M){this.host=M,this.cancellationTokens=new Map}cancelQuery(M){this.cancellationTokens.get(M)?.cancel()}registerCancellationToken(M){const A=new T.CancellationTokenSource;return this.cancellationTokens.set(M,A),A}async listDirectory(M,A,V,Z,s){const h=U(V),_=new p.ExtUri(()=>Z),F=this.registerCancellationToken(s),Q=[];let W=!1,X=0;const le=A.maxResults||512,oe=A.filePattern?ne=>A.filePattern.split("").every(ue=>ne.includes(ue)):ne=>!0;return await n("listDirectory",()=>this.walkFolderQuery(M,v(A),h,_,ne=>{if(oe(ne.name))return X++,le&&X>le&&(W=!0,F.cancel()),Q.push(ne.path)},F.token)),{results:Q,limitHit:W}}async searchDirectory(M,A,V,Z,s){const h=U(V),_=new p.ExtUri(()=>Z);return n("searchInFiles",async()=>{const F=this.registerCancellationToken(s),Q=[],W=C(A.contentPattern),X=[];let le=0,oe=0;const ne=!1,ue=async N=>{if(F.token.isCancellationRequested)return;le++;const x=await N.resolve();if(F.token.isCancellationRequested)return;const Y=new Uint8Array(x),ie=(0,g.getFileResults)(Y,W,{afterContext:A.afterContext??0,beforeContext:A.beforeContext??0,previewOptions:A.previewOptions,remainingResultQuota:A.maxResults?A.maxResults-oe:1e4});if(ie.length){oe+=ie.length,A.maxResults&&oe>A.maxResults&&F.cancel();const u={resource:L.URI.joinPath(h.folder,N.path),results:ie};this.host.sendTextSearchMatch(u,s),Q.push(u)}};return await n("walkFolderToResolve",()=>this.walkFolderQuery(M,v(A),h,_,async N=>X.push(ue(N)),F.token)),await n("resolveOngoingProcesses",()=>Promise.all(X)),K&&console.log("Searched in",le,"files"),{results:Q,limitHit:ne}})}async walkFolderQuery(M,A,V,Z,s,h){const _=S.parse(V.excludePattern??{},{trimForExclusions:!0}),F=(N,x,Y)=>(N=N.slice(1),!!(_(N,x,Y)||z(A,N))),Q=(N,x,Y)=>(N=N.slice(1),!(_(N,x,Y)||!te(A,N,Z))),W=(N,x)=>({type:"file",name:N.name,path:x,resolve:()=>N.getFile().then(ie=>ie.arrayBuffer())}),X=N=>N.kind==="directory",le=N=>N.kind==="file",oe=async(N,x,Y)=>{if(!V.disregardIgnoreFiles){const u=await Promise.all([N.getFileHandle(".gitignore").catch(d=>{}),N.getFileHandle(".ignore").catch(d=>{})]);await Promise.all(u.map(async d=>{if(!d)return;const a=new TextDecoder("utf8").decode(new Uint8Array(await(await d.getFile()).arrayBuffer()));Y=new O.IgnoreFile(a,x,Y)}))}const ie=H.Promises.withAsyncBody(async u=>{const d=[],a=[],R=[],y=new Set;for await(const k of N.entries())R.push(k),y.add(k[0]);for(const[k,j]of R){if(h.isCancellationRequested)break;const m=x+k;if(Y&&!Y.isPathIncludedInTraversal(m,j.kind==="directory"))continue;const E=$=>y.has($);X(j)&&!F(m,k,E)?a.push(oe(j,m+"/",Y)):le(j)&&Q(m,k,E)&&d.push(W(j,m))}u([...await Promise.all(a),...d])});return{type:"dir",name:N.name,entries:ie}},ne=async(N,x)=>{h.isCancellationRequested||await Promise.all((await N.entries).sort((Y,ie)=>-(Y.type==="dir"?0:1)+(ie.type==="dir"?0:1)).map(async Y=>Y.type==="dir"?ne(Y,x):x(Y)))},ue=await n("process",()=>oe(M,"/"));await n("resolve",()=>ne(ue,s))}}e.LocalFileSearchSimpleWorker=P;function C(b){return(0,B.createRegExp)(b.pattern,!!b.isRegExp,{wholeWord:b.isWordMatch,global:!0,matchCase:b.isCaseSensitive,multiline:!0,unicode:!0})}function U(b){return{...b,folder:L.URI.revive(b.folder)}}function v(b){return{...b,extraFileResources:b.extraFileResources?.map(M=>L.URI.revive(M)),folderQueries:b.folderQueries.map(M=>U(M))}}function z(b,M){return!!(b.excludePattern&&S.match(b.excludePattern,M))}function te(b,M,A){return b.excludePattern&&S.match(b.excludePattern,M)?!1:b.includePattern||b.usingSearchPaths?b.includePattern&&S.match(b.includePattern,M)?!0:b.usingSearchPaths?!!b.folderQueries&&b.folderQueries.some(V=>{const Z=V.folder,s=L.URI.file(M);if(A.isEqualOrParent(s,Z)){const h=D.relative(Z.path,s.path);return!V.includePattern||!!S.match(V.includePattern,h)}else return!1}):!1:!0}})}).call(this);

//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/08e6c15293922dd53a864bb041be381322fee401/core/vs\workbench\services\search\worker\localFileSearch.js.map
